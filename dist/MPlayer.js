(function e(t,r){if(typeof exports==="object"&&typeof module==="object")module.exports=r();else if(typeof define==="function"&&define.amd)define("MPlayer",[],r);else if(typeof exports==="object")exports["MPlayer"]=r();else t["MPlayer"]=r()})(window,function(){return function(r){var i={};function a(e){if(i[e]){return i[e].exports}var t=i[e]={i:e,l:false,exports:{}};r[e].call(t.exports,t,t.exports,a);t.l=true;return t.exports}a.m=r;a.c=i;a.d=function(e,t,r){if(!a.o(e,t)){Object.defineProperty(e,t,{enumerable:true,get:r})}};a.r=function(e){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(e,"__esModule",{value:true})};a.t=function(t,e){if(e&1)t=a(t);if(e&8)return t;if(e&4&&typeof t==="object"&&t&&t.__esModule)return t;var r=Object.create(null);a.r(r);Object.defineProperty(r,"default",{enumerable:true,value:t});if(e&2&&typeof t!="string")for(var i in t)a.d(r,i,function(e){return t[e]}.bind(null,i));return r};a.n=function(t){var e=t&&t.__esModule?function e(){return t["default"]}:function e(){return t};a.d(e,"a",e);return e};a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};a.p="/";return a(a.s=4)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var i=function(){function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}return function(e,t,r){if(t)i(e.prototype,t);if(r)i(e,r);return e}}();var h=r(2);function a(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var n=function(){function d(e){a(this,d);if(d.created){return d.instance}d.created=true;d.LOGGER_LEVEL={DEBUG:0,INFO:1,WARN:2,ERROR:3,FATAL:4};d.LOGGER_TYPE={VIEW:0,CONSOLE:1};this.el=document.getElementById(e||"logger");this.level=d.LOGGER_LEVEL.DEBUG;this.type=d.LOGGER_TYPE.VIEW}i(d,[{key:"debug",value:function e(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++){r[i]=arguments[i]}this.log.apply(this,[d.LOGGER_LEVEL.DEBUG].concat(r))}},{key:"info",value:function e(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++){r[i]=arguments[i]}this.log.apply(this,[d.LOGGER_LEVEL.INFO].concat(r))}},{key:"warn",value:function e(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++){r[i]=arguments[i]}this.log.apply(this,[d.LOGGER_LEVEL.WARN].concat(r))}},{key:"error",value:function e(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++){r[i]=arguments[i]}this.log.apply(this,[d.LOGGER_LEVEL.ERROR].concat(r))}},{key:"fatal",value:function e(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++){r[i]=arguments[i]}this.log.apply(this,[d.LOGGER_LEVEL.FATAL].concat(r))}},{key:"log",value:function t(e){if(e<this.level)return;for(var r=arguments.length,i=Array(r>1?r-1:0),a=1;a<r;a++){i[a-1]=arguments[a]}if(this.type==d.LOGGER_TYPE.VIEW){var n="";var s=true;var o=false;var l=undefined;try{for(var u=i[Symbol.iterator](),f;!(s=(f=u.next()).done);s=true){var c=f.value;n+=c+" "}}catch(e){o=true;l=e}finally{try{if(!s&&u.return){u.return()}}finally{if(o){throw l}}}if(n!="")n="["+this.typeToName(this.level)+"] "+n;this.el.appendChild(document.createTextNode(n));this.el.appendChild(document.createElement("br"));this.el.scrollTop=this.el.scrollHeight}else{(0,h.isArray)(i);var t="["+this.typeToName(this.level)+"] -> ";i.forEach(function(e){t+=e+", "});t=t.substring(0,t.length-2);console.log(t)}}},{key:"setLevel",value:function e(t){this.level=t}},{key:"setType",value:function e(t){this.type=t}},{key:"typeToName",value:function e(t){var r=void 0;for(var i in d.LOGGER_LEVEL){if(t==d.LOGGER_LEVEL[i]){r=i;break}}return r}}],[{key:"getLogger",value:function e(t){if(!d.instance){d.instance=new d(t)}return d.instance}}]);return d}();t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var i=r(8);var a=N(i);var n=r(9);var s=N(n);var o=r(10);var l=N(o);var u=r(11);var f=N(u);var c=r(12);var d=N(c);var h=r(13);var p=N(h);var v=r(14);var y=N(v);var g=r(15);var m=N(g);var b=r(16);var E=N(b);var T=r(17);var S=N(T);var w=r(18);var A=N(w);var _=r(19);var R=N(_);var L=r(20);var k=N(L);var D=r(21);var I=N(D);var O=r(22);var P=N(O);var C=r(23);var x=N(C);var M=r(24);var F=N(M);function N(e){return e&&e.__esModule?e:{default:e}}var U={comment:a.default,full:s.default,fullWeb:l.default,fullExit:f.default,loading:F.default,loop:p.default,mute:y.default,play:m.default,pause:E.default,skip:S.default,volume1:A.default,volume2:R.default,decrease:k.default,increase:I.default,setting:P.default,back:x.default};t.default=U},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var i=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.uniqueId=l;t.isNumber=u;t.isArray=f;t.formatTime=c;t.seekToSecondsText=d;t.now=h;var a=t.Fullscreen={isFullscreen:function e(){return!!(document.webkitFullscreenElement||document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement)},requestFullscreen:function e(t){if(t.requestFullscreen)t.requestFullscreen();else if(t.webkitRequestFullScreen)t.webkitRequestFullScreen();else if(t.mozRequestFullScreen)t.mozRequestFullScreen();else if(t.msRequestFullscreen)t.msRequestFullscreen();else if(t.querySelector&&t.querySelector("mplayer-video")&&t.querySelector("mplayer-video").webkitEnterFullScreen)t.querySelector("mplayer-video").webkitEnterFullScreen();else if(t.webkitEnterFullScreen)t.webkitEnterFullScreen()},cancelFullscreen:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:document;if(t.exitFullscreen)t.exitFullscreen();else if(t.webkitCancelFullScreen)t.webkitCancelFullScreen();else if(t.webkitExitFullscreen)t.webkitExitFullscreen();else if(t.mozCancelFullScreen)t.mozCancelFullScreen();else if(t.msExitFullscreen)t.msExitFullscreen()},fullscreenEnabled:function e(){return!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled)}};var n=t.requestAnimationFrame=(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}).bind(window);var s=t.cancelAnimationFrame=(window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.clearTimeout).bind(window);var o={};function l(e){o[e]||(o[e]=0);var t=++o[e];return e+t}function u(e){return value-parseFloat(value)+1>=0}function f(e){if((typeof e==="undefined"?"undefined":i(e))==="object"){return Object.prototype.toString.call(e)==="[object Array]"}return e instanceof Array}function c(e){var t=void 0,r=void 0;t=Math.floor(e/60);if(t<10)t="0"+t;r=Math.floor(e%60);if(r<10)r="0"+r;if(isNaN(t)||isNaN(r)){return"--:--"}return t+":"+r}function d(e,t){var r=0;if(e<t){r=parseInt(t-e);return"快进 "+r+" 秒"}else{r=parseInt(e-t);return"快退 "+r+" 秒"}}function h(){if(window.performance&&window.performance.now)return performance.now();return Date.now()}t.default={Fullscreen:a,requestAnimationFrame:n,cancelAnimationFrame:s,formatTime:c,uniqueId:l,isNumber:u,seekToSecondsText:d,now:h}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var i={PLAY:"play",PAUSE:"pause",PLAYED:"played",STOP:"stop",LOADING:"loading",LOADED:"loaded",ERROR:"error"};t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var u=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var a=function(){function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}return function(e,t,r){if(t)i(e.prototype,t);if(r)i(e,r);return e}}();r(33);var i=r(5);var f=x(i);var n=r(6);var s=x(n);var o=r(7);var c=x(o);var l=r(3);var d=x(l);var h=r(1);var p=x(h);var v=r(0);var y=x(v);var g=r(25);var m=x(g);var b=r(26);var E=x(b);var T=r(27);var S=x(T);var w=r(28);var A=x(w);var _=r(29);var R=x(_);var L=r(30);var k=x(L);var D=r(31);var I=x(D);var O=r(2);var P=r(32);var C=x(P);function x(e){return e&&e.__esModule?e:{default:e}}function M(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var F=0;var N=y.default.getLogger();var U=function(){function i(e){M(this,i);this.index=F;this.options={};this.options=(0,m.default)(e);N.setType(this.options.loggerType);N.debug("Player initialize.");this.nowPlayer="mplayer-index"+this.index;this.element=this.options.element;this.element.classList.add("player-wrap");this.element.classList.add(this.nowPlayer);this.element.innerHTML=E.default.build(this.index,this.options);this.videoBox=this.element.getElementsByClassName("video-box")[0];this.video=this.element.getElementsByClassName("mplayer-video")[0];if(this.options.video.poster){this.video.poster=this.options.video.poster}this.source2=null;this.nextPlayButtonEle=this.element.querySelector(".button-next");this.muted=false;this.events=new C.default;this.infoPanel=new A.default(this);if(this.options.video.src){this.init(this.video,this.options.type,this.options.video.src)}this.notice=new I.default(this);this.fullScreen=new k.default(this);this.controller=new R.default(this);var t=this;this.menu=new S.default({player:this,menus:[{name:"复制视频网址",class:"copy-el1",func:function e(){}},{name:"循环播放",func:function e(){t.controller._loop()}},{name:"无法播放反馈",func:function e(){window.location.href="http://www.srsg.moe/feedback/player/error_reply?backurl="+window.location.href}},{name:"详细统计信息",func:function e(){t.infoPanel.open()}}]});var r=new s.default(".copy-el1",{text:function e(){return window.location.href}});r.on("success",function(e){t.notice.showAutoHide("复制成功")});r.on("error",function(e){N.error(e)});this.setVolume(this.options.volume);N.debug("Player inited.");F++}a(i,[{key:"init",value:function e(i,t,r){var s=this;this.options.type=this.type=t;var a=i;if(!this.type||this.type==="auto"){if(/.mpd(#|\?|\$)/i.exec(r)){this.type=c.default.NativeDash}else if(/.flv(#|\?|\$)/i.exec(r)){this.type=c.default.NativeFlv}else if(/.m3u8(#|\?|\$)/i.exec(r)){this.type=c.default.NativeHls}else{this.type=c.default.HtmlMediaElement}}N.debug("Player Mode: "+this.type+", Element: ."+this.nowPlayer+", Source: "+r);switch(this.type){case c.default.NativeDash:if(dashjs&&MediaPlayer){MediaPlayer().create().initialize(i,r,false)}break;case c.default.NativeFlv:if(flv&&flv.isSupported()){var n=flv.createPlayer({type:"flv",url:r});n.attachMediaElement(i);n.load()}break;case c.default.NativeHls:if(f.default.isSupported()){var o=new f.default;o.loadSource(r);o.attachMedia(i);s.stats={};s.stats.droppedFrames=0;s.stats.totalFrames=0;var l={url:r,t0:performance.now(),load:[],buffer:[],video:[],level:[],bitrate:[]};o.on(f.default.Events.MANIFEST_PARSED,function(e,t){s.stats={levelNb:t.levels.length,levelParsed:0}});o.on(f.default.Events.BUFFER_CODECS,function(e,t){s.stats.codec=t&&t.video&&t.video.container+';codecs="'+t.video.codec+'"'});o.on(f.default.Events.LEVEL_LOADED,function(e,t){i.currentTime=0;var e={type:"level",id:t.level,start:t.details.startSN,end:t.details.endSN,time:t.stats.trequest-l.t0,latency:t.stats.tfirst-t.stats.trequest,load:t.stats.tload-t.stats.tfirst,parsing:t.stats.tparsed-t.stats.tload,duration:t.stats.tload-t.stats.tfirst};var r=t.stats.tparsed-t.stats.tload;if(s.stats.levelParsed){s.sumLevelParsingMs+=r}else{s.sumLevelParsingMs=r}s.stats.levelParsed++;s.stats.levelParsingUs=Math.round(1e3*s.sumLevelParsingMs/s.stats.levelParsed);l.load.push(e)});o.on(f.default.Events.FRAG_BUFFERED,function(e,t){var e={type:t.frag.type+" fragment",id:t.frag.level,id2:t.frag.sn,time:t.stats.trequest-l.t0,latency:t.stats.tfirst-t.stats.trequest,load:t.stats.tload-t.stats.tfirst,parsing:t.stats.tparsed-t.stats.tload,buffer:t.stats.tbuffered-t.stats.tparsed,duration:t.stats.tbuffered-t.stats.tfirst,bw:Math.round(8*t.stats.total/(t.stats.tbuffered-t.stats.trequest)),size:t.stats.total};l.load.push(e);l.bitrate.push({time:performance.now()-l.t0,bitrate:e.bw,duration:t.frag.duration,level:e.id});if(o.bufferTimer===undefined){l.buffer.push({time:0,buffer:0,pos:0})}var r=t.stats.tfirst-t.stats.trequest,i=t.stats.tparsed-t.stats.tload,a=t.stats.tbuffered-t.stats.trequest,n=Math.round(8*t.stats.total/(t.stats.tbuffered-t.stats.tfirst));if(s.stats.fragBuffered){s.stats.fragMinLatency=Math.min(s.stats.fragMinLatency,r);s.stats.fragMaxLatency=Math.max(s.stats.fragMaxLatency,r);s.stats.fragMinProcess=Math.min(s.stats.fragMinProcess,a);s.stats.fragMaxProcess=Math.max(s.stats.fragMaxProcess,a);s.stats.fragMinKbps=Math.min(s.stats.fragMinKbps,n);s.stats.fragMaxKbps=Math.max(s.stats.fragMaxKbps,n);s.stats.autoLevelCappingMin=Math.min(s.stats.autoLevelCappingMin,o.autoLevelCapping);s.stats.autoLevelCappingMax=Math.max(s.stats.autoLevelCappingMax,o.autoLevelCapping);s.stats.fragBuffered++}else{s.stats.fragMinLatency=s.stats.fragMaxLatency=r;s.stats.fragMinProcess=s.stats.fragMaxProcess=a;s.stats.fragMinKbps=s.stats.fragMaxKbps=n;s.stats.fragBuffered=1;s.stats.fragBufferedBytes=0;s.stats.autoLevelCappingMin=s.stats.autoLevelCappingMax=o.autoLevelCapping;s.sumLatency=0;s.sumKbps=0;s.sumProcess=0;s.sumParsing=0}s.stats.fraglastLatency=r;s.sumLatency+=r;s.stats.fragAvgLatency=Math.round(s.sumLatency/s.stats.fragBuffered);s.stats.fragLastProcess=a;s.sumProcess+=a;s.sumParsing+=i;s.stats.fragAvgProcess=Math.round(s.sumProcess/s.stats.fragBuffered);s.stats.fragLastKbps=n;s.sumKbps+=n;s.stats.fragAvgKbps=Math.round(s.sumKbps/s.stats.fragBuffered);s.stats.fragBufferedBytes+=t.stats.total;s.stats.fragparsingKbps=Math.round(8*s.stats.fragBufferedBytes/s.sumParsing);s.stats.fragparsingMs=Math.round(s.sumParsing);s.stats.autoLevelCappingLast=o.autoLevelCapping});o.on(f.default.Events.FRAG_LOADING,function(e,t){s.infoPanel.trigger(s.stats)});o.on(f.default.Events.FRAG_LOAD_PROGRESS,function(e,t){var r=u(a.getVideoPlaybackQuality)===Function&&a.getVideoPlaybackQuality||undefined;if(r&&r.droppedVideoFrames&&r.totalVideoFrames){s.stats.droppedFrames=r.droppedVideoFrames;s.stats.totalFrames=r.totalVideoFrames}else if(a.webkitDroppedFrameCount){s.stats.droppedFrames=a.webkitDroppedFrameCount;s.stats.totalFrames=0}else{s.stats.droppedFrames=0;s.stats.totalFrames=0}})}break;case c.default.HtmlMediaElement:default:i.src=r;break}this.video.currentTime=0}},{key:"play",value:function e(){var t=this;if(this.options.video.src===""){this.pause();console.log("播放器未初始化视频源，请调用方法 switchSource(src) 或在初始化播放器时，传入视频源地址");return}this.controller.button.play.innerHTML=p.default.pause;this.showStats(p.default.play);this.video.play();this.events.trigger(d.default.PLAY);this.panelUpdated=setInterval(function(){t.infoPanel.trigger()},1e3)}},{key:"pause",value:function e(){this.controller.button.play.innerHTML=p.default.play;this.showStats(p.default.pause);this.video.pause();this.events.trigger(d.default.PAUSE);clearInterval(this.panelUpdated)}},{key:"stop",value:function e(){this.controller.button.play.innerHTML=p.default.play;this.video.pause();this.controller.status=d.default.STOP;this.events.trigger(d.default.STOP);clearInterval(this.panelUpdated)}},{key:"seek",value:function e(t){if(t===undefined||isNaN(t))return this.video.currentTime;N.debug("Seek to "+Math.max(t,0));var r=(0,O.seekToSecondsText)(this.video.currentTime,t);N.debug(r);this.notice.showAutoHide(r);this.video.currentTime=t;this.events.trigger("seek",t);return this}},{key:"toggle",value:function e(){}},{key:"setVolume",value:function e(t){this.volume=t;this.controller.setVolume(this.volume);this.infoPanel.setVolumeText(t);this.events.trigger("volume",t)}},{key:"switchSource",value:function e(t,r){this.notice.showAutoHide("正在切换视频源");this.init(this.video,this.options.type,t);this.events.trigger("switchSource",{type:this.options.type,src:this.options.video.src});this.options.video.src=t}},{key:"playbackRate",value:function e(t){this.video.playbackRate=t;this.controller.settings.playSpeed.querySelector(".text").innerText=t==1?"正常":t;this.events.trigger("playbackRate",t);N.info("setting playback rate "+t)}},{key:"screenFull",value:function e(t){if(t==="screen"){this.fullScreen.screenFull()}else{this.fullScreen.webFull()}}},{key:"showStats",value:function e(t){this.notice.showStats(t)}},{key:"on",value:function e(t,r){this.events.on(t,r,this)}},{key:"off",value:function e(t,r){this.events.off(t,r,this)}},{key:"trigger",value:function e(t){this.events.trigger(t)}},{key:"next",value:function e(){if(this.source2!==null){this.switchSource(this.source2)}}},{key:"setNextVideo",value:function e(t){if(t!==null&&t!==undefined){this.source2=t;this.nextPlayButtonEle.removeClass("hidden")}else{this.source2=null;this.nextPlayButtonEle.addClass("hidden")}}},{key:"setVideoInfo",value:function e(t,r){this.infoPanel.setVideoId(t);this.infoPanel.setSourceHost(r)}},{key:"destroy",value:function e(){this.events.trigger("destroy");this.controller.destroy();this.notice.destroy();clearInterval(this.panelUpdated);this.infoPanel=null;this.fullScreen=null;this.notice=null;this.menu=null;this.element.classList="";this.element.innerHTML="";this.events.destroy();N.debug("player destroy")}}]);return i}();t.default=U},function(i,e,t){typeof window!=="undefined"&&function e(t,r){if(true)i.exports=r();else{}}(this,function(){return function(r){var i={};function a(e){if(i[e]){return i[e].exports}var t=i[e]={i:e,l:false,exports:{}};r[e].call(t.exports,t,t.exports,a);t.l=true;return t.exports}a.m=r;a.c=i;a.d=function(e,t,r){if(!a.o(e,t)){Object.defineProperty(e,t,{configurable:false,enumerable:true,get:r})}};a.n=function(t){var e=t&&t.__esModule?function e(){return t["default"]}:function e(){return t};a.d(e,"a",e);return e};a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};a.p="/dist/";return a(a.s=11)}([function(e,t,r){"use strict";r.d(t,"a",function(){return d});r.d(t,"b",function(){return h});var i=r(4);var a=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function n(){}var s={trace:n,debug:n,log:n,warn:n,info:n,error:n};var o=s;function l(e,t){t="["+e+"] > "+t;return t}var u=Object(i["a"])();function f(i){var a=u.console[i];if(a){return function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++){t[r]=arguments[r]}if(t[0]){t[0]=l(i,t[0])}a.apply(u.console,t)}}return n}function c(t){for(var e=arguments.length,r=Array(e>1?e-1:0),i=1;i<e;i++){r[i-1]=arguments[i]}r.forEach(function(e){o[e]=t[e]?t[e].bind(t):f(e)})}var d=function e(t){if(t===true||(typeof t==="undefined"?"undefined":a(t))==="object"){c(t,"debug","log","info","warn","error");try{o.log()}catch(e){o=s}}else{o=s}};var h=o},function(e,t,r){"use strict";var i={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition"};t["a"]=i},function(e,t,r){"use strict";r.d(t,"b",function(){return i});r.d(t,"a",function(){return a});var i={NETWORK_ERROR:"networkError",MEDIA_ERROR:"mediaError",KEY_SYSTEM_ERROR:"keySystemError",MUX_ERROR:"muxError",OTHER_ERROR:"otherError"};var a={KEY_SYSTEM_NO_KEYS:"keySystemNoKeys",KEY_SYSTEM_NO_ACCESS:"keySystemNoAccess",KEY_SYSTEM_NO_SESSION:"keySystemNoSession",KEY_SYSTEM_LICENSE_REQUEST_FAILED:"keySystemLicenseRequestFailed",MANIFEST_LOAD_ERROR:"manifestLoadError",MANIFEST_LOAD_TIMEOUT:"manifestLoadTimeOut",MANIFEST_PARSING_ERROR:"manifestParsingError",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"manifestIncompatibleCodecsError",LEVEL_LOAD_ERROR:"levelLoadError",LEVEL_LOAD_TIMEOUT:"levelLoadTimeOut",LEVEL_SWITCH_ERROR:"levelSwitchError",AUDIO_TRACK_LOAD_ERROR:"audioTrackLoadError",AUDIO_TRACK_LOAD_TIMEOUT:"audioTrackLoadTimeOut",FRAG_LOAD_ERROR:"fragLoadError",FRAG_LOAD_TIMEOUT:"fragLoadTimeOut",FRAG_DECRYPT_ERROR:"fragDecryptError",FRAG_PARSING_ERROR:"fragParsingError",REMUX_ALLOC_ERROR:"remuxAllocError",KEY_LOAD_ERROR:"keyLoadError",KEY_LOAD_TIMEOUT:"keyLoadTimeOut",BUFFER_ADD_CODEC_ERROR:"bufferAddCodecError",BUFFER_APPEND_ERROR:"bufferAppendError",BUFFER_APPENDING_ERROR:"bufferAppendingError",BUFFER_STALLED_ERROR:"bufferStalledError",BUFFER_FULL_ERROR:"bufferFullError",BUFFER_SEEK_OVER_HOLE:"bufferSeekOverHole",BUFFER_NUDGE_ON_STALL:"bufferNudgeOnStall",INTERNAL_EXCEPTION:"internalException"}},function(e,t,r){"use strict";r.d(t,"a",function(){return i});var i=Number.isFinite||function(e){return typeof e==="number"&&isFinite(e)}},function(e,t,r){"use strict";t["a"]=i;function i(){if(typeof window==="undefined"){return self}else{return window}}},function(a,e,t){(function(e){var r=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/\;?#]*)?(.*?)??(;.*?)?(\?.*?)?(#.*?)?$/;var f=/^([^\/;?#]*)(.*)$/;var t=/(?:\/|^)\.(?=\/)/g;var i=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g;var c={buildAbsoluteURL:function(e,t,r){r=r||{};e=e.trim();t=t.trim();if(!t){if(!r.alwaysNormalize){return e}var i=this.parseURL(e);if(!n){throw new Error("Error trying to parse base URL.")}i.path=c.normalizePath(i.path);return c.buildURLFromParts(i)}var a=this.parseURL(t);if(!a){throw new Error("Error trying to parse relative URL.")}if(a.scheme){if(!r.alwaysNormalize){return t}a.path=c.normalizePath(a.path);return c.buildURLFromParts(a)}var n=this.parseURL(e);if(!n){throw new Error("Error trying to parse base URL.")}if(!n.netLoc&&n.path&&n.path[0]!=="/"){var s=f.exec(n.path);n.netLoc=s[1];n.path=s[2]}if(n.netLoc&&!n.path){n.path="/"}var o={scheme:n.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc){o.netLoc=n.netLoc;if(a.path[0]!=="/"){if(!a.path){o.path=n.path;if(!a.params){o.params=n.params;if(!a.query){o.query=n.query}}}else{var l=n.path;var u=l.substring(0,l.lastIndexOf("/")+1)+a.path;o.path=c.normalizePath(u)}}}if(o.path===null){o.path=r.alwaysNormalize?c.normalizePath(a.path):a.path}return c.buildURLFromParts(o)},parseURL:function(e){var t=r.exec(e);if(!t){return null}return{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}},normalizePath:function(e){e=e.split("").reverse().join("").replace(t,"");while(e.length!==(e=e.replace(i,"")).length){}return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}};if(true)a.exports=c;else{}})(this)},function(e,t,r){"use strict";r.d(t,"b",function(){return n});function i(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var a=function(){function l(){i(this,l)}l.isHeader=function e(t,r){if(r+10<=t.length){if(t[r]===73&&t[r+1]===68&&t[r+2]===51){if(t[r+3]<255&&t[r+4]<255){if(t[r+6]<128&&t[r+7]<128&&t[r+8]<128&&t[r+9]<128){return true}}}}return false};l.isFooter=function e(t,r){if(r+10<=t.length){if(t[r]===51&&t[r+1]===68&&t[r+2]===73){if(t[r+3]<255&&t[r+4]<255){if(t[r+6]<128&&t[r+7]<128&&t[r+8]<128&&t[r+9]<128){return true}}}}return false};l.getID3Data=function e(t,r){var i=r;var a=0;while(l.isHeader(t,r)){a+=10;var n=l._readSize(t,r+6);a+=n;if(l.isFooter(t,r+10)){a+=10}r+=a}if(a>0){return t.subarray(i,i+a)}return undefined};l._readSize=function e(t,r){var i=0;i=(t[r]&127)<<21;i|=(t[r+1]&127)<<14;i|=(t[r+2]&127)<<7;i|=t[r+3]&127;return i};l.getTimeStamp=function e(t){var r=l.getID3Frames(t);for(var i=0;i<r.length;i++){var a=r[i];if(l.isTimeStampFrame(a)){return l._readTimeStamp(a)}}return undefined};l.isTimeStampFrame=function e(t){return t&&t.key==="PRIV"&&t.info==="com.apple.streaming.transportStreamTimestamp"};l._getFrameData=function e(t){var r=String.fromCharCode(t[0],t[1],t[2],t[3]);var i=l._readSize(t,4);var a=10;return{type:r,size:i,data:t.subarray(a,a+i)}};l.getID3Frames=function e(t){var r=0;var i=[];while(l.isHeader(t,r)){var a=l._readSize(t,r+6);r+=10;var n=r+a;while(r+8<n){var s=l._getFrameData(t.subarray(r));var o=l._decodeFrame(s);if(o){i.push(o)}r+=s.size+10}if(l.isFooter(t,r)){r+=10}}return i};l._decodeFrame=function e(t){if(t.type==="PRIV"){return l._decodePrivFrame(t)}else if(t.type[0]==="T"){return l._decodeTextFrame(t)}else if(t.type[0]==="W"){return l._decodeURLFrame(t)}return undefined};l._readTimeStamp=function e(t){if(t.data.byteLength===8){var r=new Uint8Array(t.data);var i=r[3]&1;var a=(r[4]<<23)+(r[5]<<15)+(r[6]<<7)+r[7];a/=45;if(i){a+=47721858.84}return Math.round(a)}return undefined};l._decodePrivFrame=function e(t){if(t.size<2){return undefined}var r=l._utf8ArrayToStr(t.data,true);var i=new Uint8Array(t.data.subarray(r.length+1));return{key:t.type,info:r,data:i.buffer}};l._decodeTextFrame=function e(t){if(t.size<2){return undefined}if(t.type==="TXXX"){var r=1;var i=l._utf8ArrayToStr(t.data.subarray(r));r+=i.length+1;var a=l._utf8ArrayToStr(t.data.subarray(r));return{key:t.type,info:i,data:a}}else{var n=l._utf8ArrayToStr(t.data.subarray(1));return{key:t.type,data:n}}};l._decodeURLFrame=function e(t){if(t.type==="WXXX"){if(t.size<2){return undefined}var r=1;var i=l._utf8ArrayToStr(t.data.subarray(r));r+=i.length+1;var a=l._utf8ArrayToStr(t.data.subarray(r));return{key:t.type,info:i,data:a}}else{var n=l._utf8ArrayToStr(t.data);return{key:t.type,data:n}}};l._utf8ArrayToStr=function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var i=t.length;var a=void 0;var n=void 0;var s=void 0;var o="";var l=0;while(l<i){a=t[l++];if(a===0&&r){return o}else if(a===0||a===3){continue}switch(a>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o+=String.fromCharCode(a);break;case 12:case 13:n=t[l++];o+=String.fromCharCode((a&31)<<6|n&63);break;case 14:n=t[l++];s=t[l++];o+=String.fromCharCode((a&15)<<12|(n&63)<<6|(s&63)<<0);break;default:}}return o};return l}();var n=a._utf8ArrayToStr;t["a"]=a},function(e,t){function i(){this._events=this._events||{};this._maxListeners=this._maxListeners||undefined}e.exports=i;i.EventEmitter=i;i.prototype._events=undefined;i.prototype._maxListeners=undefined;i.defaultMaxListeners=10;i.prototype.setMaxListeners=function(e){if(!r(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");this._maxListeners=e;return this};i.prototype.emit=function(e){var t,r,i,a,n,s;if(!this._events)this._events={};if(e==="error"){if(!this._events.error||u(this._events.error)&&!this._events.error.length){t=arguments[1];if(t instanceof Error){throw t}else{var o=new Error('Uncaught, unspecified "error" event. ('+t+")");o.context=t;throw o}}}r=this._events[e];if(f(r))return false;if(l(r)){switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1);r.apply(this,a)}}else if(u(r)){a=Array.prototype.slice.call(arguments,1);s=r.slice();i=s.length;for(n=0;n<i;n++)s[n].apply(this,a)}return true};i.prototype.addListener=function(e,t){var r;if(!l(t))throw TypeError("listener must be a function");if(!this._events)this._events={};if(this._events.newListener)this.emit("newListener",e,l(t.listener)?t.listener:t);if(!this._events[e])this._events[e]=t;else if(u(this._events[e]))this._events[e].push(t);else this._events[e]=[this._events[e],t];if(u(this._events[e])&&!this._events[e].warned){if(!f(this._maxListeners)){r=this._maxListeners}else{r=i.defaultMaxListeners}if(r&&r>0&&this._events[e].length>r){this._events[e].warned=true;console.error("(node) warning: possible EventEmitter memory "+"leak detected. %d listeners added. "+"Use emitter.setMaxListeners() to increase limit.",this._events[e].length);if(typeof console.trace==="function"){console.trace()}}}return this};i.prototype.on=i.prototype.addListener;i.prototype.once=function(e,t){if(!l(t))throw TypeError("listener must be a function");var r=false;function i(){this.removeListener(e,i);if(!r){r=true;t.apply(this,arguments)}}i.listener=t;this.on(e,i);return this};i.prototype.removeListener=function(e,t){var r,i,a,n;if(!l(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;r=this._events[e];a=r.length;i=-1;if(r===t||l(r.listener)&&r.listener===t){delete this._events[e];if(this._events.removeListener)this.emit("removeListener",e,t)}else if(u(r)){for(n=a;n-- >0;){if(r[n]===t||r[n].listener&&r[n].listener===t){i=n;break}}if(i<0)return this;if(r.length===1){r.length=0;delete this._events[e]}else{r.splice(i,1)}if(this._events.removeListener)this.emit("removeListener",e,t)}return this};i.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener){if(arguments.length===0)this._events={};else if(this._events[e])delete this._events[e];return this}if(arguments.length===0){for(t in this._events){if(t==="removeListener")continue;this.removeAllListeners(t)}this.removeAllListeners("removeListener");this._events={};return this}r=this._events[e];if(l(r)){this.removeListener(e,r)}else if(r){while(r.length)this.removeListener(e,r[r.length-1])}delete this._events[e];return this};i.prototype.listeners=function(e){var t;if(!this._events||!this._events[e])t=[];else if(l(this._events[e]))t=[this._events[e]];else t=this._events[e].slice();return t};i.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(l(t))return 1;else if(t)return t.length}return 0};i.listenerCount=function(e,t){return e.listenerCount(t)};function l(e){return typeof e==="function"}function r(e){return typeof e==="number"}function u(e){return typeof e==="object"&&e!==null}function f(e){return e===void 0}},function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var a=function(){function r(e,t){i(this,r);this.subtle=e;this.aesIV=t}r.prototype.decrypt=function e(t,r){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},r,t)};return r}();var l=a;function n(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var s=function(){function r(e,t){n(this,r);this.subtle=e;this.key=t}r.prototype.expandKey=function e(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},false,["encrypt","decrypt"])};return r}();var u=s;function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function M(e){var t=e.byteLength;var r=t&&new DataView(e).getUint8(t-1);if(r){return e.slice(0,t-r)}else{return e}}var f=function(){function e(){o(this,e);this.rcon=[0,1,2,4,8,16,32,64,128,27,54];this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)];this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)];this.sBox=new Uint32Array(256);this.invSBox=new Uint32Array(256);this.key=new Uint32Array(0);this.initTable()}e.prototype.uint8ArrayToUint32Array_=function e(t){var r=new DataView(t);var i=new Uint32Array(4);for(var a=0;a<4;a++){i[a]=r.getUint32(a*4)}return i};e.prototype.initTable=function e(){var t=this.sBox;var r=this.invSBox;var i=this.subMix;var a=i[0];var n=i[1];var s=i[2];var o=i[3];var l=this.invSubMix;var u=l[0];var f=l[1];var c=l[2];var d=l[3];var h=new Uint32Array(256);var p=0;var v=0;var y=0;for(y=0;y<256;y++){if(y<128){h[y]=y<<1}else{h[y]=y<<1^283}}for(y=0;y<256;y++){var g=v^v<<1^v<<2^v<<3^v<<4;g=g>>>8^g&255^99;t[p]=g;r[g]=p;var m=h[p];var b=h[m];var E=h[b];var T=h[g]*257^g*16843008;a[p]=T<<24|T>>>8;n[p]=T<<16|T>>>16;s[p]=T<<8|T>>>24;o[p]=T;T=E*16843009^b*65537^m*257^p*16843008;u[g]=T<<24|T>>>8;f[g]=T<<16|T>>>16;c[g]=T<<8|T>>>24;d[g]=T;if(!p){p=v=1}else{p=m^h[h[h[E^m]]];v^=h[h[v]]}}};e.prototype.expandKey=function e(t){var r=this.uint8ArrayToUint32Array_(t);var i=true;var a=0;while(a<r.length&&i){i=r[a]===this.key[a];a++}if(i){return}this.key=r;var n=this.keySize=r.length;if(n!==4&&n!==6&&n!==8){throw new Error("Invalid aes key size="+n)}var s=this.ksRows=(n+6+1)*4;var o=void 0;var l=void 0;var u=this.keySchedule=new Uint32Array(s);var f=this.invKeySchedule=new Uint32Array(s);var c=this.sBox;var d=this.rcon;var h=this.invSubMix;var p=h[0];var v=h[1];var y=h[2];var g=h[3];var m=void 0;var b=void 0;for(o=0;o<s;o++){if(o<n){m=u[o]=r[o];continue}b=m;if(o%n===0){b=b<<8|b>>>24;b=c[b>>>24]<<24|c[b>>>16&255]<<16|c[b>>>8&255]<<8|c[b&255];b^=d[o/n|0]<<24}else if(n>6&&o%n===4){b=c[b>>>24]<<24|c[b>>>16&255]<<16|c[b>>>8&255]<<8|c[b&255]}u[o]=m=(u[o-n]^b)>>>0}for(l=0;l<s;l++){o=s-l;if(l&3){b=u[o]}else{b=u[o-4]}if(l<4||o<=4){f[l]=b}else{f[l]=p[c[b>>>24]]^v[c[b>>>16&255]]^y[c[b>>>8&255]]^g[c[b&255]]}f[l]=f[l]>>>0}};e.prototype.networkToHostOrderSwap=function e(t){return t<<24|(t&65280)<<8|(t&16711680)>>8|t>>>24};e.prototype.decrypt=function e(t,r,i,a){var n=this.keySize+6;var s=this.invKeySchedule;var o=this.invSBox;var l=this.invSubMix;var u=l[0];var f=l[1];var c=l[2];var d=l[3];var h=this.uint8ArrayToUint32Array_(i);var p=h[0];var v=h[1];var y=h[2];var g=h[3];var m=new Int32Array(t);var b=new Int32Array(m.length);var E=void 0,T=void 0,S=void 0,w=void 0;var A=void 0,_=void 0,R=void 0,L=void 0;var k=void 0,D=void 0,I=void 0,O=void 0;var P=void 0,C=void 0;var x=this.networkToHostOrderSwap;while(r<m.length){k=x(m[r]);D=x(m[r+1]);I=x(m[r+2]);O=x(m[r+3]);A=k^s[0];_=O^s[1];R=I^s[2];L=D^s[3];P=4;for(C=1;C<n;C++){E=u[A>>>24]^f[_>>16&255]^c[R>>8&255]^d[L&255]^s[P];T=u[_>>>24]^f[R>>16&255]^c[L>>8&255]^d[A&255]^s[P+1];S=u[R>>>24]^f[L>>16&255]^c[A>>8&255]^d[_&255]^s[P+2];w=u[L>>>24]^f[A>>16&255]^c[_>>8&255]^d[R&255]^s[P+3];A=E;_=T;R=S;L=w;P=P+4}E=o[A>>>24]<<24^o[_>>16&255]<<16^o[R>>8&255]<<8^o[L&255]^s[P];T=o[_>>>24]<<24^o[R>>16&255]<<16^o[L>>8&255]<<8^o[A&255]^s[P+1];S=o[R>>>24]<<24^o[L>>16&255]<<16^o[A>>8&255]<<8^o[_&255]^s[P+2];w=o[L>>>24]<<24^o[A>>16&255]<<16^o[_>>8&255]<<8^o[R&255]^s[P+3];P=P+3;b[r]=x(E^p);b[r+1]=x(w^v);b[r+2]=x(S^y);b[r+3]=x(T^g);p=k;v=D;y=I;g=O;r=r+4}return a?M(b.buffer):b.buffer};e.prototype.destroy=function e(){this.key=undefined;this.keySize=undefined;this.ksRows=undefined;this.sBox=undefined;this.invSBox=undefined;this.subMix=undefined;this.invSubMix=undefined;this.keySchedule=undefined;this.invKeySchedule=undefined;this.rcon=undefined};return e}();var c=f;var d=r(2);var h=r(0);var p=r(1);var v=r(4);function y(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var g=Object(v["a"])();var m=function(){function s(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},i=r.removePKCS7Padding,a=i===undefined?true:i;y(this,s);this.logEnabled=true;this.observer=e;this.config=t;this.removePKCS7Padding=a;if(a){try{var n=g.crypto;if(n){this.subtle=n.subtle||n.webkitSubtle}}catch(e){}}this.disableWebCrypto=!this.subtle}s.prototype.isSync=function e(){return this.disableWebCrypto&&this.config.enableSoftwareAES};s.prototype.decrypt=function e(r,i,a,n){var s=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){if(this.logEnabled){h["b"].log("JS AES decrypt");this.logEnabled=false}var t=this.decryptor;if(!t){this.decryptor=t=new c}t.expandKey(i);n(t.decrypt(r,0,a,this.removePKCS7Padding))}else{if(this.logEnabled){h["b"].log("WebCrypto AES decrypt");this.logEnabled=false}var o=this.subtle;if(this.key!==i){this.key=i;this.fastAesKey=new u(o,i)}this.fastAesKey.expandKey().then(function(e){var t=new l(o,a);t.decrypt(r,e).catch(function(e){s.onWebCryptoError(e,r,i,a,n)}).then(function(e){n(e)})}).catch(function(e){s.onWebCryptoError(e,r,i,a,n)})}};s.prototype.onWebCryptoError=function e(t,r,i,a,n){if(this.config.enableSoftwareAES){h["b"].log("WebCrypto Error, disable WebCrypto API");this.disableWebCrypto=true;this.logEnabled=true;this.decrypt(r,i,a,n)}else{h["b"].error("decrypting error : "+t.message);this.observer.trigger(p["a"].ERROR,{type:d["b"].MEDIA_ERROR,details:d["a"].FRAG_DECRYPT_ERROR,fatal:true,reason:t.message})}};s.prototype.destroy=function e(){var t=this.decryptor;if(t){t.destroy();this.decryptor=undefined}};return s}();var b=t["a"]=m},function(e,t,r){"use strict";var h=r(0);var u=r(1);function i(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var o=Math.pow(2,32)-1;var a=function(){function b(e,t){i(this,b);this.observer=e;this.remuxer=t}b.prototype.resetTimeStamp=function e(t){this.initPTS=t};b.prototype.resetInitSegment=function e(t,r,i,a){if(t&&t.byteLength){var n=this.initData=b.parseInitSegment(t);if(r==null){r="mp4a.40.5"}if(i==null){i="avc1.42e01e"}var s={};if(n.audio&&n.video){s.audiovideo={container:"video/mp4",codec:r+","+i,initSegment:a?t:null}}else{if(n.audio){s.audio={container:"audio/mp4",codec:r,initSegment:a?t:null}}if(n.video){s.video={container:"video/mp4",codec:i,initSegment:a?t:null}}}this.observer.trigger(u["a"].FRAG_PARSING_INIT_SEGMENT,{tracks:s})}else{if(r){this.audioCodec=r}if(i){this.videoCodec=i}}};b.probe=function e(t){return b.findBox({data:t,start:0,end:Math.min(t.length,16384)},["moof"]).length>0};b.bin2str=function e(t){return String.fromCharCode.apply(null,t)};b.readUint16=function e(t,r){if(t.data){r+=t.start;t=t.data}var i=t[r]<<8|t[r+1];return i<0?65536+i:i};b.readUint32=function e(t,r){if(t.data){r+=t.start;t=t.data}var i=t[r]<<24|t[r+1]<<16|t[r+2]<<8|t[r+3];return i<0?4294967296+i:i};b.writeUint32=function e(t,r,i){if(t.data){r+=t.start;t=t.data}t[r]=i>>24;t[r+1]=i>>16&255;t[r+2]=i>>8&255;t[r+3]=i&255};b.findBox=function e(t,r){var i=[],a=void 0,n=void 0,s=void 0,o=void 0,l=void 0,u=void 0,f=void 0;if(t.data){u=t.start;o=t.end;t=t.data}else{u=0;o=t.byteLength}if(!r.length){return null}for(a=u;a<o;){n=b.readUint32(t,a);s=b.bin2str(t.subarray(a+4,a+8));f=n>1?a+n:o;if(s===r[0]){if(r.length===1){i.push({data:t,start:a+8,end:f})}else{l=b.findBox({data:t,start:a+8,end:f},r.slice(1));if(l.length){i=i.concat(l)}}}a=f}return i};b.parseSegmentIndex=function e(t){var r=b.findBox(t,["moov"])[0];var i=r?r.end:null;var a=0;var n=b.findBox(t,["sidx"]);var s=void 0;if(!n||!n[0]){return null}s=[];n=n[0];var o=n.data[0];a=o===0?8:16;var l=b.readUint32(n,a);a+=4;var u=0;var f=0;if(o===0){a+=8}else{a+=16}a+=2;var c=n.end+f;var d=b.readUint16(n,a);a+=2;for(var h=0;h<d;h++){var p=a;var v=b.readUint32(n,p);p+=4;var y=v&2147483647;var g=(v&2147483648)>>>31;if(g===1){console.warn("SIDX has hierarchical references (not supported)");return}var m=b.readUint32(n,p);p+=4;s.push({referenceSize:y,subsegmentDuration:m,info:{duration:m/l,start:c,end:c+y-1}});c+=y;p+=4;a=p}return{earliestPresentationTime:u,timescale:l,version:o,referencesCount:d,references:s,moovEndOffset:i}};b.parseInitSegment=function e(t){var d=[];var r=b.findBox(t,["moov","trak"]);r.forEach(function(e){var t=b.findBox(e,["tkhd"])[0];if(t){var r=t.data[t.start];var i=r===0?12:20;var a=b.readUint32(t,i);var n=b.findBox(e,["mdia","mdhd"])[0];if(n){r=n.data[n.start];i=r===0?12:20;var s=b.readUint32(n,i);var o=b.findBox(e,["mdia","hdlr"])[0];if(o){var l=b.bin2str(o.data.subarray(o.start+8,o.start+12));var u={soun:"audio",vide:"video"}[l];if(u){var f=b.findBox(e,["mdia","minf","stbl","stsd"]);if(f.length){f=f[0];var c=b.bin2str(f.data.subarray(f.start+12,f.start+16));h["b"].log("MP4Demuxer:"+u+":"+c+" found")}d[a]={timescale:s,type:u};d[u]={timescale:s,id:a}}}}}});return d};b.getStartDTS=function e(n,t){var r=void 0,i=void 0,a=void 0;r=b.findBox(t,["moof","traf"]);i=[].concat.apply([],r.map(function(a){return b.findBox(a,["tfhd"]).map(function(e){var t=void 0,r=void 0,i=void 0;t=b.readUint32(e,4);r=n[t].timescale||9e4;i=b.findBox(a,["tfdt"]).map(function(e){var t=void 0,r=void 0;t=e.data[e.start];r=b.readUint32(e,4);if(t===1){r*=Math.pow(2,32);r+=b.readUint32(e,8)}return r})[0];return i/r})}));a=Math.min.apply(null,i);return isFinite(a)?a:0};b.offsetStartDTS=function e(i,t,s){b.findBox(t,["moof","traf"]).map(function(r){return b.findBox(r,["tfhd"]).map(function(e){var t=b.readUint32(e,4);var n=i[t].timescale||9e4;b.findBox(r,["tfdt"]).map(function(e){var t=e.data[e.start];var r=b.readUint32(e,4);if(t===0){b.writeUint32(e,4,r-s*n)}else{r*=Math.pow(2,32);r+=b.readUint32(e,8);r-=s*n;r=Math.max(r,0);var i=Math.floor(r/(o+1));var a=Math.floor(r%(o+1));b.writeUint32(e,4,i);b.writeUint32(e,8,a)}})})})};b.prototype.append=function e(t,r,i,a){var n=this.initData;if(!n){this.resetInitSegment(t,this.audioCodec,this.videoCodec,false);n=this.initData}var s=void 0,o=this.initPTS;if(o===undefined){var l=b.getStartDTS(n,t);this.initPTS=o=l-r;this.observer.trigger(u["a"].INIT_PTS_FOUND,{initPTS:o})}b.offsetStartDTS(n,t,o);s=b.getStartDTS(n,t);this.remuxer.remux(n.audio,n.video,null,null,s,i,a,t)};b.prototype.destroy=function e(){};return b}();t["a"]=a},function(e,t,r){"use strict";var te=r(1);var re=r(2);var y=r(8);var v=r(3);var ie=r(0);var i=r(4);function s(e,t,r,i){var a=void 0,n=void 0,s=void 0,o=void 0,l=void 0,u=navigator.userAgent.toLowerCase(),f=i,c=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];a=((t[r+2]&192)>>>6)+1;n=(t[r+2]&60)>>>2;if(n>c.length-1){e.trigger(te["a"].ERROR,{type:re["b"].MEDIA_ERROR,details:re["a"].FRAG_PARSING_ERROR,fatal:true,reason:"invalid ADTS sampling index:"+n});return}o=(t[r+2]&1)<<2;o|=(t[r+3]&192)>>>6;ie["b"].log("manifest codec:"+i+",ADTS data:type:"+a+",sampleingIndex:"+n+"["+c[n]+"Hz],channelConfig:"+o);if(/firefox/i.test(u)){if(n>=6){a=5;l=new Array(4);s=n-3}else{a=2;l=new Array(2);s=n}}else if(u.indexOf("android")!==-1){a=2;l=new Array(2);s=n}else{a=5;l=new Array(4);if(i&&(i.indexOf("mp4a.40.29")!==-1||i.indexOf("mp4a.40.5")!==-1)||!i&&n>=6){s=n-3}else{if(i&&i.indexOf("mp4a.40.2")!==-1&&(n>=6&&o===1||/vivaldi/i.test(u))||!i&&o===1){a=2;l=new Array(2)}s=n}}l[0]=a<<3;l[0]|=(n&14)>>1;l[1]|=(n&1)<<7;l[1]|=o<<3;if(a===5){l[1]|=(s&14)>>1;l[2]=(s&1)<<7;l[2]|=2<<2;l[3]=0}return{config:l,samplerate:c[n],channelCount:o,codec:"mp4a.40."+a,manifestCodec:f}}function n(e,t){return e[t]===255&&(e[t+1]&246)===240}function u(e,t){return e[t+1]&1?7:9}function f(e,t){return(e[t+3]&3)<<11|e[t+4]<<3|(e[t+5]&224)>>>5}function m(e,t){if(t+1<e.length&&n(e,t)){return true}return false}function o(e,t){if(t+1<e.length&&n(e,t)){var r=u(e,t);var i=r;if(t+5<e.length){i=f(e,t)}var a=t+i;if(a===e.length||a+1<e.length&&n(e,a)){return true}}return false}function b(e,t,r,i,a){if(!e.samplerate){var n=s(t,r,i,a);e.config=n.config;e.samplerate=n.samplerate;e.channelCount=n.channelCount;e.codec=n.codec;e.manifestCodec=n.manifestCodec;ie["b"].log("parsed codec:"+e.codec+",rate:"+n.samplerate+",nb channel:"+n.channelCount)}}function E(e){return 1024*9e4/e}function c(e,t,r,i,a){var n=void 0,s=void 0,o=void 0;var l=e.length;n=u(e,t);s=f(e,t);s-=n;if(s>0&&t+n+s<=l){o=r+i*a;return{headerLength:n,frameLength:s,stamp:o}}return undefined}function T(e,t,r,i,a){var n=E(e.samplerate);var s=c(t,r,i,a,n);if(s){var o=s.stamp;var l=s.headerLength;var u=s.frameLength;var f={unit:t.subarray(r+l,r+l+u),pts:o,dts:o};e.samples.push(f);e.len+=u;return{sample:f,length:u+l}}return undefined}var g=r(6);function a(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var l=function(){function i(e,t,r){a(this,i);this.observer=e;this.config=r;this.remuxer=t}i.prototype.resetInitSegment=function e(t,r,i,a){this._audioTrack={container:"audio/adts",type:"audio",id:0,sequenceNumber:0,isAAC:true,samples:[],len:0,manifestCodec:r,duration:a,inputTimeScale:9e4}};i.prototype.resetTimeStamp=function e(){};i.probe=function e(t){if(!t){return false}var r=g["a"].getID3Data(t,0)||[];var i=r.length;for(var a=t.length;i<a;i++){if(o(t,i)){ie["b"].log("ADTS sync word found !");return true}}return false};i.prototype.append=function e(t,r,i,a){var n=this._audioTrack;var s=g["a"].getID3Data(t,0)||[];var o=g["a"].getTimeStamp(s);var l=Object(v["a"])(o)?o*90:r*9e4;var u=0;var f=l;var c=t.length;var d=s.length;var h=[{pts:f,dts:f,data:s}];while(d<c-1){if(m(t,d)&&d+5<c){b(n,this.observer,t,d,n.manifestCodec);var p=T(n,t,d,l,u);if(p){d+=p.length;f=p.sample.pts;u++}else{ie["b"].log("Unable to parse AAC frame");break}}else if(g["a"].isHeader(t,d)){s=g["a"].getID3Data(t,d);h.push({pts:f,dts:f,data:s});d+=s.length}else{d++}}this.remuxer.remux(n,{samples:[]},{samples:h,inputTimeScale:9e4},{samples:[]},r,i,a)};i.prototype.destroy=function e(){};return i}();var A=l;var _=r(9);var S={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients:[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot:[0,1,1,4],appendFrame:function e(t,r,i,a,n){if(i+24>r.length){return undefined}var s=this.parseHeader(r,i);if(s&&i+s.frameLength<=r.length){var o=s.samplesPerFrame*9e4/s.sampleRate;var l=a+n*o;var u={unit:r.subarray(i,i+s.frameLength),pts:l,dts:l};t.config=[];t.channelCount=s.channelCount;t.samplerate=s.sampleRate;t.samples.push(u);t.len+=s.frameLength;return{sample:u,length:s.frameLength}}return undefined},parseHeader:function e(t,r){var i=t[r+1]>>3&3;var a=t[r+1]>>1&3;var n=t[r+2]>>4&15;var s=t[r+2]>>2&3;var o=t[r+2]>>1&1;if(i!==1&&n!==0&&n!==15&&s!==3){var l=i===3?3-a:a===3?3:4;var u=S.BitratesMap[l*14+n-1]*1e3;var f=i===3?0:i===2?1:2;var c=S.SamplingRateMap[f*3+s];var d=t[r+3]>>6===3?1:2;var h=S.SamplesCoefficients[i][a];var p=S.BytesInSlot[a];var v=h*8*p;var y=parseInt(h*u/c+o,10)*p;return{sampleRate:c,channelCount:d,frameLength:y,samplesPerFrame:v}}return undefined},isHeaderPattern:function e(t,r){return t[r]===255&&(t[r+1]&224)===224&&(t[r+1]&6)!==0},isHeader:function e(t,r){if(r+1<t.length&&this.isHeaderPattern(t,r)){return true}return false},probe:function e(t,r){if(r+1<t.length&&this.isHeaderPattern(t,r)){var i=4;var a=this.parseHeader(t,r);var n=i;if(a&&a.frameLength){n=a.frameLength}var s=r+n;if(s===t.length||s+1<t.length&&this.isHeaderPattern(t,s)){return true}}return false}};var w=S;function d(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var h=function(){function t(e){d(this,t);this.data=e;this.bytesAvailable=e.byteLength;this.word=0;this.bitsAvailable=0}t.prototype.loadWord=function e(){var t=this.data,r=this.bytesAvailable,i=t.byteLength-r,a=new Uint8Array(4),n=Math.min(4,r);if(n===0){throw new Error("no bytes available")}a.set(t.subarray(i,i+n));this.word=new DataView(a.buffer).getUint32(0);this.bitsAvailable=n*8;this.bytesAvailable-=n};t.prototype.skipBits=function e(t){var r=void 0;if(this.bitsAvailable>t){this.word<<=t;this.bitsAvailable-=t}else{t-=this.bitsAvailable;r=t>>3;t-=r>>3;this.bytesAvailable-=r;this.loadWord();this.word<<=t;this.bitsAvailable-=t}};t.prototype.readBits=function e(t){var r=Math.min(this.bitsAvailable,t),i=this.word>>>32-r;if(t>32){ie["b"].error("Cannot read more than 32 bits at a time")}this.bitsAvailable-=r;if(this.bitsAvailable>0){this.word<<=r}else if(this.bytesAvailable>0){this.loadWord()}r=t-r;if(r>0&&this.bitsAvailable){return i<<r|this.readBits(r)}else{return i}};t.prototype.skipLZ=function e(){var t=void 0;for(t=0;t<this.bitsAvailable;++t){if((this.word&2147483648>>>t)!==0){this.word<<=t;this.bitsAvailable-=t;return t}}this.loadWord();return t+this.skipLZ()};t.prototype.skipUEG=function e(){this.skipBits(1+this.skipLZ())};t.prototype.skipEG=function e(){this.skipBits(1+this.skipLZ())};t.prototype.readUEG=function e(){var t=this.skipLZ();return this.readBits(t+1)-1};t.prototype.readEG=function e(){var t=this.readUEG();if(1&t){return 1+t>>>1}else{return-1*(t>>>1)}};t.prototype.readBoolean=function e(){return this.readBits(1)===1};t.prototype.readUByte=function e(){return this.readBits(8)};t.prototype.readUShort=function e(){return this.readBits(16)};t.prototype.readUInt=function e(){return this.readBits(32)};t.prototype.skipScalingList=function e(t){var r=8,i=8,a=void 0,n=void 0;for(a=0;a<t;a++){if(i!==0){n=this.readEG();i=(r+n+256)%256}r=i===0?r:i}};t.prototype.readSPS=function e(){var t=0,r=0,i=0,a=0,n=void 0,s=void 0,o=void 0,l=void 0,u=void 0,f=void 0,c=void 0,d=void 0,h=void 0,p=this.readUByte.bind(this),v=this.readBits.bind(this),y=this.readUEG.bind(this),g=this.readBoolean.bind(this),m=this.skipBits.bind(this),b=this.skipEG.bind(this),E=this.skipUEG.bind(this),T=this.skipScalingList.bind(this);p();n=p();s=v(5);m(3);o=p();E();if(n===100||n===110||n===122||n===244||n===44||n===83||n===86||n===118||n===128){var S=y();if(S===3){m(1)}E();E();m(1);if(g()){d=S!==3?8:12;for(h=0;h<d;h++){if(g()){if(h<6){T(16)}else{T(64)}}}}}E();var w=y();if(w===0){y()}else if(w===1){m(1);b();b();l=y();for(h=0;h<l;h++){b()}}E();m(1);u=y();f=y();c=v(1);if(c===0){m(1)}m(1);if(g()){t=y();r=y();i=y();a=y()}var A=[1,1];if(g()){if(g()){var _=p();switch(_){case 1:A=[1,1];break;case 2:A=[12,11];break;case 3:A=[10,11];break;case 4:A=[16,11];break;case 5:A=[40,33];break;case 6:A=[24,11];break;case 7:A=[20,11];break;case 8:A=[32,11];break;case 9:A=[80,33];break;case 10:A=[18,11];break;case 11:A=[15,11];break;case 12:A=[64,33];break;case 13:A=[160,99];break;case 14:A=[4,3];break;case 15:A=[3,2];break;case 16:A=[2,1];break;case 255:{A=[p()<<8|p(),p()<<8|p()];break}}}}return{width:Math.ceil((u+1)*16-t*2-r*2),height:(2-c)*(f+1)*16-(c?2:4)*(i+a),pixelRatio:A}};t.prototype.readSliceType=function e(){this.readUByte();this.readUEG();return this.readUEG()};return t}();var O=h;function p(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var R=function(){function a(e,t,r,i){p(this,a);this.decryptdata=r;this.discardEPB=i;this.decrypter=new y["a"](e,t,{removePKCS7Padding:false})}a.prototype.decryptBuffer=function e(t,r){this.decrypter.decrypt(t,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,r)};a.prototype.decryptAacSample=function e(t,r,i,a){var n=t[r].unit;var s=n.subarray(16,n.length-n.length%16);var o=s.buffer.slice(s.byteOffset,s.byteOffset+s.length);var l=this;this.decryptBuffer(o,function(e){e=new Uint8Array(e);n.set(e,16);if(!a){l.decryptAacSamples(t,r+1,i)}})};a.prototype.decryptAacSamples=function e(t,r,i){for(;;r++){if(r>=t.length){i();return}if(t[r].unit.length<32){continue}var a=this.decrypter.isSync();this.decryptAacSample(t,r,i,a);if(!a){return}}};a.prototype.getAvcEncryptedData=function e(t){var r=Math.floor((t.length-48)/160)*16+16;var i=new Int8Array(r);var a=0;for(var n=32;n<=t.length-16;n+=160,a+=16){i.set(t.subarray(n,n+16),a)}return i};a.prototype.getAvcDecryptedUnit=function e(t,r){r=new Uint8Array(r);var i=0;for(var a=32;a<=t.length-16;a+=160,i+=16){t.set(r.subarray(i,i+16),a)}return t};a.prototype.decryptAvcSample=function e(t,r,i,a,n,s){var o=this.discardEPB(n.data);var l=this.getAvcEncryptedData(o);var u=this;this.decryptBuffer(l.buffer,function(e){n.data=u.getAvcDecryptedUnit(o,e);if(!s){u.decryptAvcSamples(t,r,i+1,a)}})};a.prototype.decryptAvcSamples=function e(t,r,i,a){for(;;r++,i=0){if(r>=t.length){a();return}var n=t[r].units;for(;;i++){if(i>=n.length){break}var s=n[i];if(s.length<=48||s.type!==1&&s.type!==5){continue}var o=this.decrypter.isSync();this.decryptAvcSample(t,r,i,a,s,o);if(!o){return}}}};return a}();var L=R;function k(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var D={video:1,audio:2,id3:3,text:4};var I=function(){function C(e,t,r,i){k(this,C);this.observer=e;this.config=r;this.typeSupported=i;this.remuxer=t;this.sampleAes=null}C.prototype.setDecryptData=function e(t){if(t!=null&&t.key!=null&&t.method==="SAMPLE-AES"){this.sampleAes=new L(this.observer,this.config,t,this.discardEPB)}else{this.sampleAes=null}};C.probe=function e(t){var r=C._syncOffset(t);if(r<0){return false}else{if(r){ie["b"].warn("MPEG2-TS detected but first sync word found @ offset "+r+", junk ahead ?")}return true}};C._syncOffset=function e(t){var r=Math.min(1e3,t.length-3*188);var i=0;while(i<r){if(t[i]===71&&t[i+188]===71&&t[i+2*188]===71){return i}else{i++}}return-1};C.createTrack=function e(t,r){return{container:t==="video"||t==="audio"?"video/mp2t":undefined,type:t,id:D[t],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],len:0,dropped:t==="video"?0:undefined,isAAC:t==="audio"?true:undefined,duration:t==="audio"?r:undefined}};C.prototype.resetInitSegment=function e(t,r,i,a){this.pmtParsed=false;this._pmtId=-1;this._avcTrack=C.createTrack("video",a);this._audioTrack=C.createTrack("audio",a);this._id3Track=C.createTrack("id3",a);this._txtTrack=C.createTrack("text",a);this.aacOverFlow=null;this.aacLastPTS=null;this.avcSample=null;this.audioCodec=r;this.videoCodec=i;this._duration=a};C.prototype.resetTimeStamp=function e(){};C.prototype.append=function e(t,r,i,a){var n=void 0,s=t.length,o=void 0,l=void 0,u=void 0,f=void 0,c=void 0,d=false;this.contiguous=i;var h=this.pmtParsed,p=this._avcTrack,v=this._audioTrack,y=this._id3Track,g=p.pid,m=v.pid,b=y.pid,E=this._pmtId,T=p.pesData,S=v.pesData,w=y.pesData,A=this._parsePAT,_=this._parsePMT,R=this._parsePES,L=this._parseAVCPES.bind(this),k=this._parseAACPES.bind(this),D=this._parseMPEGPES.bind(this),I=this._parseID3PES.bind(this);var O=C._syncOffset(t);s-=(s+O)%188;for(n=O;n<s;n+=188){if(t[n]===71){o=!!(t[n+1]&64);l=((t[n+1]&31)<<8)+t[n+2];u=(t[n+3]&48)>>4;if(u>1){f=n+5+t[n+4];if(f===n+188){continue}}else{f=n+4}switch(l){case g:if(o){if(T&&(c=R(T))&&c.pts!==undefined){L(c,false)}T={data:[],size:0}}if(T){T.data.push(t.subarray(f,n+188));T.size+=n+188-f}break;case m:if(o){if(S&&(c=R(S))&&c.pts!==undefined){if(v.isAAC){k(c)}else{D(c)}}S={data:[],size:0}}if(S){S.data.push(t.subarray(f,n+188));S.size+=n+188-f}break;case b:if(o){if(w&&(c=R(w))&&c.pts!==undefined){I(c)}w={data:[],size:0}}if(w){w.data.push(t.subarray(f,n+188));w.size+=n+188-f}break;case 0:if(o){f+=t[f]+1}E=this._pmtId=A(t,f);break;case E:if(o){f+=t[f]+1}var P=_(t,f,this.typeSupported.mpeg===true||this.typeSupported.mp3===true,this.sampleAes!=null);g=P.avc;if(g>0){p.pid=g}m=P.audio;if(m>0){v.pid=m;v.isAAC=P.isAAC}b=P.id3;if(b>0){y.pid=b}if(d&&!h){ie["b"].log("reparse from beginning");d=false;n=O-188}h=this.pmtParsed=true;break;case 17:case 8191:break;default:d=true;break}}else{this.observer.trigger(te["a"].ERROR,{type:re["b"].MEDIA_ERROR,details:re["a"].FRAG_PARSING_ERROR,fatal:false,reason:"TS packet did not start with 0x47"})}}if(T&&(c=R(T))&&c.pts!==undefined){L(c,true);p.pesData=null}else{p.pesData=T}if(S&&(c=R(S))&&c.pts!==undefined){if(v.isAAC){k(c)}else{D(c)}v.pesData=null}else{if(S&&S.size){ie["b"].log("last AAC PES packet truncated,might overlap between fragments")}v.pesData=S}if(w&&(c=R(w))&&c.pts!==undefined){I(c);y.pesData=null}else{y.pesData=w}if(this.sampleAes==null){this.remuxer.remux(v,p,y,this._txtTrack,r,i,a)}else{this.decryptAndRemux(v,p,y,this._txtTrack,r,i,a)}};C.prototype.decryptAndRemux=function e(t,r,i,a,n,s,o){if(t.samples&&t.isAAC){var l=this;this.sampleAes.decryptAacSamples(t.samples,0,function(){l.decryptAndRemuxAvc(t,r,i,a,n,s,o)})}else{this.decryptAndRemuxAvc(t,r,i,a,n,s,o)}};C.prototype.decryptAndRemuxAvc=function e(t,r,i,a,n,s,o){if(r.samples){var l=this;this.sampleAes.decryptAvcSamples(r.samples,0,0,function(){l.remuxer.remux(t,r,i,a,n,s,o)})}else{this.remuxer.remux(t,r,i,a,n,s,o)}};C.prototype.destroy=function e(){this._initPTS=this._initDTS=undefined;this._duration=0};C.prototype._parsePAT=function e(t,r){return(t[r+10]&31)<<8|t[r+11]};C.prototype._parsePMT=function e(t,r,i,a){var n=void 0,s=void 0,o=void 0,l=void 0,u={audio:-1,avc:-1,id3:-1,isAAC:true};n=(t[r+1]&15)<<8|t[r+2];s=r+3+n-4;o=(t[r+10]&15)<<8|t[r+11];r+=12+o;while(r<s){l=(t[r+1]&31)<<8|t[r+2];switch(t[r]){case 207:if(!a){ie["b"].log("unkown stream type:"+t[r]);break}case 15:if(u.audio===-1){u.audio=l}break;case 21:if(u.id3===-1){u.id3=l}break;case 219:if(!a){ie["b"].log("unkown stream type:"+t[r]);break}case 27:if(u.avc===-1){u.avc=l}break;case 3:case 4:if(!i){ie["b"].log("MPEG audio found, not supported in this browser for now")}else if(u.audio===-1){u.audio=l;u.isAAC=false}break;case 36:ie["b"].warn("HEVC stream type found, not supported for now");break;default:ie["b"].log("unkown stream type:"+t[r]);break}r+=((t[r+3]&15)<<8|t[r+4])+5}return u};C.prototype._parsePES=function e(t){var r=0,i=void 0,a=void 0,n=void 0,s=void 0,o=void 0,l=void 0,u=void 0,f=void 0,c=void 0,d=t.data;if(!t||t.size===0){return null}while(d[0].length<19&&d.length>1){var h=new Uint8Array(d[0].length+d[1].length);h.set(d[0]);h.set(d[1],d[0].length);d[0]=h;d.splice(1,1)}i=d[0];n=(i[0]<<16)+(i[1]<<8)+i[2];if(n===1){s=(i[4]<<8)+i[5];if(s&&s>t.size-6){return null}a=i[7];if(a&192){u=(i[9]&14)*536870912+(i[10]&255)*4194304+(i[11]&254)*16384+(i[12]&255)*128+(i[13]&254)/2;if(u>4294967295){u-=8589934592}if(a&64){f=(i[14]&14)*536870912+(i[15]&255)*4194304+(i[16]&254)*16384+(i[17]&255)*128+(i[18]&254)/2;if(f>4294967295){f-=8589934592}if(u-f>60*9e4){ie["b"].warn(Math.round((u-f)/9e4)+"s delta between PTS and DTS, align them");u=f}}else{f=u}}o=i[8];c=o+9;t.size-=c;l=new Uint8Array(t.size);for(var p=0,v=d.length;p<v;p++){i=d[p];var y=i.byteLength;if(c){if(c>y){c-=y;continue}else{i=i.subarray(c);y-=c;c=0}}l.set(i,r);r+=y}if(s){s-=o+3}return{data:l,pts:u,dts:f,len:s}}else{return null}};C.prototype.pushAccesUnit=function e(t,r){if(t.units.length&&t.frame){var i=r.samples;var a=i.length;if(!this.config.forceKeyFrameOnDiscontinuity||t.key===true||r.sps&&(a||this.contiguous)){t.id=a;i.push(t)}else{r.dropped++}}if(t.debug.length){ie["b"].log(t.pts+"/"+t.dts+":"+t.debug)}};C.prototype._parseAVCPES=function e(E,t){var T=this;var S=this._avcTrack,r=this._parseAVCNALu(E.data),w=false,A=void 0,_=this.avcSample,R=void 0,L=false,k=void 0,D=this.pushAccesUnit.bind(this),I=function e(t,r,i,a){return{key:t,pts:r,dts:i,units:[],debug:a}};E.data=null;if(_&&r.length&&!S.audFound){D(_,S);_=this.avcSample=I(false,E.pts,E.dts,"")}r.forEach(function(e){switch(e.type){case 1:R=true;if(!_){_=T.avcSample=I(true,E.pts,E.dts,"")}if(w){_.debug+="NDR "}_.frame=true;var t=e.data;if(L&&t.length>4){var r=new O(t).readSliceType();if(r===2||r===4||r===7||r===9){_.key=true}}break;case 5:R=true;if(!_){_=T.avcSample=I(true,E.pts,E.dts,"")}if(w){_.debug+="IDR "}_.key=true;_.frame=true;break;case 6:R=true;if(w&&_){_.debug+="SEI "}A=new O(T.discardEPB(e.data));A.readUByte();var i=0;var a=0;var n=false;var s=0;while(!n&&A.bytesAvailable>1){i=0;do{s=A.readUByte();i+=s}while(s===255);a=0;do{s=A.readUByte();a+=s}while(s===255);if(i===4&&A.bytesAvailable!==0){n=true;var o=A.readUByte();if(o===181){var l=A.readUShort();if(l===49){var u=A.readUInt();if(u===1195456820){var f=A.readUByte();if(f===3){var c=A.readUByte();var d=A.readUByte();var h=31&c;var p=[c,d];for(k=0;k<h;k++){p.push(A.readUByte());p.push(A.readUByte());p.push(A.readUByte())}T._insertSampleInOrder(T._txtTrack.samples,{type:3,pts:E.pts,bytes:p})}}}}}else if(a<A.bytesAvailable){for(k=0;k<a;k++){A.readUByte()}}}break;case 7:R=true;L=true;if(w&&_){_.debug+="SPS "}if(!S.sps){A=new O(e.data);var v=A.readSPS();S.width=v.width;S.height=v.height;S.pixelRatio=v.pixelRatio;S.sps=[e.data];S.duration=T._duration;var y=e.data.subarray(1,4);var g="avc1.";for(k=0;k<3;k++){var m=y[k].toString(16);if(m.length<2){m="0"+m}g+=m}S.codec=g}break;case 8:R=true;if(w&&_){_.debug+="PPS "}if(!S.pps){S.pps=[e.data]}break;case 9:R=false;S.audFound=true;if(_){D(_,S)}_=T.avcSample=I(false,E.pts,E.dts,w?"AUD ":"");break;case 12:R=false;break;default:R=false;if(_){_.debug+="unknown NAL "+e.type+" "}break}if(_&&R){var b=_.units;b.push(e)}});if(t&&_){D(_,S);this.avcSample=null}};C.prototype._insertSampleInOrder=function e(t,r){var i=t.length;if(i>0){if(r.pts>=t[i-1].pts){t.push(r)}else{for(var a=i-1;a>=0;a--){if(r.pts<t[a].pts){t.splice(a,0,r);break}}}}else{t.push(r)}};C.prototype._getLastNalUnit=function e(){var t=this.avcSample,r=void 0;if(!t||t.units.length===0){var i=this._avcTrack,a=i.samples;t=a[a.length-1]}if(t){var n=t.units;r=n[n.length-1]}return r};C.prototype._parseAVCNALu=function e(t){var r=0,i=t.byteLength,a=void 0,n=void 0,s=this._avcTrack,o=s.naluState||0,l=o;var u=[],f=void 0,c=void 0,d=-1,h=void 0;if(o===-1){d=0;h=t[0]&31;o=0;r=1}while(r<i){a=t[r++];if(!o){o=a?0:1;continue}if(o===1){o=a?0:2;continue}if(!a){o=3}else if(a===1){if(d>=0){f={data:t.subarray(d,r-o-1),type:h};u.push(f)}else{var p=this._getLastNalUnit();if(p){if(l&&r<=4-l){if(p.state){p.data=p.data.subarray(0,p.data.byteLength-l)}}n=r-o-1;if(n>0){var v=new Uint8Array(p.data.byteLength+n);v.set(p.data,0);v.set(t.subarray(0,n),p.data.byteLength);p.data=v}}}if(r<i){c=t[r]&31;d=r;h=c;o=0}else{o=-1}}else{o=0}}if(d>=0&&o>=0){f={data:t.subarray(d,i),type:h,state:o};u.push(f)}if(u.length===0){var y=this._getLastNalUnit();if(y){var g=new Uint8Array(y.data.byteLength+t.byteLength);g.set(y.data,0);g.set(t,y.data.byteLength);y.data=g}}s.naluState=o;return u};C.prototype.discardEPB=function e(t){var r=t.byteLength,i=[],a=1,n=void 0,s=void 0;while(a<r-2){if(t[a]===0&&t[a+1]===0&&t[a+2]===3){i.push(a+2);a+=2}else{a++}}if(i.length===0){return t}n=r-i.length;s=new Uint8Array(n);var o=0;for(a=0;a<n;o++,a++){if(o===i[0]){o++;i.shift()}s[a]=t[o]}return s};C.prototype._parseAACPES=function e(t){var r=this._audioTrack,i=t.data,a=t.pts,n=0,s=this.aacOverFlow,o=this.aacLastPTS,l=void 0,u=void 0,f=void 0,c=void 0,d=void 0;if(s){var h=new Uint8Array(s.byteLength+i.byteLength);h.set(s,0);h.set(i,s.byteLength);i=h}for(f=n,d=i.length;f<d-1;f++){if(m(i,f)){break}}if(f){var p=void 0,v=void 0;if(f<d-1){p="AAC PES did not start with ADTS header,offset:"+f;v=false}else{p="no ADTS header found in AAC PES";v=true}ie["b"].warn("parsing error:"+p);this.observer.trigger(te["a"].ERROR,{type:re["b"].MEDIA_ERROR,details:re["a"].FRAG_PARSING_ERROR,fatal:v,reason:p});if(v){return}}b(r,this.observer,i,f,this.audioCodec);u=0;l=E(r.samplerate);if(s&&o){var y=o+l;if(Math.abs(y-a)>1){ie["b"].log("AAC: align PTS for overlapping frames by "+Math.round((y-a)/90));a=y}}while(f<d){if(m(i,f)&&f+5<d){var g=T(r,i,f,a,u);if(g){f+=g.length;c=g.sample.pts;u++}else{break}}else{f++}}if(f<d){s=i.subarray(f,d)}else{s=null}this.aacOverFlow=s;this.aacLastPTS=c};C.prototype._parseMPEGPES=function e(t){var r=t.data;var i=r.length;var a=0;var n=0;var s=t.pts;while(n<i){if(w.isHeader(r,n)){var o=w.appendFrame(this._audioTrack,r,n,s,a);if(o){n+=o.length;a++}else{break}}else{n++}}};C.prototype._parseID3PES=function e(t){this._id3Track.samples.push(t)};return C}();var P=I;function C(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var x=function(){function i(e,t,r){C(this,i);this.observer=e;this.config=r;this.remuxer=t}i.prototype.resetInitSegment=function e(t,r,i,a){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:false,samples:[],len:0,manifestCodec:r,duration:a,inputTimeScale:9e4}};i.prototype.resetTimeStamp=function e(){};i.probe=function e(t){var r=void 0,i=void 0;var a=g["a"].getID3Data(t,0);if(a&&g["a"].getTimeStamp(a)!==undefined){for(r=a.length,i=Math.min(t.length-1,r+100);r<i;r++){if(w.probe(t,r)){ie["b"].log("MPEG Audio sync word found !");return true}}}return false};i.prototype.append=function e(t,r,i,a){var n=g["a"].getID3Data(t,0);var s=g["a"].getTimeStamp(n);var o=s?90*s:r*9e4;var l=n.length;var u=t.length;var f=0,c=0;var d=this._audioTrack;var h=[{pts:o,dts:o,data:n}];while(l<u){if(w.isHeader(t,l)){var p=w.appendFrame(d,t,l,o,f);if(p){l+=p.length;c=p.sample.pts;f++}else{break}}else if(g["a"].isHeader(t,l)){n=g["a"].getID3Data(t,l);h.push({pts:c,dts:c,data:n});l+=n.length}else{l++}}this.remuxer.remux(d,{samples:[]},{samples:h,inputTimeScale:9e4},{samples:[]},r,i,a)};i.prototype.destroy=function e(){};return i}();var M=x;function F(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var N=function(){function e(){F(this,e)}e.getSilentFrame=function e(t,r){switch(t){case"mp4a.40.2":if(r===1){return new Uint8Array([0,200,0,128,35,128])}else if(r===2){return new Uint8Array([33,0,73,144,2,25,0,35,128])}else if(r===3){return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142])}else if(r===4){return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56])}else if(r===5){return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56])}else if(r===6){return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}break;default:if(r===1){return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}else if(r===2){return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}else if(r===3){return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}break}return null};return e}();var X=N;function U(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var B=Math.pow(2,32)-1;var G=function(){function h(){U(this,h)}h.init=function e(){h.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var t=void 0;for(t in h.types){if(h.types.hasOwnProperty(t)){h.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]}}var r=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]);var i=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);h.HDLR_TYPES={video:r,audio:i};var a=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]);var n=new Uint8Array([0,0,0,0,0,0,0,0]);h.STTS=h.STSC=h.STCO=n;h.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]);h.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]);h.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]);h.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var s=new Uint8Array([105,115,111,109]);var o=new Uint8Array([97,118,99,49]);var l=new Uint8Array([0,0,0,1]);h.FTYP=h.box(h.types.ftyp,s,l,s,o);h.DINF=h.box(h.types.dinf,h.box(h.types.dref,a))};h.box=function e(t){var r=Array.prototype.slice.call(arguments,1),i=8,a=r.length,n=a,s=void 0;while(a--){i+=r[a].byteLength}s=new Uint8Array(i);s[0]=i>>24&255;s[1]=i>>16&255;s[2]=i>>8&255;s[3]=i&255;s.set(t,4);for(a=0,i=8;a<n;a++){s.set(r[a],i);i+=r[a].byteLength}return s};h.hdlr=function e(t){return h.box(h.types.hdlr,h.HDLR_TYPES[t])};h.mdat=function e(t){return h.box(h.types.mdat,t)};h.mdhd=function e(t,r){r*=t;var i=Math.floor(r/(B+1));var a=Math.floor(r%(B+1));return h.box(h.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,i>>24,i>>16&255,i>>8&255,i&255,a>>24,a>>16&255,a>>8&255,a&255,85,196,0,0]))};h.mdia=function e(t){return h.box(h.types.mdia,h.mdhd(t.timescale,t.duration),h.hdlr(t.type),h.minf(t))};h.mfhd=function e(t){return h.box(h.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255]))};h.minf=function e(t){if(t.type==="audio"){return h.box(h.types.minf,h.box(h.types.smhd,h.SMHD),h.DINF,h.stbl(t))}else{return h.box(h.types.minf,h.box(h.types.vmhd,h.VMHD),h.DINF,h.stbl(t))}};h.moof=function e(t,r,i){return h.box(h.types.moof,h.mfhd(t),h.traf(i,r))};h.moov=function e(t){var r=t.length,i=[];while(r--){i[r]=h.trak(t[r])}return h.box.apply(null,[h.types.moov,h.mvhd(t[0].timescale,t[0].duration)].concat(i).concat(h.mvex(t)))};h.mvex=function e(t){var r=t.length,i=[];while(r--){i[r]=h.trex(t[r])}return h.box.apply(null,[h.types.mvex].concat(i))};h.mvhd=function e(t,r){r*=t;var i=Math.floor(r/(B+1));var a=Math.floor(r%(B+1));var n=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,i>>24,i>>16&255,i>>8&255,i&255,a>>24,a>>16&255,a>>8&255,a&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return h.box(h.types.mvhd,n)};h.sdtp=function e(t){var r=t.samples||[],i=new Uint8Array(4+r.length),a=void 0,n=void 0;for(n=0;n<r.length;n++){a=r[n].flags;i[n+4]=a.dependsOn<<4|a.isDependedOn<<2|a.hasRedundancy}return h.box(h.types.sdtp,i)};h.stbl=function e(t){return h.box(h.types.stbl,h.stsd(t),h.box(h.types.stts,h.STTS),h.box(h.types.stsc,h.STSC),h.box(h.types.stsz,h.STSZ),h.box(h.types.stco,h.STCO))};h.avc1=function e(t){var r=[],i=[],a=void 0,n=void 0,s=void 0;for(a=0;a<t.sps.length;a++){n=t.sps[a];s=n.byteLength;r.push(s>>>8&255);r.push(s&255);r=r.concat(Array.prototype.slice.call(n))}for(a=0;a<t.pps.length;a++){n=t.pps[a];s=n.byteLength;i.push(s>>>8&255);i.push(s&255);i=i.concat(Array.prototype.slice.call(n))}var o=h.box(h.types.avcC,new Uint8Array([1,r[3],r[4],r[5],252|3,224|t.sps.length].concat(r).concat([t.pps.length]).concat(i))),l=t.width,u=t.height,f=t.pixelRatio[0],c=t.pixelRatio[1];return h.box(h.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,l&255,u>>8&255,u&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o,h.box(h.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),h.box(h.types.pasp,new Uint8Array([f>>24,f>>16&255,f>>8&255,f&255,c>>24,c>>16&255,c>>8&255,c&255])))};h.esds=function e(t){var r=t.config.length;return new Uint8Array([0,0,0,0,3,23+r,0,1,0,4,15+r,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([r]).concat(t.config).concat([6,1,2]))};h.mp4a=function e(t){var r=t.samplerate;return h.box(h.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,r>>8&255,r&255,0,0]),h.box(h.types.esds,h.esds(t)))};h.mp3=function e(t){var r=t.samplerate;return h.box(h.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,r>>8&255,r&255,0,0]))};h.stsd=function e(t){if(t.type==="audio"){if(!t.isAAC&&t.codec==="mp3"){return h.box(h.types.stsd,h.STSD,h.mp3(t))}return h.box(h.types.stsd,h.STSD,h.mp4a(t))}else{return h.box(h.types.stsd,h.STSD,h.avc1(t))}};h.tkhd=function e(t){var r=t.id,i=t.duration*t.timescale,a=t.width,n=t.height,s=Math.floor(i/(B+1)),o=Math.floor(i%(B+1));return h.box(h.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,r>>24&255,r>>16&255,r>>8&255,r&255,0,0,0,0,s>>24,s>>16&255,s>>8&255,s&255,o>>24,o>>16&255,o>>8&255,o&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,a>>8&255,a&255,0,0,n>>8&255,n&255,0,0]))};h.traf=function e(t,r){var i=h.sdtp(t),a=t.id,n=Math.floor(r/(B+1)),s=Math.floor(r%(B+1));return h.box(h.types.traf,h.box(h.types.tfhd,new Uint8Array([0,0,0,0,a>>24,a>>16&255,a>>8&255,a&255])),h.box(h.types.tfdt,new Uint8Array([1,0,0,0,n>>24,n>>16&255,n>>8&255,n&255,s>>24,s>>16&255,s>>8&255,s&255])),h.trun(t,i.length+16+20+8+16+8+8),i)};h.trak=function e(t){t.duration=t.duration||4294967295;return h.box(h.types.trak,h.tkhd(t),h.mdia(t))};h.trex=function e(t){var r=t.id;return h.box(h.types.trex,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,r&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))};h.trun=function e(t,r){var i=t.samples||[],a=i.length,n=12+16*a,s=new Uint8Array(n),o=void 0,l=void 0,u=void 0,f=void 0,c=void 0,d=void 0;r+=8+n;s.set([0,0,15,1,a>>>24&255,a>>>16&255,a>>>8&255,a&255,r>>>24&255,r>>>16&255,r>>>8&255,r&255],0);for(o=0;o<a;o++){l=i[o];u=l.duration;f=l.size;c=l.flags;d=l.cts;s.set([u>>>24&255,u>>>16&255,u>>>8&255,u&255,f>>>24&255,f>>>16&255,f>>>8&255,f&255,c.isLeading<<2|c.dependsOn,c.isDependedOn<<6|c.hasRedundancy<<4|c.paddingValue<<1|c.isNonSync,c.degradPrio&240<<8,c.degradPrio&15,d>>>24&255,d>>>16&255,d>>>8&255,d&255],12+16*o)}return h.box(h.types.trun,s)};h.initSegment=function e(t){if(!h.types){h.init()}var r=h.moov(t),i=void 0;i=new Uint8Array(h.FTYP.byteLength+r.byteLength);i.set(h.FTYP);i.set(r,h.FTYP.byteLength);return i};return h}();var ae=G;function j(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var Q=10*1e3;var K=function(){function n(e,t,r,i){j(this,n);this.observer=e;this.config=t;this.typeSupported=r;var a=navigator.userAgent;this.isSafari=i&&i.indexOf("Apple")>-1&&a&&!a.match("CriOS");this.ISGenerated=false}n.prototype.destroy=function e(){};n.prototype.resetTimeStamp=function e(t){this._initPTS=this._initDTS=t};n.prototype.resetInitSegment=function e(){this.ISGenerated=false};n.prototype.remux=function e(t,r,i,a,n,s,o){if(!this.ISGenerated){this.generateIS(t,r,n)}if(this.ISGenerated){var l=t.samples.length;var u=r.samples.length;var f=n;var c=n;if(l&&u){var d=(t.samples[0].dts-r.samples[0].dts)/r.inputTimeScale;f+=Math.max(0,d);c+=Math.max(0,-d)}if(l){if(!t.timescale){ie["b"].warn("regenerate InitSegment as audio detected");this.generateIS(t,r,n)}var h=this.remuxAudio(t,f,s,o);if(u){var p=void 0;if(h){p=h.endPTS-h.startPTS}if(!r.timescale){ie["b"].warn("regenerate InitSegment as video detected");this.generateIS(t,r,n)}this.remuxVideo(r,c,s,p,o)}}else{if(u){var v=this.remuxVideo(r,c,s,0,o);if(v&&t.codec){this.remuxEmptyAudio(t,f,s,v)}}}}if(i.samples.length){this.remuxID3(i,n)}if(a.samples.length){this.remuxText(a,n)}this.observer.trigger(te["a"].FRAG_PARSED)};n.prototype.generateIS=function e(t,r,i){var a=this.observer,n=t.samples,s=r.samples,o=this.typeSupported,l="audio/mp4",u={},f={tracks:u},c=this._initPTS===undefined,d=void 0,h=void 0;if(c){d=h=Infinity}if(t.config&&n.length){t.timescale=t.samplerate;ie["b"].log("audio sampling rate : "+t.samplerate);if(!t.isAAC){if(o.mpeg){l="audio/mpeg";t.codec=""}else if(o.mp3){t.codec="mp3"}}u.audio={container:l,codec:t.codec,initSegment:!t.isAAC&&o.mpeg?new Uint8Array:ae.initSegment([t]),metadata:{channelCount:t.channelCount}};if(c){d=h=n[0].pts-t.inputTimeScale*i}}if(r.sps&&r.pps&&s.length){var p=r.inputTimeScale;r.timescale=p;u.video={container:"video/mp4",codec:r.codec,initSegment:ae.initSegment([r]),metadata:{width:r.width,height:r.height}};if(c){d=Math.min(d,s[0].pts-p*i);h=Math.min(h,s[0].dts-p*i);this.observer.trigger(te["a"].INIT_PTS_FOUND,{initPTS:d})}}if(Object.keys(u).length){a.trigger(te["a"].FRAG_PARSING_INIT_SEGMENT,f);this.ISGenerated=true;if(c){this._initPTS=d;this._initDTS=h}}else{a.trigger(te["a"].ERROR,{type:re["b"].MEDIA_ERROR,details:re["a"].FRAG_PARSING_ERROR,fatal:false,reason:"no audio/video samples found"})}};n.prototype.remuxVideo=function e(t,r,i,a,n){var s=8,o=t.timescale,l=void 0,u=void 0,f=void 0,c=void 0,d=void 0,h=void 0,p=void 0,v=void 0,y=t.samples,g=[],m=y.length,b=this._PTSNormalize,E=this._initDTS;var T=this.nextAvcDts;var S=this.isSafari;if(m===0){return}if(S){i|=y.length&&T&&(n&&Math.abs(r-T/o)<.1||Math.abs(y[0].pts-T-E)<o/5)}if(!i){T=r*o}y.forEach(function(e){e.pts=b(e.pts-E,T);e.dts=b(e.dts-E,T)});y.sort(function(e,t){var r=e.dts-t.dts;var i=e.pts-t.pts;return r||i||e.id-t.id});var w=y.reduce(function(e,t){return Math.max(Math.min(e,t.pts-t.dts),-18e3)},0);if(w<0){ie["b"].warn("PTS < DTS detected in video samples, shifting DTS by "+Math.round(w/90)+" ms to overcome this issue");for(var A=0;A<y.length;A++){y[A].dts+=w}}var _=y[0];d=Math.max(_.dts,0);c=Math.max(_.pts,0);var R=Math.round((d-T)/90);if(i){if(R){if(R>1){ie["b"].log("AVC:"+R+" ms hole between fragments detected,filling it")}else if(R<-1){ie["b"].log("AVC:"+-R+" ms overlapping between fragments detected")}d=T;y[0].dts=d;c=Math.max(c-R,T);y[0].pts=c;ie["b"].log("Video/PTS/DTS adjusted: "+Math.round(c/90)+"/"+Math.round(d/90)+",delta:"+R+" ms")}}h=d;_=y[y.length-1];v=Math.max(_.dts,0);p=Math.max(_.pts,0,v);if(S){l=Math.round((v-d)/(y.length-1))}var L=0,k=0;for(var D=0;D<m;D++){var I=y[D],O=I.units,P=O.length,C=0;for(var x=0;x<P;x++){C+=O[x].data.length}k+=C;L+=P;I.length=C;if(S){I.dts=d+D*l}else{I.dts=Math.max(I.dts,d)}I.pts=Math.max(I.pts,I.dts)}var M=k+4*L+8;try{u=new Uint8Array(M)}catch(e){this.observer.trigger(te["a"].ERROR,{type:re["b"].MUX_ERROR,details:re["a"].REMUX_ALLOC_ERROR,fatal:false,bytes:M,reason:"fail allocating video mdat "+M});return}var F=new DataView(u.buffer);F.setUint32(0,M);u.set(ae.types.mdat,4);for(var N=0;N<m;N++){var U=y[N],B=U.units,G=0,j=void 0;for(var K=0,H=B.length;K<H;K++){var V=B[K],q=V.data,Y=V.data.byteLength;F.setUint32(s,Y);s+=4;u.set(q,s);s+=Y;G+=4+Y}if(!S){if(N<m-1){l=y[N+1].dts-U.dts}else{var W=this.config,z=U.dts-y[N>0?N-1:N].dts;if(W.stretchShortVideoTrack){var X=W.maxBufferHole,Q=Math.floor(X*o),$=(a?c+a*o:this.nextAudioPts)-U.pts;if($>Q){l=$-z;if(l<0){l=z}ie["b"].log("It is approximately "+$/90+" ms to the next segment; using duration "+l/90+" ms for the last video frame.")}else{l=z}}else{l=z}}j=Math.round(U.pts-U.dts)}else{j=Math.max(0,l*Math.round((U.pts-U.dts)/l))}g.push({size:G,duration:l,cts:j,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:U.key?2:1,isNonSync:U.key?0:1}})}this.nextAvcDts=v+l;var J=t.dropped;t.len=0;t.nbNalu=0;t.dropped=0;if(g.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var Z=g[0].flags;Z.dependsOn=2;Z.isNonSync=0}t.samples=g;f=ae.moof(t.sequenceNumber++,d,t);t.samples=[];var ee={data1:f,data2:u,startPTS:c/o,endPTS:(p+l)/o,startDTS:d/o,endDTS:this.nextAvcDts/o,type:"video",hasAudio:false,hasVideo:true,nb:g.length,dropped:J};this.observer.trigger(te["a"].FRAG_PARSING_DATA,ee);return ee};n.prototype.remuxAudio=function e(t,r,i,a){var n=t.inputTimeScale,s=t.timescale,o=n/s,l=t.isAAC?1024:1152,u=l*o,f=this._PTSNormalize,c=this._initDTS,d=!t.isAAC&&this.typeSupported.mpeg;var h=void 0,p=void 0,v=void 0,y=void 0,g=void 0,m=void 0,b=void 0,E=t.samples,T=[],S=this.nextAudioPts;i|=E.length&&S&&(a&&Math.abs(r-S/n)<.1||Math.abs(E[0].pts-S-c)<20*u);E.forEach(function(e){e.pts=e.dts=f(e.pts-c,r*n)});E=E.filter(function(e){return e.pts>=0});if(E.length===0){return}if(!i){if(!a){S=E[0].pts}else{S=r*n}}if(t.isAAC){var w=this.config.maxAudioFramesDrift;for(var A=0,_=S;A<E.length;){var R=E[A],L;var k=R.pts;L=k-_;var D=Math.abs(1e3*L/n);if(L<=-w*u){ie["b"].warn("Dropping 1 audio frame @ "+(_/n).toFixed(3)+"s due to "+Math.round(D)+" ms overlap.");E.splice(A,1);t.len-=R.unit.length}else if(L>=w*u&&D<Q&&_){var I=Math.round(L/u);ie["b"].warn("Injecting "+I+" audio frame @ "+(_/n).toFixed(3)+"s due to "+Math.round(1e3*L/n)+" ms gap.");for(var O=0;O<I;O++){var P=Math.max(_,0);v=X.getSilentFrame(t.manifestCodec||t.codec,t.channelCount);if(!v){ie["b"].log("Unable to get silent frame for given audio codec; duplicating last frame instead.");v=R.unit.subarray()}E.splice(A,0,{unit:v,pts:P,dts:P});t.len+=v.length;_+=u;A++}R.pts=R.dts=_;_+=u;A++}else{if(Math.abs(L)>.1*u){}R.pts=R.dts=_;_+=u;A++}}}for(var C=0,x=E.length;C<x;C++){var M=E[C];var F=M.unit;var N=M.pts;if(b!==undefined){p.duration=Math.round((N-b)/o)}else{var U=Math.round(1e3*(N-S)/n),B=0;if(i&&t.isAAC){if(U){if(U>0&&U<Q){B=Math.round((N-S)/u);ie["b"].log(U+" ms hole between AAC samples detected,filling it");if(B>0){v=X.getSilentFrame(t.manifestCodec||t.codec,t.channelCount);if(!v){v=F.subarray()}t.len+=B*v.length}}else if(U<-12){ie["b"].log("drop overlapping AAC sample, expected/parsed/delta:"+(S/n).toFixed(3)+"s/"+(N/n).toFixed(3)+"s/"+-U+"ms");t.len-=F.byteLength;continue}N=S}}m=N;if(t.len>0){var G=d?t.len:t.len+8;h=d?0:8;try{y=new Uint8Array(G)}catch(e){this.observer.trigger(te["a"].ERROR,{type:re["b"].MUX_ERROR,details:re["a"].REMUX_ALLOC_ERROR,fatal:false,bytes:G,reason:"fail allocating audio mdat "+G});return}if(!d){var j=new DataView(y.buffer);j.setUint32(0,G);y.set(ae.types.mdat,4)}}else{return}for(var K=0;K<B;K++){v=X.getSilentFrame(t.manifestCodec||t.codec,t.channelCount);if(!v){ie["b"].log("Unable to get silent frame for given audio codec; duplicating this frame instead.");v=F.subarray()}y.set(v,h);h+=v.byteLength;p={size:v.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}};T.push(p)}}y.set(F,h);var H=F.byteLength;h+=H;p={size:H,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}};T.push(p);b=N}var V=0;var q=T.length;if(q>=2){V=T[q-2].duration;p.duration=V}if(q){this.nextAudioPts=S=b+o*V;t.len=0;t.samples=T;if(d){g=new Uint8Array}else{g=ae.moof(t.sequenceNumber++,m/o,t)}t.samples=[];var Y=m/n;var W=S/n;var z={data1:g,data2:y,startPTS:Y,endPTS:W,startDTS:Y,endDTS:W,type:"audio",hasAudio:true,hasVideo:false,nb:q};this.observer.trigger(te["a"].FRAG_PARSING_DATA,z);return z}return null};n.prototype.remuxEmptyAudio=function e(t,r,i,a){var n=t.inputTimeScale,s=t.samplerate?t.samplerate:n,o=n/s,l=this.nextAudioPts,u=(l!==undefined?l:a.startDTS*n)+this._initDTS,f=a.endDTS*n+this._initDTS,c=1024,d=o*c,h=Math.ceil((f-u)/d),p=X.getSilentFrame(t.manifestCodec||t.codec,t.channelCount);ie["b"].warn("remux empty Audio");if(!p){ie["b"].trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!");return}var v=[];for(var y=0;y<h;y++){var g=u+y*d;v.push({unit:p,pts:g,dts:g});t.len+=p.length}t.samples=v;this.remuxAudio(t,r,i)};n.prototype.remuxID3=function e(t,r){var i=t.samples.length,a=void 0;var n=t.inputTimeScale;var s=this._initPTS;var o=this._initDTS;if(i){for(var l=0;l<i;l++){a=t.samples[l];a.pts=(a.pts-s)/n;a.dts=(a.dts-o)/n}this.observer.trigger(te["a"].FRAG_PARSING_METADATA,{samples:t.samples})}t.samples=[];r=r};n.prototype.remuxText=function e(t,r){t.samples.sort(function(e,t){return e.pts-t.pts});var i=t.samples.length,a=void 0;var n=t.inputTimeScale;var s=this._initPTS;if(i){for(var o=0;o<i;o++){a=t.samples[o];a.pts=(a.pts-s)/n}this.observer.trigger(te["a"].FRAG_PARSING_USERDATA,{samples:t.samples})}t.samples=[];r=r};n.prototype._PTSNormalize=function e(t,r){var i=void 0;if(r===undefined){return t}if(r<t){i=-8589934592}else{i=8589934592}while(Math.abs(t-r)>4294967296){t+=i}return t};return n}();var H=K;function V(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var q=function(){function t(e){V(this,t);this.observer=e}t.prototype.destroy=function e(){};t.prototype.resetTimeStamp=function e(){};t.prototype.resetInitSegment=function e(){};t.prototype.remux=function e(t,r,i,a,n,s,o,l){var u=this.observer;var f="";if(t){f+="audio"}if(r){f+="video"}u.trigger(te["a"].FRAG_PARSING_DATA,{data1:l,startPTS:n,startDTS:n,type:f,hasAudio:!!t,hasVideo:!!r,nb:1,dropped:0});u.trigger(te["a"].FRAG_PARSED)};return t}();var Y=q;function W(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var z=Object(i["a"])();var $=z.performance;var J=function(){function a(e,t,r,i){W(this,a);this.observer=e;this.typeSupported=t;this.config=r;this.vendor=i}a.prototype.destroy=function e(){var t=this.demuxer;if(t){t.destroy()}};a.prototype.push=function e(t,r,i,a,n,s,o,l,u,f,c,d){if(t.byteLength>0&&r!=null&&r.key!=null&&r.method==="AES-128"){var h=this.decrypter;if(h==null){h=this.decrypter=new y["a"](this.observer,this.config)}var p=this;var v=void 0;try{v=$.now()}catch(e){v=Date.now()}h.decrypt(t,r.key.buffer,r.iv.buffer,function(e){var t=void 0;try{t=$.now()}catch(e){t=Date.now()}p.observer.trigger(te["a"].FRAG_DECRYPTED,{stats:{tstart:v,tdecrypt:t}});p.pushDecrypted(new Uint8Array(e),r,new Uint8Array(i),a,n,s,o,l,u,f,c,d)})}else{this.pushDecrypted(new Uint8Array(t),r,new Uint8Array(i),a,n,s,o,l,u,f,c,d)}};a.prototype.pushDecrypted=function e(t,r,i,a,n,s,o,l,u,f,c,d){var h=this.demuxer;if(!h||(o||l)&&!this.probe(t)){var p=this.observer;var v=this.typeSupported;var y=this.config;var g=[{demux:P,remux:H},{demux:_["a"],remux:Y},{demux:A,remux:H},{demux:M,remux:H}];for(var m=0,b=g.length;m<b;m++){var E=g[m];var T=E.demux.probe;if(T(t)){var S=this.remuxer=new E.remux(p,y,v,this.vendor);h=new E.demux(p,S,y,v);this.probe=T;break}}if(!h){p.trigger(te["a"].ERROR,{type:re["b"].MEDIA_ERROR,details:re["a"].FRAG_PARSING_ERROR,fatal:true,reason:"no demux matching with content found"});return}this.demuxer=h}var w=this.remuxer;if(o||l){h.resetInitSegment(i,a,n,f);w.resetInitSegment()}if(o){h.resetTimeStamp(d);w.resetTimeStamp(d)}if(typeof h.setDecryptData==="function"){h.setDecryptData(r)}h.append(t,s,u,c)};return a}();var Z=t["a"]=J},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var i={};r.d(i,"newCue",function(){return Hr});var a=r(5);var n=r.n(a);var h=r(2);var x=r(3);var M=r(1);var F=r(0);var s=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var l=new Set(["hlsEventGeneric","hlsHandlerDestroying","hlsHandlerDestroyed"]);var u=function(){function a(e){o(this,a);this.hls=e;this.onEvent=this.onEvent.bind(this);for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++){r[i-1]=arguments[i]}this.handledEvents=r;this.useGenericHandler=true;this.registerListeners()}a.prototype.destroy=function e(){this.onHandlerDestroying();this.unregisterListeners();this.onHandlerDestroyed()};a.prototype.onHandlerDestroying=function e(){};a.prototype.onHandlerDestroyed=function e(){};a.prototype.isEventHandler=function e(){return s(this.handledEvents)==="object"&&this.handledEvents.length&&typeof this.onEvent==="function"};a.prototype.registerListeners=function e(){if(this.isEventHandler()){this.handledEvents.forEach(function(e){if(l.has(e)){throw new Error("Forbidden event-name: "+e)}this.hls.on(e,this.onEvent)},this)}};a.prototype.unregisterListeners=function e(){if(this.isEventHandler()){this.handledEvents.forEach(function(e){this.hls.off(e,this.onEvent)},this)}};a.prototype.onEvent=function e(t,r){this.onEventGeneric(t,r)};a.prototype.onEventGeneric=function e(t,r){var i=function e(t,r){var i="on"+t.replace("hls","");if(typeof this[i]!=="function"){throw new Error("Event "+t+" has no generic handler in this "+this.constructor.name+" class (tried "+i+")")}return this[i].bind(this,r)};try{i.call(this,t,r).call()}catch(e){F["b"].error("An internal error happened while handling event "+t+'. Error message: "'+e.message+'". Here is a stacktrace:',e);this.hls.trigger(M["a"].ERROR,{type:h["b"].OTHER_ERROR,details:h["a"].INTERNAL_EXCEPTION,fatal:false,event:t,err:e})}};return a}();var f=u;var c=r(9);var d=function(){function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}return function(e,t,r){if(t)i(e.prototype,t);if(r)i(e,r);return e}}();function p(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var v=function(){function e(){p(this,e);this.method=null;this.key=null;this.iv=null;this._uri=null}d(e,[{key:"uri",get:function e(){if(!this._uri&&this.reluri){this._uri=n.a.buildAbsoluteURL(this.baseuri,this.reluri,{alwaysNormalize:true})}return this._uri}}]);return e}();var O=v;var y=function(){function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}return function(e,t,r){if(t)i(e.prototype,t);if(r)i(e,r);return e}}();function g(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var m=function(){function t(){var e;g(this,t);this._url=null;this._byteRange=null;this._decryptdata=null;this.tagList=[];this.programDateTime=null;this.rawProgramDateTime=null;this._elementaryStreams=(e={},e[t.ElementaryStreamTypes.AUDIO]=false,e[t.ElementaryStreamTypes.VIDEO]=false,e)}t.prototype.addElementaryStream=function e(t){this._elementaryStreams[t]=true};t.prototype.hasElementaryStream=function e(t){return this._elementaryStreams[t]===true};t.prototype.createInitializationVector=function e(t){var r=new Uint8Array(16);for(var i=12;i<16;i++){r[i]=t>>8*(15-i)&255}return r};t.prototype.fragmentDecryptdataFromLevelkey=function e(t,r){var i=t;if(t&&t.method&&t.uri&&!t.iv){i=new O;i.method=t.method;i.baseuri=t.baseuri;i.reluri=t.reluri;i.iv=this.createInitializationVector(r)}return i};y(t,[{key:"url",get:function e(){if(!this._url&&this.relurl){this._url=n.a.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:true})}return this._url},set:function e(t){this._url=t}},{key:"byteRange",get:function e(){if(!this._byteRange&&!this.rawByteRange){return[]}if(this._byteRange){return this._byteRange}var t=[];if(this.rawByteRange){var r=this.rawByteRange.split("@",2);if(r.length===1){var i=this.lastByteRangeEndOffset;t[0]=i||0}else{t[0]=parseInt(r[1])}t[1]=parseInt(r[0])+t[0];this._byteRange=t}return t}},{key:"byteRangeStartOffset",get:function e(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function e(){return this.byteRange[1]}},{key:"decryptdata",get:function e(){if(!this._decryptdata){this._decryptdata=this.fragmentDecryptdataFromLevelkey(this.levelkey,this.sn)}return this._decryptdata}},{key:"endProgramDateTime",get:function e(){if(!Object(x["a"])(this.programDateTime)){return null}var t=!Object(x["a"])(this.duration)?0:this.duration;return this.programDateTime+t*1e3}},{key:"encrypted",get:function e(){return!!(this.decryptdata&&this.decryptdata.uri!==null&&this.decryptdata.key===null)}}],[{key:"ElementaryStreamTypes",get:function e(){return{AUDIO:"audio",VIDEO:"video"}}}]);return t}();var P=m;var b=function(){function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}return function(e,t,r){if(t)i(e.prototype,t);if(r)i(e,r);return e}}();function E(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var T=function(){function t(e){E(this,t);this.endCC=0;this.endSN=0;this.fragments=[];this.initSegment=null;this.live=true;this.needSidxRanges=false;this.startCC=0;this.startSN=0;this.startTimeOffset=null;this.targetduration=0;this.totalduration=0;this.type=null;this.url=e;this.version=null}b(t,[{key:"hasProgramDateTime",get:function e(){return!!(this.fragments[0]&&Object(x["a"])(this.fragments[0].programDateTime))}}]);return t}();var C=T;function S(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var w=/^(\d+)x(\d+)$/;var A=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g;var _=function(){function r(e){S(this,r);if(typeof e==="string"){e=r.parseAttrList(e)}for(var t in e){if(e.hasOwnProperty(t)){this[t]=e[t]}}}r.prototype.decimalInteger=function e(t){var r=parseInt(this[t],10);if(r>Number.MAX_SAFE_INTEGER){return Infinity}return r};r.prototype.hexadecimalInteger=function e(t){if(this[t]){var r=(this[t]||"0x").slice(2);r=(r.length&1?"0":"")+r;var i=new Uint8Array(r.length/2);for(var a=0;a<r.length/2;a++){i[a]=parseInt(r.slice(a*2,a*2+2),16)}return i}else{return null}};r.prototype.hexadecimalIntegerAsNumber=function e(t){var r=parseInt(this[t],16);if(r>Number.MAX_SAFE_INTEGER){return Infinity}return r};r.prototype.decimalFloatingPoint=function e(t){return parseFloat(this[t])};r.prototype.enumeratedString=function e(t){return this[t]};r.prototype.decimalResolution=function e(t){var r=w.exec(this[t]);if(r===null){return undefined}return{width:parseInt(r[1],10),height:parseInt(r[2],10)}};r.parseAttrList=function e(t){var r=void 0,i={};A.lastIndex=0;while((r=A.exec(t))!==null){var a=r[2],n='"';if(a.indexOf(n)===0&&a.lastIndexOf(n)===a.length-1){a=a.slice(1,-1)}i[r[1]]=a}return i};return r}();var N=_;var R={audio:{a3ds:true,"ac-3":true,"ac-4":true,alac:true,alaw:true,dra1:true,"dts+":true,"dts-":true,dtsc:true,dtse:true,dtsh:true,"ec-3":true,enca:true,g719:true,g726:true,m4ae:true,mha1:true,mha2:true,mhm1:true,mhm2:true,mlpa:true,mp4a:true,"raw ":true,Opus:true,samr:true,sawb:true,sawp:true,sevc:true,sqcp:true,ssmv:true,twos:true,ulaw:true},video:{avc1:true,avc2:true,avc3:true,avc4:true,avcp:true,drac:true,dvav:true,dvhe:true,encv:true,hev1:true,hvc1:true,mjp2:true,mp4v:true,mvc1:true,mvc2:true,mvc3:true,mvc4:true,resv:true,rv60:true,s263:true,svc1:true,svc2:true,"vc-1":true,vp08:true,vp09:true}};function L(e,t){var r=R[t];return!!r&&r[e.slice(0,4)]===true}function k(e,t){return window.MediaSource.isTypeSupported((t||"video")+'/mp4;codecs="'+e+'"')}function D(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var I=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g;var U=/#EXT-X-MEDIA:(.*)/g;var B=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)(\S+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g");var G=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)([^:]*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/;var j=/\.(mp4|m4s|m4v|m4a)$/i;var K=function(){function c(){D(this,c)}c.findGroup=function e(t,r){if(!t){return null}var i=null;for(var a=0;a<t.length;a++){var n=t[a];if(n.id===r){i=n}}return i};c.convertAVC1ToAVCOTI=function e(t){var r=void 0,i=t.split(".");if(i.length>2){r=i.shift()+".";r+=parseInt(i.shift()).toString(16);r+=("000"+parseInt(i.shift()).toString(16)).substr(-4)}else{r=t}return r};c.resolve=function e(t,r){return n.a.buildAbsoluteURL(r,t,{alwaysNormalize:true})};c.parseMasterPlaylist=function e(t,r){var i=[],a=void 0;I.lastIndex=0;function n(i,a){["video","audio"].forEach(function(t){var r=i.filter(function(e){return L(e,t)});if(r.length){var e=r.filter(function(e){return e.lastIndexOf("avc1",0)===0||e.lastIndexOf("mp4a",0)===0});a[t+"Codec"]=e.length>0?e[0]:r[0];i=i.filter(function(e){return r.indexOf(e)===-1})}});a.unknownCodecs=i}while((a=I.exec(t))!=null){var s={};var o=s.attrs=new N(a[1]);s.url=c.resolve(a[2],r);var l=o.decimalResolution("RESOLUTION");if(l){s.width=l.width;s.height=l.height}s.bitrate=o.decimalInteger("AVERAGE-BANDWIDTH")||o.decimalInteger("BANDWIDTH");s.name=o.NAME;n([].concat((o.CODECS||"").split(/[ ,]+/)),s);if(s.videoCodec&&s.videoCodec.indexOf("avc1")!==-1){s.videoCodec=c.convertAVC1ToAVCOTI(s.videoCodec)}i.push(s)}return i};c.parseMasterPlaylistMedia=function e(t,r,i){var a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:[];var n=void 0;var s=[];var o=0;U.lastIndex=0;while((n=U.exec(t))!==null){var l={};var u=new N(n[1]);if(u.TYPE===i){l.groupId=u["GROUP-ID"];l.name=u.NAME;l.type=i;l.default=u.DEFAULT==="YES";l.autoselect=u.AUTOSELECT==="YES";l.forced=u.FORCED==="YES";if(u.URI){l.url=c.resolve(u.URI,r)}l.lang=u.LANGUAGE;if(!l.name){l.name=l.lang}if(a.length){var f=c.findGroup(a,l.groupId);l.audioCodec=f?f.codec:a[0].codec}l.id=o++;s.push(l)}}return s};c.parseLevelPlaylist=function e(t,r,i,a,n){var s=0;var o=0;var l=new C(r);var u=new O;var f=0;var c=null;var d=new P;var h=void 0;var p=void 0;var v=null;B.lastIndex=0;while((h=B.exec(t))!==null){var y=h[1];if(y){d.duration=parseFloat(y);var g=(" "+h[2]).slice(1);d.title=g||null;d.tagList.push(g?["INF",y,g]:["INF",y])}else if(h[3]){if(Object(x["a"])(d.duration)){var m=s++;d.type=a;d.start=o;d.levelkey=u;d.sn=m;d.level=i;d.cc=f;d.urlId=n;d.baseurl=r;d.relurl=(" "+h[3]).slice(1);q(d,c);l.fragments.push(d);c=d;o+=d.duration;d=new P}}else if(h[4]){d.rawByteRange=(" "+h[4]).slice(1);if(c){var b=c.byteRangeEndOffset;if(b){d.lastByteRangeEndOffset=b}}}else if(h[5]){d.rawProgramDateTime=(" "+h[5]).slice(1);d.tagList.push(["PROGRAM-DATE-TIME",d.rawProgramDateTime]);if(v===null){v=l.fragments.length}}else{h=h[0].match(G);for(p=1;p<h.length;p++){if(h[p]!==undefined){break}}var E=(" "+h[p+1]).slice(1);var T=(" "+h[p+2]).slice(1);switch(h[p]){case"#":d.tagList.push(T?[E,T]:[E]);break;case"PLAYLIST-TYPE":l.type=E.toUpperCase();break;case"MEDIA-SEQUENCE":s=l.startSN=parseInt(E);break;case"TARGETDURATION":l.targetduration=parseFloat(E);break;case"VERSION":l.version=parseInt(E);break;case"EXTM3U":break;case"ENDLIST":l.live=false;break;case"DIS":f++;d.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":f=parseInt(E);break;case"KEY":var S=E;var w=new N(S);var A=w.enumeratedString("METHOD"),_=w.URI,R=w.hexadecimalInteger("IV");if(A){u=new O;if(_&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(A)>=0){u.method=A;u.baseuri=r;u.reluri=_;u.key=null;u.iv=R}}break;case"START":var L=E;var k=new N(L);var D=k.decimalFloatingPoint("TIME-OFFSET");if(Object(x["a"])(D)){l.startTimeOffset=D}break;case"MAP":var I=new N(E);d.relurl=I.URI;d.rawByteRange=I.BYTERANGE;d.baseurl=r;d.level=i;d.type=a;d.sn="initSegment";l.initSegment=d;d=new P;d.rawProgramDateTime=l.initSegment.rawProgramDateTime;break;default:F["b"].warn("line parsed but not handled: "+h);break}}}d=c;if(d&&!d.relurl){l.fragments.pop();o-=d.duration}l.totalduration=o;l.averagetargetduration=o/l.fragments.length;l.endSN=s-1;l.startCC=l.fragments[0]?l.fragments[0].cc:0;l.endCC=f;if(!l.initSegment&&l.fragments.length){if(l.fragments.every(function(e){return j.test(e.relurl)})){F["b"].warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX");d=new P;d.relurl=l.fragments[0].relurl;d.baseurl=r;d.level=i;d.type=a;d.sn="initSegment";l.initSegment=d;l.needSidxRanges=true}}if(v){V(l.fragments,v)}return l};return c}();var H=K;function V(e,t){var r=e[t];for(var i=t-1;i>=0;i--){var a=e[i];a.programDateTime=r.programDateTime-a.duration*1e3;r=a}}function q(e,t){if(e.rawProgramDateTime){e.programDateTime=Date.parse(e.rawProgramDateTime)}else if(t&&t.programDateTime){e.programDateTime=t.endProgramDateTime}if(!Object(x["a"])(e.programDateTime)){e.programDateTime=null;e.rawProgramDateTime=null}}var Y=function(){function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}return function(e,t,r){if(t)i(e.prototype,t);if(r)i(e,r);return e}}();function W(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function z(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function X(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var Q=window,$=Q.performance;var J={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"};var Z={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};var ee=function(r){X(y,r);function y(e){W(this,y);var t=z(this,r.call(this,e,M["a"].MANIFEST_LOADING,M["a"].LEVEL_LOADING,M["a"].AUDIO_TRACK_LOADING,M["a"].SUBTITLE_TRACK_LOADING));t.loaders={};return t}y.canHaveQualityLevels=function e(t){return t!==J.AUDIO_TRACK&&t!==J.SUBTITLE_TRACK};y.mapContextToLevelType=function e(t){var r=t.type;switch(r){case J.AUDIO_TRACK:return Z.AUDIO;case J.SUBTITLE_TRACK:return Z.SUBTITLE;default:return Z.MAIN}};y.getResponseUrl=function e(t,r){var i=t.url;if(i===undefined||i.indexOf("data:")===0){i=r.url}return i};y.prototype.createInternalLoader=function e(t){var r=this.hls.config;var i=r.pLoader;var a=r.loader;var n=i||a;var s=new n(r);t.loader=s;this.loaders[t.type]=s;return s};y.prototype.getInternalLoader=function e(t){return this.loaders[t.type]};y.prototype.resetInternalLoader=function e(t){if(this.loaders[t]){delete this.loaders[t]}};y.prototype.destroyInternalLoaders=function e(){for(var t in this.loaders){var r=this.loaders[t];if(r){r.destroy()}this.resetInternalLoader(t)}};y.prototype.destroy=function e(){this.destroyInternalLoaders();r.prototype.destroy.call(this)};y.prototype.onManifestLoading=function e(t){this.load(t.url,{type:J.MANIFEST,level:0,id:null})};y.prototype.onLevelLoading=function e(t){this.load(t.url,{type:J.LEVEL,level:t.level,id:t.id})};y.prototype.onAudioTrackLoading=function e(t){this.load(t.url,{type:J.AUDIO_TRACK,level:null,id:t.id})};y.prototype.onSubtitleTrackLoading=function e(t){this.load(t.url,{type:J.SUBTITLE_TRACK,level:null,id:t.id})};y.prototype.load=function e(t,r){var i=this.hls.config;F["b"].debug("Loading playlist of type "+r.type+", level: "+r.level+", id: "+r.id);var a=this.getInternalLoader(r);if(a){var n=a.context;if(n&&n.url===t){F["b"].trace("playlist request ongoing");return false}else{F["b"].warn("aborting previous loader for type: "+r.type);a.abort()}}var s=void 0,o=void 0,l=void 0,u=void 0;switch(r.type){case J.MANIFEST:s=i.manifestLoadingMaxRetry;o=i.manifestLoadingTimeOut;l=i.manifestLoadingRetryDelay;u=i.manifestLoadingMaxRetryTimeout;break;case J.LEVEL:s=0;o=i.levelLoadingTimeOut;break;default:s=i.levelLoadingMaxRetry;o=i.levelLoadingTimeOut;l=i.levelLoadingRetryDelay;u=i.levelLoadingMaxRetryTimeout;break}a=this.createInternalLoader(r);r.url=t;r.responseType=r.responseType||"";var f={timeout:o,maxRetry:s,retryDelay:l,maxRetryDelay:u};var c={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};F["b"].debug("Calling internal loader delegate for URL: "+t);a.load(r,f,c);return true};y.prototype.loadsuccess=function e(t,r,i){var a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;if(i.isSidxRequest){this._handleSidxRequest(t,i);this._handlePlaylistLoaded(t,r,i,a);return}this.resetInternalLoader(i.type);var n=t.data;r.tload=$.now();if(n.indexOf("#EXTM3U")!==0){this._handleManifestParsingError(t,i,"no EXTM3U delimiter",a);return}if(n.indexOf("#EXTINF:")>0||n.indexOf("#EXT-X-TARGETDURATION:")>0){this._handleTrackOrLevelPlaylist(t,r,i,a)}else{this._handleMasterPlaylist(t,r,i,a)}};y.prototype.loaderror=function e(t,r){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;this._handleNetworkError(r,i)};y.prototype.loadtimeout=function e(t,r){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;this._handleNetworkError(r,i,true)};y.prototype._handleMasterPlaylist=function e(t,r,i,a){var n=this.hls;var s=t.data;var o=y.getResponseUrl(t,i);var l=H.parseMasterPlaylist(s,o);if(!l.length){this._handleManifestParsingError(t,i,"no level found in manifest",a);return}var u=l.map(function(e){return{id:e.attrs.AUDIO,codec:e.audioCodec}});var f=H.parseMasterPlaylistMedia(s,o,"AUDIO",u);var c=H.parseMasterPlaylistMedia(s,o,"SUBTITLES");if(f.length){var d=false;f.forEach(function(e){if(!e.url){d=true}});if(d===false&&l[0].audioCodec&&!l[0].attrs.AUDIO){F["b"].log("audio codec signaled in quality level, but no embedded audio track signaled, create one");f.unshift({type:"main",name:"main"})}}n.trigger(M["a"].MANIFEST_LOADED,{levels:l,audioTracks:f,subtitles:c,url:o,stats:r,networkDetails:a})};y.prototype._handleTrackOrLevelPlaylist=function e(t,r,i,a){var n=this.hls;var s=i.id,o=i.level,l=i.type;var u=y.getResponseUrl(t,i);var f=Object(x["a"])(s)?s:0;var c=Object(x["a"])(o)?o:f;var d=y.mapContextToLevelType(i);var h=H.parseLevelPlaylist(t.data,u,c,d,f);h.tload=r.tload;if(l===J.MANIFEST){var p={url:u,details:h};n.trigger(M["a"].MANIFEST_LOADED,{levels:[p],audioTracks:[],url:u,stats:r,networkDetails:a})}r.tparsed=$.now();if(h.needSidxRanges){var v=h.initSegment.url;this.load(v,{isSidxRequest:true,type:l,level:o,levelDetails:h,id:s,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer"});return}i.levelDetails=h;this._handlePlaylistLoaded(t,r,i,a)};y.prototype._handleSidxRequest=function e(t,a){var r=c["a"].parseSegmentIndex(new Uint8Array(t.data));r.references.forEach(function(e,t){var r=e.info;var i=a.levelDetails.fragments[t];if(i.byteRange.length===0){i.rawByteRange=String(1+r.end-r.start)+"@"+String(r.start)}});a.levelDetails.initSegment.rawByteRange=String(r.moovEndOffset)+"@0"};y.prototype._handleManifestParsingError=function e(t,r,i,a){this.hls.trigger(M["a"].ERROR,{type:h["b"].NETWORK_ERROR,details:h["a"].MANIFEST_PARSING_ERROR,fatal:true,url:t.url,reason:i,networkDetails:a})};y.prototype._handleNetworkError=function e(t,r){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;F["b"].info("A network error occured while loading a "+t.type+"-type playlist");var a=void 0;var n=void 0;var s=this.getInternalLoader(t);switch(t.type){case J.MANIFEST:a=i?h["a"].MANIFEST_LOAD_TIMEOUT:h["a"].MANIFEST_LOAD_ERROR;n=true;break;case J.LEVEL:a=i?h["a"].LEVEL_LOAD_TIMEOUT:h["a"].LEVEL_LOAD_ERROR;n=false;break;case J.AUDIO_TRACK:a=i?h["a"].AUDIO_TRACK_LOAD_TIMEOUT:h["a"].AUDIO_TRACK_LOAD_ERROR;n=false;break;default:n=false}if(s){s.abort();this.resetInternalLoader(t.type)}this.hls.trigger(M["a"].ERROR,{type:h["b"].NETWORK_ERROR,details:a,fatal:n,url:s.url,loader:s,context:t,networkDetails:r})};y.prototype._handlePlaylistLoaded=function e(t,r,i,a){var n=i.type,s=i.level,o=i.id,l=i.levelDetails;if(!l.targetduration){this._handleManifestParsingError(t,i,"invalid target duration",a);return}var u=y.canHaveQualityLevels(i.type);if(u){this.hls.trigger(M["a"].LEVEL_LOADED,{details:l,level:s||0,id:o||0,stats:r,networkDetails:a})}else{switch(n){case J.AUDIO_TRACK:this.hls.trigger(M["a"].AUDIO_TRACK_LOADED,{details:l,id:o,stats:r,networkDetails:a});break;case J.SUBTITLE_TRACK:this.hls.trigger(M["a"].SUBTITLE_TRACK_LOADED,{details:l,id:o,stats:r,networkDetails:a});break}}};Y(y,null,[{key:"ContextType",get:function e(){return J}},{key:"LevelType",get:function e(){return Z}}]);return y}(f);var te=ee;function re(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function ie(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function ae(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var ne=function(a){ae(r,a);function r(e){re(this,r);var t=ie(this,a.call(this,e,M["a"].FRAG_LOADING));t.loaders={};return t}r.prototype.destroy=function e(){var t=this.loaders;for(var r in t){var i=t[r];if(i){i.destroy()}}this.loaders={};a.prototype.destroy.call(this)};r.prototype.onFragLoading=function e(t){var r=t.frag,i=r.type,a=this.loaders,n=this.hls.config,s=n.fLoader,o=n.loader;r.loaded=0;var l=a[i];if(l){F["b"].warn("abort previous fragment loader for type: "+i);l.abort()}l=a[i]=r.loader=n.fLoader?new s(n):new o(n);var u=void 0,f=void 0,c=void 0;u={url:r.url,frag:r,responseType:"arraybuffer",progressData:false};var d=r.byteRangeStartOffset,h=r.byteRangeEndOffset;if(Object(x["a"])(d)&&Object(x["a"])(h)){u.rangeStart=d;u.rangeEnd=h}f={timeout:n.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:n.fragLoadingMaxRetryTimeout};c={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)};l.load(u,f,c)};r.prototype.loadsuccess=function e(t,r,i){var a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;var n=t.data,s=i.frag;s.loader=undefined;this.loaders[s.type]=undefined;this.hls.trigger(M["a"].FRAG_LOADED,{payload:n,frag:s,stats:r,networkDetails:a})};r.prototype.loaderror=function e(t,r){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var a=r.frag;var n=a.loader;if(n){n.abort()}this.loaders[a.type]=undefined;this.hls.trigger(M["a"].ERROR,{type:h["b"].NETWORK_ERROR,details:h["a"].FRAG_LOAD_ERROR,fatal:false,frag:r.frag,response:t,networkDetails:i})};r.prototype.loadtimeout=function e(t,r){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var a=r.frag;var n=a.loader;if(n){n.abort()}this.loaders[a.type]=undefined;this.hls.trigger(M["a"].ERROR,{type:h["b"].NETWORK_ERROR,details:h["a"].FRAG_LOAD_TIMEOUT,fatal:false,frag:r.frag,networkDetails:i})};r.prototype.loadprogress=function e(t,r,i){var a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;var n=r.frag;n.loaded=t.loaded;this.hls.trigger(M["a"].FRAG_LOAD_PROGRESS,{frag:n,stats:t,networkDetails:a})};return r}(f);var se=ne;function oe(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function le(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function ue(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var fe=function(r){ue(i,r);function i(e){oe(this,i);var t=le(this,r.call(this,e,M["a"].KEY_LOADING));t.loaders={};t.decryptkey=null;t.decrypturl=null;return t}i.prototype.destroy=function e(){for(var t in this.loaders){var r=this.loaders[t];if(r){r.destroy()}}this.loaders={};f.prototype.destroy.call(this)};i.prototype.onKeyLoading=function e(t){var r=t.frag,i=r.type,a=this.loaders[i],n=r.decryptdata,s=n.uri;if(s!==this.decrypturl||this.decryptkey===null){var o=this.hls.config;if(a){F["b"].warn("abort previous key loader for type:"+i);a.abort()}r.loader=this.loaders[i]=new o.loader(o);this.decrypturl=s;this.decryptkey=null;var l=void 0,u=void 0,f=void 0;l={url:s,frag:r,responseType:"arraybuffer"};u={timeout:o.fragLoadingTimeOut,maxRetry:o.fragLoadingMaxRetry,retryDelay:o.fragLoadingRetryDelay,maxRetryDelay:o.fragLoadingMaxRetryTimeout};f={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};r.loader.load(l,u,f)}else if(this.decryptkey){n.key=this.decryptkey;this.hls.trigger(M["a"].KEY_LOADED,{frag:r})}};i.prototype.loadsuccess=function e(t,r,i){var a=i.frag;this.decryptkey=a.decryptdata.key=new Uint8Array(t.data);a.loader=undefined;this.loaders[a.type]=undefined;this.hls.trigger(M["a"].KEY_LOADED,{frag:a})};i.prototype.loaderror=function e(t,r){var i=r.frag,a=i.loader;if(a){a.abort()}this.loaders[r.type]=undefined;this.hls.trigger(M["a"].ERROR,{type:h["b"].NETWORK_ERROR,details:h["a"].KEY_LOAD_ERROR,fatal:false,frag:i,response:t})};i.prototype.loadtimeout=function e(t,r){var i=r.frag,a=i.loader;if(a){a.abort()}this.loaders[r.type]=undefined;this.hls.trigger(M["a"].ERROR,{type:h["b"].NETWORK_ERROR,details:h["a"].KEY_LOAD_TIMEOUT,fatal:false,frag:i})};return i}(f);var ce=fe;function de(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function he(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function pe(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var ve={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};var ye=function(r){pe(i,r);function i(e){de(this,i);var t=he(this,r.call(this,e,M["a"].BUFFER_APPENDED,M["a"].FRAG_BUFFERED,M["a"].FRAG_LOADED));t.bufferPadding=.2;t.fragments=Object.create(null);t.timeRanges=Object.create(null);t.config=e.config;return t}i.prototype.destroy=function e(){this.fragments=null;this.timeRanges=null;this.config=null;f.prototype.destroy.call(this);r.prototype.destroy.call(this)};i.prototype.getBufferedFrag=function e(i,a){var n=this.fragments;var t=Object.keys(n).filter(function(e){var t=n[e];if(t.body.type!==a){return false}if(!t.buffered){return false}var r=t.body;return r.startPTS<=i&&i<=r.endPTS});if(t.length===0){return null}else{var r=t.pop();return n[r].body}};i.prototype.detectEvictedFragments=function e(a,n){var s=this;var o=void 0,l=void 0;Object.keys(this.fragments).forEach(function(e){var t=s.fragments[e];if(t.buffered===true){var r=t.range[a];if(r){o=r.time;for(var i=0;i<o.length;i++){l=o[i];if(s.isTimeBuffered(l.startPTS,l.endPTS,n)===false){s.removeFragment(t.body);break}}}}})};i.prototype.detectPartialFragments=function e(r){var i=this;var t=this.getFragmentKey(r);var a=this.fragments[t];if(a){a.buffered=true;Object.keys(this.timeRanges).forEach(function(e){if(r.hasElementaryStream(e)){var t=i.timeRanges[e];a.range[e]=i.getBufferedTimes(r.startPTS,r.endPTS,t)}})}};i.prototype.getBufferedTimes=function e(t,r,i){var a=[];var n=void 0,s=void 0;var o=false;for(var l=0;l<i.length;l++){n=i.start(l)-this.bufferPadding;s=i.end(l)+this.bufferPadding;if(t>=n&&r<=s){a.push({startPTS:Math.max(t,i.start(l)),endPTS:Math.min(r,i.end(l))});break}else if(t<s&&r>n){a.push({startPTS:Math.max(t,i.start(l)),endPTS:Math.min(r,i.end(l))});o=true}else if(r<=n){break}}return{time:a,partial:o}};i.prototype.getFragmentKey=function e(t){return t.type+"_"+t.level+"_"+t.urlId+"_"+t.sn};i.prototype.getPartialFragment=function e(r){var i=this;var a=void 0,n=void 0,s=void 0;var o=null;var l=0;Object.keys(this.fragments).forEach(function(e){var t=i.fragments[e];if(i.isPartial(t)){n=t.body.startPTS-i.bufferPadding;s=t.body.endPTS+i.bufferPadding;if(r>=n&&r<=s){a=Math.min(r-n,s-r);if(l<=a){o=t.body;l=a}}}});return o};i.prototype.getState=function e(t){var r=this.getFragmentKey(t);var i=this.fragments[r];var a=ve.NOT_LOADED;if(i!==undefined){if(!i.buffered){a=ve.APPENDING}else if(this.isPartial(i)===true){a=ve.PARTIAL}else{a=ve.OK}}return a};i.prototype.isPartial=function e(t){return t.buffered===true&&(t.range.video!==undefined&&t.range.video.partial===true||t.range.audio!==undefined&&t.range.audio.partial===true)};i.prototype.isTimeBuffered=function e(t,r,i){var a=void 0,n=void 0;for(var s=0;s<i.length;s++){a=i.start(s)-this.bufferPadding;n=i.end(s)+this.bufferPadding;if(t>=a&&r<=n){return true}if(r<=a){return false}}return false};i.prototype.onFragLoaded=function e(t){var r=t.frag;if(Object(x["a"])(r.sn)&&!r.bitrateTest){this.fragments[this.getFragmentKey(r)]={body:r,range:Object.create(null),buffered:false}}};i.prototype.onBufferAppended=function e(t){var r=this;this.timeRanges=t.timeRanges;Object.keys(this.timeRanges).forEach(function(e){var t=r.timeRanges[e];r.detectEvictedFragments(e,t)})};i.prototype.onFragBuffered=function e(t){this.detectPartialFragments(t.frag)};i.prototype.hasFragment=function e(t){var r=this.getFragmentKey(t);return this.fragments[r]!==undefined};i.prototype.removeFragment=function e(t){var r=this.getFragmentKey(t);delete this.fragments[r]};i.prototype.removeAllFragments=function e(){this.fragments=Object.create(null)};return i}(f);var ge={search:function e(t,r){var i=0;var a=t.length-1;var n=null;var s=null;while(i<=a){n=(i+a)/2|0;s=t[n];var o=r(s);if(o>0){i=n+1}else if(o<0){a=n-1}else{return s}}return null}};var me=ge;function be(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var Ee=function(){function e(){be(this,e)}e.isBuffered=function e(t,r){try{if(t){var i=t.buffered;for(var a=0;a<i.length;a++){if(r>=i.start(a)&&r<=i.end(a)){return true}}}}catch(e){}return false};e.bufferInfo=function e(t,r,i){try{if(t){var a=t.buffered,n=[],s=void 0;for(s=0;s<a.length;s++){n.push({start:a.start(s),end:a.end(s)})}return this.bufferedInfo(n,r,i)}}catch(e){}return{len:0,start:r,end:r,nextStart:undefined}};e.bufferedInfo=function e(t,r,i){var a=[],n=void 0,s=void 0,o=void 0,l=void 0,u=void 0;t.sort(function(e,t){var r=e.start-t.start;if(r){return r}else{return t.end-e.end}});for(u=0;u<t.length;u++){var f=a.length;if(f){var c=a[f-1].end;if(t[u].start-c<i){if(t[u].end>c){a[f-1].end=t[u].end}}else{a.push(t[u])}}else{a.push(t[u])}}for(u=0,n=0,s=o=r;u<a.length;u++){var d=a[u].start,h=a[u].end;if(r+i>=d&&r<h){s=d;o=h;n=o-r}else if(r+i<d){l=d;break}}return{len:n,start:s,end:o,nextStart:l}};return e}();var Te=r(7);var Se=r.n(Te);var we=r(12);var Ae=r.n(we);var _e=r(10);function Re(){if(typeof window!=="undefined"){return window.MediaSource||window.WebKitMediaSource}}var Le=r(4);function ke(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var De=Object(Le["a"])();var Ie=Re();var Oe=function(){function l(r,e){ke(this,l);this.hls=r;this.id=e;var n=this.observer=new Se.a;var t=r.config;n.trigger=function e(t){for(var r=arguments.length,i=Array(r>1?r-1:0),a=1;a<r;a++){i[a-1]=arguments[a]}n.emit.apply(n,[t,t].concat(i))};n.off=function e(t){for(var r=arguments.length,i=Array(r>1?r-1:0),a=1;a<r;a++){i[a-1]=arguments[a]}n.removeListener.apply(n,[t].concat(i))};var i=function(e,t){t=t||{};t.frag=this.frag;t.id=this.id;r.trigger(e,t)}.bind(this);n.on(M["a"].FRAG_DECRYPTED,i);n.on(M["a"].FRAG_PARSING_INIT_SEGMENT,i);n.on(M["a"].FRAG_PARSING_DATA,i);n.on(M["a"].FRAG_PARSED,i);n.on(M["a"].ERROR,i);n.on(M["a"].FRAG_PARSING_METADATA,i);n.on(M["a"].FRAG_PARSING_USERDATA,i);n.on(M["a"].INIT_PTS_FOUND,i);var a={mp4:Ie.isTypeSupported("video/mp4"),mpeg:Ie.isTypeSupported("audio/mpeg"),mp3:Ie.isTypeSupported('audio/mp4; codecs="mp3"')};var s=navigator.vendor;if(t.enableWorker&&typeof Worker!=="undefined"){F["b"].log("demuxing in webworker");var o=void 0;try{o=this.w=Ae()(13);this.onwmsg=this.onWorkerMessage.bind(this);o.addEventListener("message",this.onwmsg);o.onerror=function(e){r.trigger(M["a"].ERROR,{type:h["b"].OTHER_ERROR,details:h["a"].INTERNAL_EXCEPTION,fatal:true,event:"demuxerWorker",err:{message:e.message+" ("+e.filename+":"+e.lineno+")"}})};o.postMessage({cmd:"init",typeSupported:a,vendor:s,id:e,config:JSON.stringify(t)})}catch(e){F["b"].error("error while initializing DemuxerWorker, fallback on DemuxerInline");if(o){De.URL.revokeObjectURL(o.objectURL)}this.demuxer=new _e["a"](n,a,t,s);this.w=undefined}}else{this.demuxer=new _e["a"](n,a,t,s)}}l.prototype.destroy=function e(){var t=this.w;if(t){t.removeEventListener("message",this.onwmsg);t.terminate();this.w=null}else{var r=this.demuxer;if(r){r.destroy();this.demuxer=null}}var i=this.observer;if(i){i.removeAllListeners();this.observer=null}};l.prototype.push=function e(t,r,i,a,n,s,o,l){var u=this.w;var f=Object(x["a"])(n.startDTS)?n.startDTS:n.start;var c=n.decryptdata;var d=this.frag;var h=!(d&&n.cc===d.cc);var p=!(d&&n.level===d.level);var v=d&&n.sn===d.sn+1;var y=!p&&v;if(h){F["b"].log(this.id+":discontinuity detected")}if(p){F["b"].log(this.id+":switch detected")}this.frag=n;if(u){u.postMessage({cmd:"demux",data:t,decryptdata:c,initSegment:r,audioCodec:i,videoCodec:a,timeOffset:f,discontinuity:h,trackSwitch:p,contiguous:y,duration:s,accurateTimeOffset:o,defaultInitPTS:l},t instanceof ArrayBuffer?[t]:[])}else{var g=this.demuxer;if(g){g.push(t,c,r,i,a,f,h,p,y,s,o,l)}}};l.prototype.onWorkerMessage=function e(t){var r=t.data,i=this.hls;switch(r.event){case"init":De.URL.revokeObjectURL(this.w.objectURL);break;case M["a"].FRAG_PARSING_DATA:r.data.data1=new Uint8Array(r.data1);if(r.data2){r.data.data2=new Uint8Array(r.data2)}default:r.data=r.data||{};r.data.frag=this.frag;r.data.id=this.id;i.trigger(r.event,r.data);break}};return l}();var Pe=Oe;function Ce(e,t,r){switch(t){case"audio":if(!e.audioGroupIds){e.audioGroupIds=[]}e.audioGroupIds.push(r);break;case"text":if(!e.textGroupIds){e.textGroupIds=[]}e.textGroupIds.push(r);break}}function xe(e,t,r){var i=e[t],a=e[r],n=a.startPTS;if(Object(x["a"])(n)){if(r>t){i.duration=n-i.start;if(i.duration<0){F["b"].warn("negative duration computed for frag "+i.sn+",level "+i.level+", there should be some duration drift between playlist and fragment!")}}else{a.duration=i.start-n;if(a.duration<0){F["b"].warn("negative duration computed for frag "+a.sn+",level "+a.level+", there should be some duration drift between playlist and fragment!")}}}else{if(r>t){a.start=i.start+i.duration}else{a.start=Math.max(i.start-a.duration,0)}}}function Me(e,t,r,i,a,n){var s=r;if(Object(x["a"])(t.startPTS)){var o=Math.abs(t.startPTS-r);if(!Object(x["a"])(t.deltaPTS)){t.deltaPTS=o}else{t.deltaPTS=Math.max(o,t.deltaPTS)}s=Math.max(r,t.startPTS);r=Math.min(r,t.startPTS);i=Math.max(i,t.endPTS);a=Math.min(a,t.startDTS);n=Math.max(n,t.endDTS)}var l=r-t.start;t.start=t.startPTS=r;t.maxStartPTS=s;t.endPTS=i;t.startDTS=a;t.endDTS=n;t.duration=i-r;var u=t.sn;if(!e||u<e.startSN||u>e.endSN){return 0}var f=void 0,c=void 0,d=void 0;f=u-e.startSN;c=e.fragments;c[f]=t;for(d=f;d>0;d--){xe(c,d,d-1)}for(d=f;d<c.length-1;d++){xe(c,d,d+1)}e.PTSKnown=true;return l}function Fe(e,t){var r=Math.max(e.startSN,t.startSN)-t.startSN,i=Math.min(e.endSN,t.endSN)-t.startSN,a=t.startSN-e.startSN,n=e.fragments,s=t.fragments,o=0,l=void 0;if(t.initSegment&&e.initSegment){t.initSegment=e.initSegment}if(i<r){t.PTSKnown=false;return}for(var u=r;u<=i;u++){var f=n[a+u],c=s[u];if(c&&f){o=f.cc-c.cc;if(Object(x["a"])(f.startPTS)){c.start=c.startPTS=f.startPTS;c.endPTS=f.endPTS;c.duration=f.duration;c.backtracked=f.backtracked;c.dropped=f.dropped;l=c}}}if(o){F["b"].log("discontinuity sliding from playlist, take drift into account");for(u=0;u<s.length;u++){s[u].cc+=o}}if(l){Me(t,l,l.startPTS,l.endPTS,l.startDTS,l.endDTS)}else{if(a>=0&&a<n.length){var d=n[a].start;for(u=0;u<s.length;u++){s[u].start+=d}}}t.PTSKnown=e.PTSKnown}var Ne={toString:function e(t){var r="",i=t.length;for(var a=0;a<i;a++){r+="["+t.start(a).toFixed(3)+","+t.end(a).toFixed(3)+"]"}return r}};var Ue=Ne;function Be(e,t){var r=null;for(var i=0;i<e.length;i+=1){var a=e[i];if(a&&a.cc===t){r=a;break}}return r}function Ge(e,t){return me.search(e,function(e){if(e.cc<t){return 1}else if(e.cc>t){return-1}else{return 0}})}function je(e,t,r){var i=false;if(t&&t.details&&r){if(r.endCC>r.startCC||e&&e.cc<r.startCC){i=true}}return i}function Ke(e,t){var r=e.fragments;var i=t.fragments;if(!i.length||!r.length){F["b"].log("No fragments to align");return}var a=Be(r,i[0].cc);if(!a||a&&!a.startPTS){F["b"].log("No frag in previous level to align on");return}return a}function He(r,e){e.fragments.forEach(function(e){if(e){var t=e.start+r;e.start=e.startPTS=t;e.endPTS=t+e.duration}});e.PTSKnown=true}function Ve(e,t,r){qe(e,r,t);if(!r.PTSKnown&&t){Ye(r,t.details)}}function qe(e,t,r){if(je(e,r,t)){var i=Ke(r.details,t);if(i){F["b"].log("Adjusting PTS using last level due to CC increase within current level");He(i.start,t)}}}function Ye(e,t){if(t&&t.fragments.length){if(!e.hasProgramDateTime||!t.hasProgramDateTime){return}var r=t.fragments[0].programDateTime;var i=e.fragments[0].programDateTime;var a=(i-r)/1e3+t.fragments[0].start;if(Object(x["a"])(a)){F["b"].log("adjusting PTS using programDateTime delta, sliding:"+a.toFixed(3));He(a,e)}}}function We(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function ze(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function Xe(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var Qe=function(n){Xe(s,n);function s(e){We(this,s);for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++){r[i-1]=arguments[i]}var a=ze(this,n.call.apply(n,[this,e].concat(r)));a._tickInterval=null;a._tickTimer=null;a._tickCallCount=0;a._boundTick=a.tick.bind(a);return a}s.prototype.onHandlerDestroying=function e(){this.clearNextTick();this.clearInterval()};s.prototype.hasInterval=function e(){return!!this._tickInterval};s.prototype.hasNextTick=function e(){return!!this._tickTimer};s.prototype.setInterval=function(t){function e(e){return t.apply(this,arguments)}e.toString=function(){return t.toString()};return e}(function(e){if(!this._tickInterval){this._tickInterval=setInterval(this._boundTick,e);return true}return false});s.prototype.clearInterval=function(e){function t(){return e.apply(this,arguments)}t.toString=function(){return e.toString()};return t}(function(){if(this._tickInterval){clearInterval(this._tickInterval);this._tickInterval=null;return true}return false});s.prototype.clearNextTick=function e(){if(this._tickTimer){clearTimeout(this._tickTimer);this._tickTimer=null;return true}return false};s.prototype.tick=function e(){this._tickCallCount++;if(this._tickCallCount===1){this.doTick();if(this._tickCallCount>1){this.clearNextTick();this._tickTimer=setTimeout(this._boundTick,0)}this._tickCallCount=0}};s.prototype.doTick=function e(){};return s}(f);var $e=Qe;function Je(e,t,r){if(!Array.isArray(e)||!e.length||!Object(x["a"])(t)){return null}if(t<e[0].programDateTime){return null}if(t>=e[e.length-1].endProgramDateTime){return null}r=r||0;for(var i=0;i<e.length;++i){var a=e[i];if(tt(t,r,a)){return a}}return null}function Ze(e,t){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;var a=e?t[e.sn-t[0].sn+1]:null;if(a&&!et(r,i,a)){return a}return me.search(t,et.bind(null,r,i))}function et(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var r=arguments[2];var i=Math.min(t,r.duration+(r.deltaPTS?r.deltaPTS:0));if(r.start+r.duration-i<=e){return 1}else if(r.start-i>e&&r.start){return-1}return 0}function tt(e,t,r){var i=Math.min(t,r.duration+(r.deltaPTS?r.deltaPTS:0))*1e3;return r.endProgramDateTime-i>e}function rt(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var it=1e3;var at=.5;var nt=function(){function a(e,t,r,i){rt(this,a);this.config=e;this.media=t;this.fragmentTracker=r;this.hls=i;this.stallReported=false}a.prototype.poll=function e(t,r){var i=this.config,a=this.media;var n=a.currentTime;var s=window.performance.now();if(n!==t){if(this.stallReported){F["b"].warn("playback not stuck anymore @"+n+", after "+Math.round(s-this.stalled)+"ms");this.stallReported=false}this.stalled=null;this.nudgeRetry=0;return}if(a.ended||!a.buffered.length||a.readyState>2){return}if(a.seeking&&Ee.isBuffered(a,n)){return}var o=s-this.stalled;var l=Ee.bufferInfo(a,n,i.maxBufferHole);if(!this.stalled){this.stalled=s;return}else if(o>=it){this._reportStall(l.len)}this._tryFixBufferStall(l,o)};a.prototype._tryFixBufferStall=function e(t,r){var i=this.config,a=this.fragmentTracker,n=this.media;var s=n.currentTime;var o=a.getPartialFragment(s);if(o){this._trySkipBufferHole(o)}if(t.len>at&&r>i.highBufferWatchdogPeriod*1e3){this.stalled=null;this._tryNudgeBuffer()}};a.prototype._reportStall=function e(t){var r=this.hls,i=this.media,a=this.stallReported;if(!a){this.stallReported=true;F["b"].warn("Playback stalling at @"+i.currentTime+" due to low buffer");r.trigger(M["a"].ERROR,{type:h["b"].MEDIA_ERROR,details:h["a"].BUFFER_STALLED_ERROR,fatal:false,buffer:t})}};a.prototype._trySkipBufferHole=function e(t){var r=this.hls,i=this.media;var a=i.currentTime;var n=0;for(var s=0;s<i.buffered.length;s++){var o=i.buffered.start(s);if(a>=n&&a<o){i.currentTime=Math.max(o,i.currentTime+.1);F["b"].warn("skipping hole, adjusting currentTime from "+a+" to "+i.currentTime);this.stalled=null;r.trigger(M["a"].ERROR,{type:h["b"].MEDIA_ERROR,details:h["a"].BUFFER_SEEK_OVER_HOLE,fatal:false,reason:"fragment loaded with buffer holes, seeking from "+a+" to "+i.currentTime,frag:t});return}n=i.buffered.end(s)}};a.prototype._tryNudgeBuffer=function e(){var t=this.config,r=this.hls,i=this.media;var a=i.currentTime;var n=(this.nudgeRetry||0)+1;this.nudgeRetry=n;if(n<t.nudgeMaxRetry){var s=a+n*t.nudgeOffset;F["b"].log("adjust currentTime from "+a+" to "+s);i.currentTime=s;r.trigger(M["a"].ERROR,{type:h["b"].MEDIA_ERROR,details:h["a"].BUFFER_NUDGE_ON_STALL,fatal:false})}else{F["b"].error("still stuck in high buffer @"+a+" after "+t.nudgeMaxRetry+", raise fatal error");r.trigger(M["a"].ERROR,{type:h["b"].MEDIA_ERROR,details:h["a"].BUFFER_STALLED_ERROR,fatal:true})}};return a}();var st=nt;var ot=function(){function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}return function(e,t,r){if(t)i(e.prototype,t);if(r)i(e,r);return e}}();function lt(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function ut(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function ft(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var ct={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_LEVEL:"WAITING_LEVEL",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR"};var dt=function(i){ft(a,i);function a(e,t){lt(this,a);var r=ut(this,i.call(this,e,M["a"].MEDIA_ATTACHED,M["a"].MEDIA_DETACHING,M["a"].MANIFEST_LOADING,M["a"].MANIFEST_PARSED,M["a"].LEVEL_LOADED,M["a"].KEY_LOADED,M["a"].FRAG_LOADED,M["a"].FRAG_LOAD_EMERGENCY_ABORTED,M["a"].FRAG_PARSING_INIT_SEGMENT,M["a"].FRAG_PARSING_DATA,M["a"].FRAG_PARSED,M["a"].ERROR,M["a"].AUDIO_TRACK_SWITCHING,M["a"].AUDIO_TRACK_SWITCHED,M["a"].BUFFER_CREATED,M["a"].BUFFER_APPENDED,M["a"].BUFFER_FLUSHED));r.fragmentTracker=t;r.config=e.config;r.audioCodecSwap=false;r._state=ct.STOPPED;r.stallReported=false;r.gapController=null;return r}a.prototype.onHandlerDestroying=function e(){this.stopLoad();i.prototype.onHandlerDestroying.call(this)};a.prototype.onHandlerDestroyed=function e(){this.state=ct.STOPPED;this.fragmentTracker=null;i.prototype.onHandlerDestroyed.call(this)};a.prototype.startLoad=function e(t){if(this.levels){var r=this.lastCurrentTime,i=this.hls;this.stopLoad();this.setInterval(100);this.level=-1;this.fragLoadError=0;if(!this.startFragRequested){var a=i.startLevel;if(a===-1){a=0;this.bitrateTest=true}this.level=i.nextLoadLevel=a;this.loadedmetadata=false}if(r>0&&t===-1){F["b"].log("override startPosition with lastCurrentTime @"+r.toFixed(3));t=r}this.state=ct.IDLE;this.nextLoadPosition=this.startPosition=this.lastCurrentTime=t;this.tick()}else{this.forceStartLoad=true;this.state=ct.STOPPED}};a.prototype.stopLoad=function e(){var t=this.fragCurrent;if(t){if(t.loader){t.loader.abort()}this.fragmentTracker.removeFragment(t);this.fragCurrent=null}this.fragPrevious=null;if(this.demuxer){this.demuxer.destroy();this.demuxer=null}this.clearInterval();this.state=ct.STOPPED;this.forceStartLoad=false};a.prototype.doTick=function e(){switch(this.state){case ct.BUFFER_FLUSHING:this.fragLoadError=0;break;case ct.IDLE:this._doTickIdle();break;case ct.WAITING_LEVEL:var t=this.levels[this.level];if(t&&t.details){this.state=ct.IDLE}break;case ct.FRAG_LOADING_WAITING_RETRY:var r=window.performance.now();var i=this.retryDate;if(!i||r>=i||this.media&&this.media.seeking){F["b"].log("mediaController: retryDate reached, switch back to IDLE state");this.state=ct.IDLE}break;case ct.ERROR:case ct.STOPPED:case ct.FRAG_LOADING:case ct.PARSING:case ct.PARSED:case ct.ENDED:break;default:break}this._checkBuffer();this._checkFragmentChanged()};a.prototype._doTickIdle=function e(){var t=this.hls,r=t.config,i=this.media;if(this.levelLastLoaded===undefined||!i&&(this.startFragRequested||!r.startFragPrefetch)){return}var a=void 0;if(this.loadedmetadata){a=i.currentTime}else{a=this.nextLoadPosition}var n=t.nextLoadLevel,s=this.levels[n];if(!s){return}var o=s.bitrate,l=void 0;if(o){l=Math.max(8*r.maxBufferSize/o,r.maxBufferLength)}else{l=r.maxBufferLength}l=Math.min(l,r.maxMaxBufferLength);var u=Ee.bufferInfo(this.mediaBuffer?this.mediaBuffer:i,a,r.maxBufferHole),f=u.len;if(f>=l){return}F["b"].trace("buffer length of "+f.toFixed(3)+" is below max of "+l.toFixed(3)+". checking for more payload ...");this.level=t.nextLoadLevel=n;var c=s.details;if(!c||c.live&&this.levelLastLoaded!==n){this.state=ct.WAITING_LEVEL;return}var d=this.fragPrevious;if(!c.live&&d&&!d.backtracked&&d.sn===c.endSN&&!u.nextStart){var h=Math.min(i.duration,d.start+d.duration);if(h-Math.max(u.end,d.start)<=Math.max(.2,d.duration)){var p={};if(this.altAudio){p.type="video"}this.hls.trigger(M["a"].BUFFER_EOS,p);this.state=ct.ENDED;return}}this._fetchPayloadOrEos(a,u,c)};a.prototype._fetchPayloadOrEos=function e(t,r,i){var a=this.fragPrevious,n=this.level,s=i.fragments,o=s.length;if(o===0){return}var l=s[0].start,u=s[o-1].start+s[o-1].duration,f=r.end,c=void 0;if(i.initSegment&&!i.initSegment.data){c=i.initSegment}else{if(i.live){var d=this.config.initialLiveManifestSize;if(o<d){F["b"].warn("Can not start playback of a level, reason: not enough fragments "+o+" < "+d);return}c=this._ensureFragmentAtLivePoint(i,f,l,u,a,s,o);if(c===null){return}}else{if(f<l){c=s[0]}}}if(!c){c=this._findFragment(l,a,o,s,f,u,i)}if(c){if(c.encrypted){F["b"].log("Loading key for "+c.sn+" of ["+i.startSN+" ,"+i.endSN+"],level "+n);this._loadKey(c)}else{F["b"].log("Loading "+c.sn+" of ["+i.startSN+" ,"+i.endSN+"],level "+n+", currentTime:"+t.toFixed(3)+",bufferEnd:"+f.toFixed(3));this._loadFragment(c)}}};a.prototype._ensureFragmentAtLivePoint=function e(t,r,i,a,n,s,o){var l=this.hls.config,u=this.media;var f=void 0;var c=l.liveMaxLatencyDuration!==undefined?l.liveMaxLatencyDuration:l.liveMaxLatencyDurationCount*t.targetduration;if(r<Math.max(i-l.maxFragLookUpTolerance,a-c)){var d=this.liveSyncPosition=this.computeLivePosition(i,t);F["b"].log("buffer end: "+r.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+d.toFixed(3));r=d;if(u&&u.readyState&&u.duration>d){u.currentTime=d}this.nextLoadPosition=d}if(t.PTSKnown&&r>a&&u&&u.readyState){return null}if(this.startFragRequested&&!t.PTSKnown){if(n){if(t.hasProgramDateTime){F["b"].log("live playlist, switching playlist, load frag with same PDT: "+n.programDateTime);f=Je(s,n.endProgramDateTime,l.maxFragLookUpTolerance)}else{var h=n.sn+1;if(h>=t.startSN&&h<=t.endSN){var p=s[h-t.startSN];if(n.cc===p.cc){f=p;F["b"].log("live playlist, switching playlist, load frag with next SN: "+f.sn)}}if(!f){f=me.search(s,function(e){return n.cc-e.cc});if(f){F["b"].log("live playlist, switching playlist, load frag with same CC: "+f.sn)}}}}if(!f){f=s[Math.min(o-1,Math.round(o/2))];F["b"].log("live playlist, switching playlist, unknown, load middle frag : "+f.sn)}}return f};a.prototype._findFragment=function e(t,r,i,a,n,s,o){var l=this.hls.config;var u=void 0;if(n<s){var f=n>s-l.maxFragLookUpTolerance?0:l.maxFragLookUpTolerance;u=Ze(r,a,n,f)}else{u=a[i-1]}if(u){var c=u.sn-o.startSN;var d=r&&u.level===r.level;var h=a[c-1];var p=a[c+1];if(r&&u.sn===r.sn){if(d&&!u.backtracked){if(u.sn<o.endSN){var v=r.deltaPTS;if(v&&v>l.maxBufferHole&&r.dropped&&c){u=h;F["b"].warn("SN just loaded, with large PTS gap between audio and video, maybe frag is not starting with a keyframe ? load previous one to try to overcome this")}else{u=p;F["b"].log("SN just loaded, load next one: "+u.sn,u)}}else{u=null}}else if(u.backtracked){if(p&&p.backtracked){F["b"].warn("Already backtracked from fragment "+p.sn+", will not backtrack to fragment "+u.sn+". Loading fragment "+p.sn);u=p}else{F["b"].warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe");u.dropped=0;if(h){u=h;u.backtracked=true}else if(c){u=null}}}}}return u};a.prototype._loadKey=function e(t){this.state=ct.KEY_LOADING;this.hls.trigger(M["a"].KEY_LOADING,{frag:t})};a.prototype._loadFragment=function e(t){var r=this.fragmentTracker.getState(t);this.fragCurrent=t;this.startFragRequested=true;if(Object(x["a"])(t.sn)&&!t.bitrateTest){this.nextLoadPosition=t.start+t.duration}if(t.backtracked||r===ve.NOT_LOADED||r===ve.PARTIAL){t.autoLevel=this.hls.autoLevelEnabled;t.bitrateTest=this.bitrateTest;this.hls.trigger(M["a"].FRAG_LOADING,{frag:t});if(!this.demuxer){this.demuxer=new Pe(this.hls,"main")}this.state=ct.FRAG_LOADING}else if(r===ve.APPENDING){if(this._reduceMaxBufferLength(t.duration)){this.fragmentTracker.removeFragment(t)}}};a.prototype.getBufferedFrag=function e(t){return this.fragmentTracker.getBufferedFrag(t,te.LevelType.MAIN)};a.prototype.followingBufferedFrag=function e(t){if(t){return this.getBufferedFrag(t.endPTS+.5)}return null};a.prototype._checkFragmentChanged=function e(){var t=void 0,r=void 0,i=this.media;if(i&&i.readyState&&i.seeking===false){r=i.currentTime;if(r>this.lastCurrentTime){this.lastCurrentTime=r}if(Ee.isBuffered(i,r)){t=this.getBufferedFrag(r)}else if(Ee.isBuffered(i,r+.1)){t=this.getBufferedFrag(r+.1)}if(t){var a=t;if(a!==this.fragPlaying){this.hls.trigger(M["a"].FRAG_CHANGED,{frag:a});var n=a.level;if(!this.fragPlaying||this.fragPlaying.level!==n){this.hls.trigger(M["a"].LEVEL_SWITCHED,{level:n})}this.fragPlaying=a}}}};a.prototype.immediateLevelSwitch=function e(){F["b"].log("immediateLevelSwitch");if(!this.immediateSwitch){this.immediateSwitch=true;var t=this.media,r=void 0;if(t){r=t.paused;t.pause()}else{r=true}this.previouslyPaused=r}var i=this.fragCurrent;if(i&&i.loader){i.loader.abort()}this.fragCurrent=null;this.flushMainBuffer(0,Number.POSITIVE_INFINITY)};a.prototype.immediateLevelSwitchEnd=function e(){var t=this.media;if(t&&t.buffered.length){this.immediateSwitch=false;if(Ee.isBuffered(t,t.currentTime)){t.currentTime-=1e-4}if(!this.previouslyPaused){t.play()}}};a.prototype.nextLevelSwitch=function e(){var t=this.media;if(t&&t.readyState){var r=void 0,i=void 0,a=void 0;i=this.getBufferedFrag(t.currentTime);if(i&&i.startPTS>1){this.flushMainBuffer(0,i.startPTS-1)}if(!t.paused){var n=this.hls.nextLoadLevel,s=this.levels[n],o=this.fragLastKbps;if(o&&this.fragCurrent){r=this.fragCurrent.duration*s.bitrate/(1e3*o)+1}else{r=0}}else{r=0}a=this.getBufferedFrag(t.currentTime+r);if(a){a=this.followingBufferedFrag(a);if(a){var l=this.fragCurrent;if(l&&l.loader){l.loader.abort()}this.fragCurrent=null;this.flushMainBuffer(a.maxStartPTS,Number.POSITIVE_INFINITY)}}}};a.prototype.flushMainBuffer=function e(t,r){this.state=ct.BUFFER_FLUSHING;var i={startOffset:t,endOffset:r};if(this.altAudio){i.type="video"}this.hls.trigger(M["a"].BUFFER_FLUSHING,i)};a.prototype.onMediaAttached=function e(t){var r=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this);this.onvseeked=this.onMediaSeeked.bind(this);this.onvended=this.onMediaEnded.bind(this);r.addEventListener("seeking",this.onvseeking);r.addEventListener("seeked",this.onvseeked);r.addEventListener("ended",this.onvended);var i=this.config;if(this.levels&&i.autoStartLoad){this.hls.startLoad(i.startPosition)}this.gapController=new st(i,r,this.fragmentTracker,this.hls)};a.prototype.onMediaDetaching=function e(){var t=this.media;if(t&&t.ended){F["b"].log("MSE detaching and video ended, reset startPosition");this.startPosition=this.lastCurrentTime=0}var r=this.levels;if(r){r.forEach(function(e){if(e.details){e.details.fragments.forEach(function(e){e.backtracked=undefined})}})}if(t){t.removeEventListener("seeking",this.onvseeking);t.removeEventListener("seeked",this.onvseeked);t.removeEventListener("ended",this.onvended);this.onvseeking=this.onvseeked=this.onvended=null}this.media=this.mediaBuffer=null;this.loadedmetadata=false;this.stopLoad()};a.prototype.onMediaSeeking=function e(){var t=this.media,r=t?t.currentTime:undefined,i=this.config;if(Object(x["a"])(r)){F["b"].log("media seeking to "+r.toFixed(3))}var a=this.mediaBuffer?this.mediaBuffer:t;var n=Ee.bufferInfo(a,r,this.config.maxBufferHole);if(this.state===ct.FRAG_LOADING){var s=this.fragCurrent;if(n.len===0&&s){var o=i.maxFragLookUpTolerance,l=s.start-o,u=s.start+s.duration+o;if(r<l||r>u){if(s.loader){F["b"].log("seeking outside of buffer while fragment load in progress, cancel fragment load");s.loader.abort()}this.fragCurrent=null;this.fragPrevious=null;this.state=ct.IDLE}else{F["b"].log("seeking outside of buffer but within currently loaded fragment range")}}}else if(this.state===ct.ENDED){if(n.len===0){this.fragPrevious=0}this.state=ct.IDLE}if(t){this.lastCurrentTime=r}if(!this.loadedmetadata){this.nextLoadPosition=this.startPosition=r}this.tick()};a.prototype.onMediaSeeked=function e(){var t=this.media,r=t?t.currentTime:undefined;if(Object(x["a"])(r)){F["b"].log("media seeked to "+r.toFixed(3))}this.tick()};a.prototype.onMediaEnded=function e(){F["b"].log("media ended");this.startPosition=this.lastCurrentTime=0};a.prototype.onManifestLoading=function e(){F["b"].log("trigger BUFFER_RESET");this.hls.trigger(M["a"].BUFFER_RESET);this.fragmentTracker.removeAllFragments();this.stalled=false;this.startPosition=this.lastCurrentTime=0};a.prototype.onManifestParsed=function e(t){var r=false,i=false,a=void 0;t.levels.forEach(function(e){a=e.audioCodec;if(a){if(a.indexOf("mp4a.40.2")!==-1){r=true}if(a.indexOf("mp4a.40.5")!==-1){i=true}}});this.audioCodecSwitch=r&&i;if(this.audioCodecSwitch){F["b"].log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC")}this.levels=t.levels;this.startFragRequested=false;var n=this.config;if(n.autoStartLoad||this.forceStartLoad){this.hls.startLoad(n.startPosition)}};a.prototype.onLevelLoaded=function e(t){var r=t.details;var i=t.level;var a=this.levels[this.levelLastLoaded];var n=this.levels[i];var s=r.totalduration;var o=0;F["b"].log("level "+i+" loaded ["+r.startSN+","+r.endSN+"],duration:"+s);if(r.live){var l=n.details;if(l&&r.fragments.length>0){Fe(l,r);o=r.fragments[0].start;this.liveSyncPosition=this.computeLivePosition(o,l);if(r.PTSKnown&&Object(x["a"])(o)){F["b"].log("live playlist sliding:"+o.toFixed(3))}else{F["b"].log("live playlist - outdated PTS, unknown sliding");Ve(this.fragPrevious,a,r)}}else{F["b"].log("live playlist - first load, unknown sliding");r.PTSKnown=false;Ve(this.fragPrevious,a,r)}}else{r.PTSKnown=false}n.details=r;this.levelLastLoaded=i;this.hls.trigger(M["a"].LEVEL_UPDATED,{details:r,level:i});if(this.startFragRequested===false){if(this.startPosition===-1||this.lastCurrentTime===-1){var u=r.startTimeOffset;if(Object(x["a"])(u)){if(u<0){F["b"].log("negative start time offset "+u+", count from end of last fragment");u=o+s+u}F["b"].log("start time offset found in playlist, adjust startPosition to "+u);this.startPosition=u}else{if(r.live){this.startPosition=this.computeLivePosition(o,r);F["b"].log("configure startPosition to "+this.startPosition)}else{this.startPosition=0}}this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}if(this.state===ct.WAITING_LEVEL){this.state=ct.IDLE}this.tick()};a.prototype.onKeyLoaded=function e(){if(this.state===ct.KEY_LOADING){this.state=ct.IDLE;this.tick()}};a.prototype.onFragLoaded=function e(t){var r=this.fragCurrent,i=this.hls,a=this.levels,n=this.media;var s=t.frag;if(this.state===ct.FRAG_LOADING&&r&&s.type==="main"&&s.level===r.level&&s.sn===r.sn){var o=t.stats;var l=a[r.level];var u=l.details;this.bitrateTest=false;this.stats=o;F["b"].log("Loaded "+r.sn+" of ["+u.startSN+" ,"+u.endSN+"],level "+r.level);if(s.bitrateTest&&i.nextLoadLevel){this.state=ct.IDLE;this.startFragRequested=false;o.tparsed=o.tbuffered=window.performance.now();i.trigger(M["a"].FRAG_BUFFERED,{stats:o,frag:r,id:"main"});this.tick()}else if(s.sn==="initSegment"){this.state=ct.IDLE;o.tparsed=o.tbuffered=window.performance.now();u.initSegment.data=t.payload;i.trigger(M["a"].FRAG_BUFFERED,{stats:o,frag:r,id:"main"});this.tick()}else{F["b"].log("Parsing "+r.sn+" of ["+u.startSN+" ,"+u.endSN+"],level "+r.level+", cc "+r.cc);this.state=ct.PARSING;this.pendingBuffering=true;this.appended=false;if(s.bitrateTest){s.bitrateTest=false;this.fragmentTracker.onFragLoaded({frag:s})}var f=!(n&&n.seeking)&&(u.PTSKnown||!u.live);var c=u.initSegment?u.initSegment.data:[];var d=this._getAudioCodec(l);var h=this.demuxer=this.demuxer||new Pe(this.hls,"main");h.push(t.payload,c,d,l.videoCodec,r,u.totalduration,f)}}this.fragLoadError=0};a.prototype.onFragParsingInitSegment=function e(t){var r=this.fragCurrent;var i=t.frag;if(r&&t.id==="main"&&i.sn===r.sn&&i.level===r.level&&this.state===ct.PARSING){var a=t.tracks,n=void 0,s=void 0;if(a.audio&&this.altAudio){delete a.audio}s=a.audio;if(s){var o=this.levels[this.level].audioCodec,l=navigator.userAgent.toLowerCase();if(o&&this.audioCodecSwap){F["b"].log("swapping playlist audio codec");if(o.indexOf("mp4a.40.5")!==-1){o="mp4a.40.2"}else{o="mp4a.40.5"}}if(this.audioCodecSwitch){if(s.metadata.channelCount!==1&&l.indexOf("firefox")===-1){o="mp4a.40.5"}}if(l.indexOf("android")!==-1&&s.container!=="audio/mpeg"){o="mp4a.40.2";F["b"].log("Android: force audio codec to "+o)}s.levelCodec=o;s.id=t.id}s=a.video;if(s){s.levelCodec=this.levels[this.level].videoCodec;s.id=t.id}this.hls.trigger(M["a"].BUFFER_CODECS,a);for(n in a){s=a[n];F["b"].log("main track:"+n+",container:"+s.container+",codecs[level/parsed]=["+s.levelCodec+"/"+s.codec+"]");var u=s.initSegment;if(u){this.appended=true;this.pendingBuffering=true;this.hls.trigger(M["a"].BUFFER_APPENDING,{type:n,data:u,parent:"main",content:"initSegment"})}}this.tick()}};a.prototype.onFragParsingData=function e(t){var r=this;var i=this.fragCurrent;var a=t.frag;if(i&&t.id==="main"&&a.sn===i.sn&&a.level===i.level&&!(t.type==="audio"&&this.altAudio)&&this.state===ct.PARSING){var n=this.levels[this.level],s=i;if(!Object(x["a"])(t.endPTS)){t.endPTS=t.startPTS+i.duration;t.endDTS=t.startDTS+i.duration}if(t.hasAudio===true){s.addElementaryStream(P.ElementaryStreamTypes.AUDIO)}if(t.hasVideo===true){s.addElementaryStream(P.ElementaryStreamTypes.VIDEO)}F["b"].log("Parsed "+t.type+",PTS:["+t.startPTS.toFixed(3)+","+t.endPTS.toFixed(3)+"],DTS:["+t.startDTS.toFixed(3)+"/"+t.endDTS.toFixed(3)+"],nb:"+t.nb+",dropped:"+(t.dropped||0));if(t.type==="video"){s.dropped=t.dropped;if(s.dropped){if(!s.backtracked){var o=n.details;if(o&&s.sn===o.startSN){F["b"].warn("missing video frame(s) on first frag, appending with gap",s.sn)}else{F["b"].warn("missing video frame(s), backtracking fragment",s.sn);this.fragmentTracker.removeFragment(s);s.backtracked=true;this.nextLoadPosition=t.startPTS;this.state=ct.IDLE;this.fragPrevious=s;this.tick();return}}else{F["b"].warn("Already backtracked on this fragment, appending with the gap",s.sn)}}else{s.backtracked=false}}var l=Me(n.details,s,t.startPTS,t.endPTS,t.startDTS,t.endDTS),u=this.hls;u.trigger(M["a"].LEVEL_PTS_UPDATED,{details:n.details,level:this.level,drift:l,type:t.type,start:t.startPTS,end:t.endPTS});[t.data1,t.data2].forEach(function(e){if(e&&e.length&&r.state===ct.PARSING){r.appended=true;r.pendingBuffering=true;u.trigger(M["a"].BUFFER_APPENDING,{type:t.type,data:e,parent:"main",content:"data"})}});this.tick()}};a.prototype.onFragParsed=function e(t){var r=this.fragCurrent;var i=t.frag;if(r&&t.id==="main"&&i.sn===r.sn&&i.level===r.level&&this.state===ct.PARSING){this.stats.tparsed=window.performance.now();this.state=ct.PARSED;this._checkAppendedParsed()}};a.prototype.onAudioTrackSwitching=function e(t){var r=!!t.url,i=t.id;if(!r){if(this.mediaBuffer!==this.media){F["b"].log("switching on main audio, use media.buffered to schedule main fragment loading");this.mediaBuffer=this.media;var a=this.fragCurrent;if(a.loader){F["b"].log("switching to main audio track, cancel main fragment load");a.loader.abort()}this.fragCurrent=null;this.fragPrevious=null;if(this.demuxer){this.demuxer.destroy();this.demuxer=null}this.state=ct.IDLE}var n=this.hls;n.trigger(M["a"].BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"});n.trigger(M["a"].AUDIO_TRACK_SWITCHED,{id:i});this.altAudio=false}};a.prototype.onAudioTrackSwitched=function e(t){var r=t.id,i=!!this.hls.audioTracks[r].url;if(i){var a=this.videoBuffer;if(a&&this.mediaBuffer!==a){F["b"].log("switching on alternate audio, use video.buffered to schedule main fragment loading");this.mediaBuffer=a}}this.altAudio=i;this.tick()};a.prototype.onBufferCreated=function e(t){var r=t.tracks,i=void 0,a=void 0,n=false;for(var s in r){var o=r[s];if(o.id==="main"){a=s;i=o;if(s==="video"){this.videoBuffer=r[s].buffer}}else{n=true}}if(n&&i){F["b"].log("alternate track found, use "+a+".buffered to schedule main fragment loading");this.mediaBuffer=i.buffer}else{this.mediaBuffer=this.media}};a.prototype.onBufferAppended=function e(t){if(t.parent==="main"){var r=this.state;if(r===ct.PARSING||r===ct.PARSED){this.pendingBuffering=t.pending>0;this._checkAppendedParsed()}}};a.prototype._checkAppendedParsed=function e(){if(this.state===ct.PARSED&&(!this.appended||!this.pendingBuffering)){var t=this.fragCurrent;if(t){var r=this.mediaBuffer?this.mediaBuffer:this.media;F["b"].log("main buffered : "+Ue.toString(r.buffered));this.fragPrevious=t;var i=this.stats;i.tbuffered=window.performance.now();this.fragLastKbps=Math.round(8*i.total/(i.tbuffered-i.tfirst));this.hls.trigger(M["a"].FRAG_BUFFERED,{stats:i,frag:t,id:"main"});this.state=ct.IDLE}this.tick()}};a.prototype.onError=function e(t){var r=t.frag||this.fragCurrent;if(r&&r.type!=="main"){return}var i=!!this.media&&Ee.isBuffered(this.media,this.media.currentTime)&&Ee.isBuffered(this.media,this.media.currentTime+.5);switch(t.details){case h["a"].FRAG_LOAD_ERROR:case h["a"].FRAG_LOAD_TIMEOUT:case h["a"].KEY_LOAD_ERROR:case h["a"].KEY_LOAD_TIMEOUT:if(!t.fatal){if(this.fragLoadError+1<=this.config.fragLoadingMaxRetry){var a=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout);F["b"].warn("mediaController: frag loading failed, retry in "+a+" ms");this.retryDate=window.performance.now()+a;if(!this.loadedmetadata){this.startFragRequested=false;this.nextLoadPosition=this.startPosition}this.fragLoadError++;this.state=ct.FRAG_LOADING_WAITING_RETRY}else{F["b"].error("mediaController: "+t.details+" reaches max retry, redispatch as fatal ...");t.fatal=true;this.state=ct.ERROR}}break;case h["a"].LEVEL_LOAD_ERROR:case h["a"].LEVEL_LOAD_TIMEOUT:if(this.state!==ct.ERROR){if(t.fatal){this.state=ct.ERROR;F["b"].warn("streamController: "+t.details+",switch to "+this.state+" state ...")}else{if(!t.levelRetry&&this.state===ct.WAITING_LEVEL){this.state=ct.IDLE}}}break;case h["a"].BUFFER_FULL_ERROR:if(t.parent==="main"&&(this.state===ct.PARSING||this.state===ct.PARSED)){if(i){this._reduceMaxBufferLength(this.config.maxBufferLength);this.state=ct.IDLE}else{F["b"].warn("buffer full error also media.currentTime is not buffered, flush everything");this.fragCurrent=null;this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}}break;default:break}};a.prototype._reduceMaxBufferLength=function e(t){var r=this.config;if(r.maxMaxBufferLength>=t){r.maxMaxBufferLength/=2;F["b"].warn("main:reduce max buffer length to "+r.maxMaxBufferLength+"s");return true}return false};a.prototype._checkBuffer=function e(){var t=this.media;if(!t||t.readyState===0){return}var r=this.mediaBuffer?this.mediaBuffer:t;var i=r.buffered;if(!this.loadedmetadata&&i.length){this.loadedmetadata=true;this._seekToStartPos()}else if(this.immediateSwitch){this.immediateLevelSwitchEnd()}else{this.gapController.poll(this.lastCurrentTime,i)}};a.prototype.onFragLoadEmergencyAborted=function e(){this.state=ct.IDLE;if(!this.loadedmetadata){this.startFragRequested=false;this.nextLoadPosition=this.startPosition}this.tick()};a.prototype.onBufferFlushed=function e(){var t=this.mediaBuffer?this.mediaBuffer:this.media;if(t){this.fragmentTracker.detectEvictedFragments(P.ElementaryStreamTypes.VIDEO,t.buffered)}this.state=ct.IDLE;this.fragPrevious=null};a.prototype.swapAudioCodec=function e(){this.audioCodecSwap=!this.audioCodecSwap};a.prototype.computeLivePosition=function e(t,r){var i=this.config.liveSyncDuration!==undefined?this.config.liveSyncDuration:this.config.liveSyncDurationCount*r.targetduration;return t+Math.max(0,r.totalduration-i)};a.prototype._seekToStartPos=function e(){var t=this.media;var r=t.currentTime;var i=t.seeking?r:this.startPosition;if(r!==i){F["b"].log("target start position not buffered, seek to buffered.start(0) "+i+" from current time "+r+" ");t.currentTime=i}};a.prototype._getAudioCodec=function e(t){var r=this.config.defaultAudioCodec||t.audioCodec;if(this.audioCodecSwap){F["b"].log("swapping playlist audio codec");if(r){if(r.indexOf("mp4a.40.5")!==-1){r="mp4a.40.2"}else{r="mp4a.40.5"}}}return r};ot(a,[{key:"state",set:function e(t){if(this.state!==t){var r=this.state;this._state=t;F["b"].log("main stream:"+r+"->"+t);this.hls.trigger(M["a"].STREAM_STATE_TRANSITION,{previousState:r,nextState:t})}},get:function e(){return this._state}},{key:"currentLevel",get:function e(){var t=this.media;if(t){var r=this.getBufferedFrag(t.currentTime);if(r){return r.level}}return-1}},{key:"nextBufferedFrag",get:function e(){var t=this.media;if(t){return this.followingBufferedFrag(this.getBufferedFrag(t.currentTime))}else{return null}}},{key:"nextLevel",get:function e(){var t=this.nextBufferedFrag;if(t){return t.level}else{return-1}}},{key:"liveSyncPosition",get:function e(){return this._liveSyncPosition},set:function e(t){this._liveSyncPosition=t}}]);return a}($e);var ht=dt;var pt=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var vt=function(){function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}return function(e,t,r){if(t)i(e.prototype,t);if(r)i(e,r);return e}}();function yt(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function gt(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function mt(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var bt=window,Et=bt.performance;var Tt=function(r){mt(i,r);function i(e){yt(this,i);var t=gt(this,r.call(this,e,M["a"].MANIFEST_LOADED,M["a"].LEVEL_LOADED,M["a"].AUDIO_TRACK_SWITCHED,M["a"].FRAG_LOADED,M["a"].ERROR));t.canload=false;t.currentLevelIndex=null;t.manualLevelIndex=-1;t.timer=null;return t}i.prototype.onHandlerDestroying=function e(){this.clearTimer();this.manualLevelIndex=-1};i.prototype.clearTimer=function e(){if(this.timer!==null){clearTimeout(this.timer);this.timer=null}};i.prototype.startLoad=function e(){var t=this._levels;this.canload=true;this.levelRetryCount=0;if(t){t.forEach(function(e){e.loadError=0;var t=e.details;if(t&&t.live){e.details=undefined}})}if(this.timer!==null){this.loadLevel()}};i.prototype.stopLoad=function e(){this.canload=false};i.prototype.onManifestLoaded=function e(t){var r=[];var i=void 0;var a={};var n=null;var s=false;var o=false;var l=/chrome|firefox/.test(navigator.userAgent.toLowerCase());var u=[];t.levels.forEach(function(e){e.loadError=0;e.fragmentError=false;s=s||!!e.videoCodec;o=o||!!e.audioCodec||!!(e.attrs&&e.attrs.AUDIO);if(l&&e.audioCodec&&e.audioCodec.indexOf("mp4a.40.34")!==-1){e.audioCodec=undefined}n=a[e.bitrate];if(!n){e.url=[e.url];e.urlId=0;a[e.bitrate]=e;r.push(e)}else{n.url.push(e.url)}if(e.attrs&&e.attrs.AUDIO){Ce(n||e,"audio",e.attrs.AUDIO)}if(e.attrs&&e.attrs.SUBTITLES){Ce(n||e,"text",e.attrs.SUBTITLES)}});if(s&&o){r=r.filter(function(e){var t=e.videoCodec;return!!t})}r=r.filter(function(e){var t=e.audioCodec,r=e.videoCodec;return(!t||k(t))&&(!r||k(r))});if(t.audioTracks){u=t.audioTracks.filter(function(e){return!e.audioCodec||k(e.audioCodec,"audio")});u.forEach(function(e,t){e.id=t})}if(r.length>0){i=r[0].bitrate;r.sort(function(e,t){return e.bitrate-t.bitrate});this._levels=r;for(var f=0;f<r.length;f++){if(r[f].bitrate===i){this._firstLevel=f;F["b"].log("manifest loaded,"+r.length+" level(s) found, first bitrate:"+i);break}}this.hls.trigger(M["a"].MANIFEST_PARSED,{levels:r,audioTracks:u,firstLevel:this._firstLevel,stats:t.stats,audio:o,video:s,altAudio:u.length>0&&s})}else{this.hls.trigger(M["a"].ERROR,{type:h["b"].MEDIA_ERROR,details:h["a"].MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:true,url:this.hls.url,reason:"no level with compatible codecs found in manifest"})}};i.prototype.setLevelInternal=function e(t){var r=this._levels;var i=this.hls;if(t>=0&&t<r.length){this.clearTimer();if(this.currentLevelIndex!==t){F["b"].log("switching to level "+t);this.currentLevelIndex=t;var a=r[t];a.level=t;i.trigger(M["a"].LEVEL_SWITCHING,a)}var n=r[t];var s=n.details;if(!s||s.live){var o=n.urlId;i.trigger(M["a"].LEVEL_LOADING,{url:n.url[o],level:t,id:o})}}else{i.trigger(M["a"].ERROR,{type:h["b"].OTHER_ERROR,details:h["a"].LEVEL_SWITCH_ERROR,level:t,fatal:false,reason:"invalid level idx"})}};i.prototype.onError=function e(t){if(t.fatal){if(t.type===h["b"].NETWORK_ERROR){this.clearTimer()}return}var r=false,i=false;var a=void 0;switch(t.details){case h["a"].FRAG_LOAD_ERROR:case h["a"].FRAG_LOAD_TIMEOUT:case h["a"].KEY_LOAD_ERROR:case h["a"].KEY_LOAD_TIMEOUT:a=t.frag.level;i=true;break;case h["a"].LEVEL_LOAD_ERROR:case h["a"].LEVEL_LOAD_TIMEOUT:a=t.context.level;r=true;break;case h["a"].REMUX_ALLOC_ERROR:a=t.level;r=true;break}if(a!==undefined){this.recoverLevel(t,a,r,i)}};i.prototype.recoverLevel=function e(t,r,i,a){var n=this;var s=this.hls.config;var o=t.details;var l=this._levels[r];var u=void 0,f=void 0,c=void 0;l.loadError++;l.fragmentError=a;if(i){if(this.levelRetryCount+1<=s.levelLoadingMaxRetry){f=Math.min(Math.pow(2,this.levelRetryCount)*s.levelLoadingRetryDelay,s.levelLoadingMaxRetryTimeout);this.timer=setTimeout(function(){return n.loadLevel()},f);t.levelRetry=true;this.levelRetryCount++;F["b"].warn("level controller, "+o+", retry in "+f+" ms, current retry count is "+this.levelRetryCount)}else{F["b"].error("level controller, cannot recover from "+o+" error");this.currentLevelIndex=null;this.clearTimer();t.fatal=true;return}}if(i||a){u=l.url.length;if(u>1&&l.loadError<u){l.urlId=(l.urlId+1)%u;l.details=undefined;F["b"].warn("level controller, "+o+" for level "+r+": switching to redundant URL-id "+l.urlId)}else{if(this.manualLevelIndex===-1){c=r===0?this._levels.length-1:r-1;F["b"].warn("level controller, "+o+": switch to "+c);this.hls.nextAutoLevel=this.currentLevelIndex=c}else if(a){F["b"].warn("level controller, "+o+": reload a fragment");this.currentLevelIndex=null}}}};i.prototype.onFragLoaded=function e(t){var r=t.frag;if(r!==undefined&&r.type==="main"){var i=this._levels[r.level];if(i!==undefined){i.fragmentError=false;i.loadError=0;this.levelRetryCount=0}}};i.prototype.onLevelLoaded=function e(t){var r=this;var i=t.level;if(i!==this.currentLevelIndex){return}var a=this._levels[i];if(!a.fragmentError){a.loadError=0;this.levelRetryCount=0}var n=t.details;if(n.live){var s=1e3*(n.averagetargetduration?n.averagetargetduration:n.targetduration);var o=s,l=a.details;if(l&&n.endSN===l.endSN){o/=2;F["b"].log("same live playlist, reload twice faster")}o-=Et.now()-t.stats.trequest;o=Math.max(s/2,Math.round(o));F["b"].log("live playlist, reload in "+Math.round(o)+" ms");this.timer=setTimeout(function(){return r.loadLevel()},o)}else{this.clearTimer()}};i.prototype.onAudioTrackSwitched=function e(t){var r=this.hls.audioTracks[t.id].groupId;var i=this.hls.levels[this.currentLevelIndex];if(!i){return}if(i.audioGroupIds){var a=i.audioGroupIds.findIndex(function(e){return e===r});if(a!==i.urlId){i.urlId=a;this.startLoad()}}};i.prototype.loadLevel=function e(){F["b"].debug("call to loadLevel");if(this.currentLevelIndex!==null&&this.canload){var t=this._levels[this.currentLevelIndex];if((typeof t==="undefined"?"undefined":pt(t))==="object"&&t.url.length>0){var r=this.currentLevelIndex;var i=t.urlId;var a=t.url[i];F["b"].log("Attempt loading level index "+r+" with URL-id "+i);this.hls.trigger(M["a"].LEVEL_LOADING,{url:a,level:r,id:i})}}};vt(i,[{key:"levels",get:function e(){return this._levels}},{key:"level",get:function e(){return this.currentLevelIndex},set:function e(t){var r=this._levels;if(r){t=Math.min(t,r.length-1);if(this.currentLevelIndex!==t||!r[t].details){this.setLevelInternal(t)}}}},{key:"manualLevel",get:function e(){return this.manualLevelIndex},set:function e(t){this.manualLevelIndex=t;if(this._startLevel===undefined){this._startLevel=t}if(t!==-1){this.level=t}}},{key:"firstLevel",get:function e(){return this._firstLevel},set:function e(t){this._firstLevel=t}},{key:"startLevel",get:function e(){if(this._startLevel===undefined){var t=this.hls.config.startLevel;if(t!==undefined){return t}else{return this._firstLevel}}else{return this._startLevel}},set:function e(t){this._startLevel=t}},{key:"nextLoadLevel",get:function e(){if(this.manualLevelIndex!==-1){return this.manualLevelIndex}else{return this.hls.nextAutoLevel}},set:function e(t){this.level=t;if(this.manualLevelIndex===-1){this.hls.nextAutoLevel=t}}}]);return i}(f);var St=Tt;var wt=r(6);function At(e,t){var r=null;try{r=new window.Event("addtrack")}catch(e){r=document.createEvent("Event");r.initEvent("addtrack",false,false)}r.track=e;t.dispatchEvent(r)}function _t(e){if(e&&e.cues){while(e.cues.length>0){e.removeCue(e.cues[0])}}}function Rt(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function Lt(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function kt(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var Dt=function(r){kt(i,r);function i(e){Rt(this,i);var t=Lt(this,r.call(this,e,M["a"].MEDIA_ATTACHED,M["a"].MEDIA_DETACHING,M["a"].FRAG_PARSING_METADATA));t.id3Track=undefined;t.media=undefined;return t}i.prototype.destroy=function e(){f.prototype.destroy.call(this)};i.prototype.onMediaAttached=function e(t){this.media=t.media;if(!this.media){}};i.prototype.onMediaDetaching=function e(){_t(this.id3Track);this.id3Track=undefined;this.media=undefined};i.prototype.getID3Track=function e(t){for(var r=0;r<t.length;r++){var i=t[r];if(i.kind==="metadata"&&i.label==="id3"){At(i,this.media);return i}}return this.media.addTextTrack("metadata","id3")};i.prototype.onFragParsingMetadata=function e(t){var r=t.frag;var i=t.samples;if(!this.id3Track){this.id3Track=this.getID3Track(this.media.textTracks);this.id3Track.mode="hidden"}var a=window.WebKitDataCue||window.VTTCue||window.TextTrackCue;for(var n=0;n<i.length;n++){var s=wt["a"].getID3Frames(i[n].data);if(s){var o=i[n].pts;var l=n<i.length-1?i[n+1].pts:r.endPTS;if(o===l){l+=1e-4}for(var u=0;u<s.length;u++){var f=s[u];if(!wt["a"].isTimeStampFrame(f)){var c=new a(o,l,"");c.value=f;this.id3Track.addCue(c)}}}}};return i}(f);var It=Dt;function Ot(){var e=Re();var t=window.SourceBuffer||window.WebKitSourceBuffer;var r=e&&typeof e.isTypeSupported==="function"&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"');var i=!t||t.prototype&&typeof t.prototype.appendBuffer==="function"&&typeof t.prototype.remove==="function";return!!r&&!!i}function Pt(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var Ct=function(){function t(e){Pt(this,t);this.alpha_=e?Math.exp(Math.log(.5)/e):0;this.estimate_=0;this.totalWeight_=0}t.prototype.sample=function e(t,r){var i=Math.pow(this.alpha_,t);this.estimate_=r*(1-i)+i*this.estimate_;this.totalWeight_+=t};t.prototype.getTotalWeight=function e(){return this.totalWeight_};t.prototype.getEstimate=function e(){if(this.alpha_){var t=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/t}else{return this.estimate_}};return t}();var xt=Ct;function Mt(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var Ft=function(){function a(e,t,r,i){Mt(this,a);this.hls=e;this.defaultEstimate_=i;this.minWeight_=.001;this.minDelayMs_=50;this.slow_=new xt(t);this.fast_=new xt(r)}a.prototype.sample=function e(t,r){t=Math.max(t,this.minDelayMs_);var i=8e3*r/t,a=t/1e3;this.fast_.sample(a,i);this.slow_.sample(a,i)};a.prototype.canEstimate=function e(){var t=this.fast_;return t&&t.getTotalWeight()>=this.minWeight_};a.prototype.getEstimate=function e(){if(this.canEstimate()){return Math.min(this.fast_.getEstimate(),this.slow_.getEstimate())}else{return this.defaultEstimate_}};a.prototype.destroy=function e(){};return a}();var Nt=Ft;var Ut=function(){function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}return function(e,t,r){if(t)i(e.prototype,t);if(r)i(e,r);return e}}();function Bt(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function Gt(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function jt(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var Kt=window,Ht=Kt.performance;var Vt=function(r){jt(i,r);function i(e){Bt(this,i);var t=Gt(this,r.call(this,e,M["a"].FRAG_LOADING,M["a"].FRAG_LOADED,M["a"].FRAG_BUFFERED,M["a"].ERROR));t.lastLoadedFragLevel=0;t._nextAutoLevel=-1;t.hls=e;t.timer=null;t._bwEstimator=null;t.onCheck=t._abandonRulesCheck.bind(t);return t}i.prototype.destroy=function e(){this.clearTimer();f.prototype.destroy.call(this)};i.prototype.onFragLoading=function e(t){var r=t.frag;if(r.type==="main"){if(!this.timer){this.fragCurrent=r;this.timer=setInterval(this.onCheck,100)}if(!this._bwEstimator){var i=this.hls;var a=i.config;var n=r.level;var s=i.levels[n].details.live;var o=void 0,l=void 0;if(s){o=a.abrEwmaFastLive;l=a.abrEwmaSlowLive}else{o=a.abrEwmaFastVoD;l=a.abrEwmaSlowVoD}this._bwEstimator=new Nt(i,l,o,a.abrEwmaDefaultEstimate)}}};i.prototype._abandonRulesCheck=function e(){var t=this.hls;var r=t.media;var i=this.fragCurrent;if(!i){return}var a=i.loader;var n=t.minAutoLevel;if(!a||a.stats&&a.stats.aborted){F["b"].warn("frag loader destroy or aborted, disarm abandonRules");this.clearTimer();this._nextAutoLevel=-1;return}var s=a.stats;if(r&&s&&(!r.paused&&r.playbackRate!==0||!r.readyState)&&i.autoLevel&&i.level){var o=Ht.now()-s.trequest,l=Math.abs(r.playbackRate);if(o>500*i.duration/l){var u=t.levels,f=Math.max(1,s.bw?s.bw/8:s.loaded*1e3/o),c=u[i.level],d=c.realBitrate?Math.max(c.realBitrate,c.bitrate):c.bitrate,h=s.total?s.total:Math.max(s.loaded,Math.round(i.duration*d/8)),p=r.currentTime,v=(h-s.loaded)/f,y=(Ee.bufferInfo(r,p,t.config.maxBufferHole).end-p)/l;if(y<2*i.duration/l&&v>y){var g=void 0,m=void 0;for(m=i.level-1;m>n;m--){var b=u[m].realBitrate?Math.max(u[m].realBitrate,u[m].bitrate):u[m].bitrate;g=i.duration*b/(8*.8*f);if(g<y){break}}if(g<v){F["b"].warn("loading too slow, abort fragment loading and switch to level "+m+":fragLoadedDelay["+m+"]<fragLoadedDelay["+(i.level-1)+"];bufferStarvationDelay:"+g.toFixed(1)+"<"+v.toFixed(1)+":"+y.toFixed(1));t.nextLoadLevel=m;this._bwEstimator.sample(o,s.loaded);a.abort();this.clearTimer();t.trigger(M["a"].FRAG_LOAD_EMERGENCY_ABORTED,{frag:i,stats:s})}}}}};i.prototype.onFragLoaded=function e(t){var r=t.frag;if(r.type==="main"&&Object(x["a"])(r.sn)){this.clearTimer();this.lastLoadedFragLevel=r.level;this._nextAutoLevel=-1;if(this.hls.config.abrMaxWithRealBitrate){var i=this.hls.levels[r.level];var a=(i.loaded?i.loaded.bytes:0)+t.stats.loaded;var n=(i.loaded?i.loaded.duration:0)+t.frag.duration;i.loaded={bytes:a,duration:n};i.realBitrate=Math.round(8*a/n)}if(t.frag.bitrateTest){var s=t.stats;s.tparsed=s.tbuffered=s.tload;this.onFragBuffered(t)}}};i.prototype.onFragBuffered=function e(t){var r=t.stats;var i=t.frag;if(r.aborted!==true&&i.type==="main"&&Object(x["a"])(i.sn)&&(!i.bitrateTest||r.tload===r.tbuffered)){var a=r.tparsed-r.trequest;F["b"].log("latency/loading/parsing/append/kbps:"+Math.round(r.tfirst-r.trequest)+"/"+Math.round(r.tload-r.tfirst)+"/"+Math.round(r.tparsed-r.tload)+"/"+Math.round(r.tbuffered-r.tparsed)+"/"+Math.round(8*r.loaded/(r.tbuffered-r.trequest)));this._bwEstimator.sample(a,r.loaded);r.bwEstimate=this._bwEstimator.getEstimate();if(i.bitrateTest){this.bitrateTestDelay=a/1e3}else{this.bitrateTestDelay=0}}};i.prototype.onError=function e(t){switch(t.details){case h["a"].FRAG_LOAD_ERROR:case h["a"].FRAG_LOAD_TIMEOUT:this.clearTimer();break;default:break}};i.prototype.clearTimer=function e(){clearInterval(this.timer);this.timer=null};i.prototype._findBestLevel=function e(t,r,i,a,n,s,o,l,u){for(var f=n;f>=a;f--){var c=u[f];if(!c){continue}var d=c.details,h=d?d.totalduration/d.fragments.length:r,p=d?d.live:false,v=void 0;if(f<=t){v=o*i}else{v=l*i}var y=u[f].realBitrate?Math.max(u[f].realBitrate,u[f].bitrate):u[f].bitrate,g=y*h/v;F["b"].trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+f+"/"+Math.round(v)+"/"+y+"/"+h+"/"+s+"/"+g);if(v>y&&(!g||p&&!this.bitrateTestDelay||g<s)){return f}}return-1};Ut(i,[{key:"nextAutoLevel",get:function e(){var t=this._nextAutoLevel;var r=this._bwEstimator;if(t!==-1&&(!r||!r.canEstimate())){return t}var i=this._nextABRAutoLevel;if(t!==-1){i=Math.min(t,i)}return i},set:function e(t){this._nextAutoLevel=t}},{key:"_nextABRAutoLevel",get:function e(){var t=this.hls,r=t.maxAutoLevel,i=t.levels,a=t.config,n=t.minAutoLevel;var s=t.media,o=this.lastLoadedFragLevel,l=this.fragCurrent?this.fragCurrent.duration:0,u=s?s.currentTime:0,f=s&&s.playbackRate!==0?Math.abs(s.playbackRate):1,c=this._bwEstimator?this._bwEstimator.getEstimate():a.abrEwmaDefaultEstimate,d=(Ee.bufferInfo(s,u,a.maxBufferHole).end-u)/f;var h=this._findBestLevel(o,l,c,n,r,d,a.abrBandWidthFactor,a.abrBandWidthUpFactor,i);if(h>=0){return h}else{F["b"].trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var p=l?Math.min(l,a.maxStarvationDelay):a.maxStarvationDelay,v=a.abrBandWidthFactor,y=a.abrBandWidthUpFactor;if(d===0){var g=this.bitrateTestDelay;if(g){var m=l?Math.min(l,a.maxLoadingDelay):a.maxLoadingDelay;p=m-g;F["b"].trace("bitrate test took "+Math.round(1e3*g)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*p)+" ms");v=y=1}}h=this._findBestLevel(o,l,c,n,r,d+p,v,y,i);return Math.max(h,0)}}}]);return i}(f);var qt=Vt;function Yt(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function Wt(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function zt(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var Xt=Re();var Qt=function(r){zt(i,r);function i(e){Yt(this,i);var t=Wt(this,r.call(this,e,M["a"].MEDIA_ATTACHING,M["a"].MEDIA_DETACHING,M["a"].MANIFEST_PARSED,M["a"].BUFFER_RESET,M["a"].BUFFER_APPENDING,M["a"].BUFFER_CODECS,M["a"].BUFFER_EOS,M["a"].BUFFER_FLUSHING,M["a"].LEVEL_PTS_UPDATED,M["a"].LEVEL_UPDATED));t._msDuration=null;t._levelDuration=null;t._live=null;t._objectUrl=null;t.onsbue=t.onSBUpdateEnd.bind(t);t.onsbe=t.onSBUpdateError.bind(t);t.pendingTracks={};t.tracks={};return t}i.prototype.destroy=function e(){f.prototype.destroy.call(this)};i.prototype.onLevelPtsUpdated=function e(t){var r=t.type;var i=this.tracks.audio;if(r==="audio"&&i&&i.container==="audio/mpeg"){var a=this.sourceBuffer.audio;var n=Math.abs(a.timestampOffset-t.start);if(n>.1){var s=a.updating;try{a.abort()}catch(e){s=true;F["b"].warn("can not abort audio buffer: "+e)}if(!s){F["b"].warn("change mpeg audio timestamp offset from "+a.timestampOffset+" to "+t.start);a.timestampOffset=t.start}else{this.audioTimestampOffset=t.start}}}};i.prototype.onManifestParsed=function e(t){var r=t.audio,i=t.video||t.levels.length&&t.altAudio,a=0;if(t.altAudio&&(r||i)){a=(r?1:0)+(i?1:0);F["b"].log(a+" sourceBuffer(s) expected")}this.sourceBufferNb=a};i.prototype.onMediaAttaching=function e(t){var r=this.media=t.media;if(r){var i=this.mediaSource=new Xt;this.onmso=this.onMediaSourceOpen.bind(this);this.onmse=this.onMediaSourceEnded.bind(this);this.onmsc=this.onMediaSourceClose.bind(this);i.addEventListener("sourceopen",this.onmso);i.addEventListener("sourceended",this.onmse);i.addEventListener("sourceclose",this.onmsc);r.src=window.URL.createObjectURL(i);this._objectUrl=r.src}};i.prototype.onMediaDetaching=function e(){F["b"].log("media source detaching");var t=this.mediaSource;if(t){if(t.readyState==="open"){try{t.endOfStream()}catch(e){F["b"].warn("onMediaDetaching:"+e.message+" while calling endOfStream")}}t.removeEventListener("sourceopen",this.onmso);t.removeEventListener("sourceended",this.onmse);t.removeEventListener("sourceclose",this.onmsc);if(this.media){window.URL.revokeObjectURL(this._objectUrl);if(this.media.src===this._objectUrl){this.media.removeAttribute("src");this.media.load()}else{F["b"].warn("media.src was changed by a third party - skip cleanup")}}this.mediaSource=null;this.media=null;this._objectUrl=null;this.pendingTracks={};this.tracks={};this.sourceBuffer={};this.flushRange=[];this.segments=[];this.appended=0}this.onmso=this.onmse=this.onmsc=null;this.hls.trigger(M["a"].MEDIA_DETACHED)};i.prototype.onMediaSourceOpen=function e(){F["b"].log("media source opened");this.hls.trigger(M["a"].MEDIA_ATTACHED,{media:this.media});var t=this.mediaSource;if(t){t.removeEventListener("sourceopen",this.onmso)}this.checkPendingTracks()};i.prototype.checkPendingTracks=function e(){var t=this.pendingTracks,r=Object.keys(t).length;if(r&&(this.sourceBufferNb<=r||this.sourceBufferNb===0)){this.createSourceBuffers(t);this.pendingTracks={};this.doAppending()}};i.prototype.onMediaSourceClose=function e(){F["b"].log("media source closed")};i.prototype.onMediaSourceEnded=function e(){F["b"].log("media source ended")};i.prototype.onSBUpdateEnd=function e(){if(this.audioTimestampOffset){var t=this.sourceBuffer.audio;F["b"].warn("change mpeg audio timestamp offset from "+t.timestampOffset+" to "+this.audioTimestampOffset);t.timestampOffset=this.audioTimestampOffset;delete this.audioTimestampOffset}if(this._needsFlush){this.doFlush()}if(this._needsEos){this.checkEos()}this.appending=false;var r=this.parent;var i=this.segments.reduce(function(e,t){return t.parent===r?e+1:e},0);var a={};var n=this.sourceBuffer;for(var s in n){a[s]=n[s].buffered}this.hls.trigger(M["a"].BUFFER_APPENDED,{parent:r,pending:i,timeRanges:a});if(!this._needsFlush){this.doAppending()}this.updateMediaElementDuration()};i.prototype.onSBUpdateError=function e(t){F["b"].error("sourceBuffer error:",t);this.hls.trigger(M["a"].ERROR,{type:h["b"].MEDIA_ERROR,details:h["a"].BUFFER_APPENDING_ERROR,fatal:false})};i.prototype.onBufferReset=function e(){var t=this.sourceBuffer;for(var r in t){var i=t[r];try{this.mediaSource.removeSourceBuffer(i);i.removeEventListener("updateend",this.onsbue);i.removeEventListener("error",this.onsbe)}catch(e){}}this.sourceBuffer={};this.flushRange=[];this.segments=[];this.appended=0};i.prototype.onBufferCodecs=function e(t){if(Object.keys(this.sourceBuffer).length===0){for(var r in t){this.pendingTracks[r]=t[r]}var i=this.mediaSource;if(i&&i.readyState==="open"){this.checkPendingTracks()}}};i.prototype.createSourceBuffers=function e(t){var r=this.sourceBuffer,i=this.mediaSource;for(var a in t){if(!r[a]){var n=t[a];var s=n.levelCodec||n.codec;var o=n.container+";codecs="+s;F["b"].log("creating sourceBuffer("+o+")");try{var l=r[a]=i.addSourceBuffer(o);l.addEventListener("updateend",this.onsbue);l.addEventListener("error",this.onsbe);this.tracks[a]={codec:s,container:n.container};n.buffer=l}catch(e){F["b"].error("error while trying to add sourceBuffer:"+e.message);this.hls.trigger(M["a"].ERROR,{type:h["b"].MEDIA_ERROR,details:h["a"].BUFFER_ADD_CODEC_ERROR,fatal:false,err:e,mimeType:o})}}}this.hls.trigger(M["a"].BUFFER_CREATED,{tracks:t})};i.prototype.onBufferAppending=function e(t){if(!this._needsFlush){if(!this.segments){this.segments=[t]}else{this.segments.push(t)}this.doAppending()}};i.prototype.onBufferAppendFail=function e(t){F["b"].error("sourceBuffer error:",t.event);this.hls.trigger(M["a"].ERROR,{type:h["b"].MEDIA_ERROR,details:h["a"].BUFFER_APPENDING_ERROR,fatal:false})};i.prototype.onBufferEos=function e(t){var r=this.sourceBuffer;var i=t.type;for(var a in r){if(!i||a===i){if(!r[a].ended){r[a].ended=true;F["b"].log(a+" sourceBuffer now EOS")}}}this.checkEos()};i.prototype.checkEos=function e(){var t=this.sourceBuffer,r=this.mediaSource;if(!r||r.readyState!=="open"){this._needsEos=false;return}for(var i in t){var a=t[i];if(!a.ended){return}if(a.updating){this._needsEos=true;return}}F["b"].log("all media data available, signal endOfStream() to MediaSource and stop loading fragment");try{r.endOfStream()}catch(e){F["b"].warn("exception while calling mediaSource.endOfStream()")}this._needsEos=false};i.prototype.onBufferFlushing=function e(t){this.flushRange.push({start:t.startOffset,end:t.endOffset,type:t.type});this.flushBufferCounter=0;this.doFlush()};i.prototype.onLevelUpdated=function e(t){var r=t.details;if(r.fragments.length>0){this._levelDuration=r.totalduration+r.fragments[0].start;this._live=r.live;this.updateMediaElementDuration()}};i.prototype.updateMediaElementDuration=function e(){var t=this.hls.config;var r=void 0;if(this._levelDuration===null||!this.media||!this.mediaSource||!this.sourceBuffer||this.media.readyState===0||this.mediaSource.readyState!=="open"){return}for(var i in this.sourceBuffer){if(this.sourceBuffer[i].updating===true){return}}r=this.media.duration;if(this._msDuration===null){this._msDuration=this.mediaSource.duration}if(this._live===true&&t.liveDurationInfinity===true){F["b"].log("Media Source duration is set to Infinity");this._msDuration=this.mediaSource.duration=Infinity}else if(this._levelDuration>this._msDuration&&this._levelDuration>r||!Object(x["a"])(r)){F["b"].log("Updating Media Source duration to "+this._levelDuration.toFixed(3));this._msDuration=this.mediaSource.duration=this._levelDuration}};i.prototype.doFlush=function e(){while(this.flushRange.length){var t=this.flushRange[0];if(this.flushBuffer(t.start,t.end,t.type)){this.flushRange.shift();this.flushBufferCounter=0}else{this._needsFlush=true;return}}if(this.flushRange.length===0){this._needsFlush=false;var r=0;var i=this.sourceBuffer;try{for(var a in i){r+=i[a].buffered.length}}catch(e){F["b"].error("error while accessing sourceBuffer.buffered")}this.appended=r;this.hls.trigger(M["a"].BUFFER_FLUSHED)}};i.prototype.doAppending=function e(){var t=this.hls,r=this.sourceBuffer,i=this.segments;if(Object.keys(r).length){if(this.media.error){this.segments=[];F["b"].error("trying to append although a media error occured, flush segment and abort");return}if(this.appending){return}if(i&&i.length){var a=i.shift();try{var n=a.type,s=r[n];if(s){if(!s.updating){s.ended=false;this.parent=a.parent;s.appendBuffer(a.data);this.appendError=0;this.appended++;this.appending=true}else{i.unshift(a)}}else{this.onSBUpdateEnd()}}catch(e){F["b"].error("error while trying to append buffer:"+e.message);i.unshift(a);var o={type:h["b"].MEDIA_ERROR,parent:a.parent};if(e.code!==22){if(this.appendError){this.appendError++}else{this.appendError=1}o.details=h["a"].BUFFER_APPEND_ERROR;if(this.appendError>t.config.appendErrorMaxRetry){F["b"].log("fail "+t.config.appendErrorMaxRetry+" times to append segment in sourceBuffer");i=[];o.fatal=true;t.trigger(M["a"].ERROR,o)}else{o.fatal=false;t.trigger(M["a"].ERROR,o)}}else{this.segments=[];o.details=h["a"].BUFFER_FULL_ERROR;o.fatal=false;t.trigger(M["a"].ERROR,o)}}}}};i.prototype.flushBuffer=function e(t,r,i){var a=void 0,n=void 0,s=void 0,o=void 0,l=void 0,u=void 0,f=this.sourceBuffer;if(Object.keys(f).length){F["b"].log("flushBuffer,pos/start/end: "+this.media.currentTime.toFixed(3)+"/"+t+"/"+r);if(this.flushBufferCounter<this.appended){for(var c in f){if(i&&c!==i){continue}a=f[c];a.ended=false;if(!a.updating){try{for(n=0;n<a.buffered.length;n++){s=a.buffered.start(n);o=a.buffered.end(n);if(navigator.userAgent.toLowerCase().indexOf("firefox")!==-1&&r===Number.POSITIVE_INFINITY){l=t;u=r}else{l=Math.max(s,t);u=Math.min(o,r)}if(Math.min(u,o)-l>.5){this.flushBufferCounter++;F["b"].log("flush "+c+" ["+l+","+u+"], of ["+s+","+o+"], pos:"+this.media.currentTime);a.remove(l,u);return false}}}catch(e){F["b"].warn("exception while accessing sourcebuffer, it might have been removed from MediaSource")}}else{F["b"].warn("cannot flush, sb updating in progress");return false}}}else{F["b"].warn("abort flushing too many retries")}F["b"].log("buffer flushed")}return true};return i}(f);var $t=Qt;var Jt=function(){function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}return function(e,t,r){if(t)i(e.prototype,t);if(r)i(e,r);return e}}();function Zt(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function er(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function tr(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var rr=function(r){tr(a,r);function a(e){Zt(this,a);var t=er(this,r.call(this,e,M["a"].FPS_DROP_LEVEL_CAPPING,M["a"].MEDIA_ATTACHING,M["a"].MANIFEST_PARSED,M["a"].BUFFER_CODECS,M["a"].MEDIA_DETACHING));t.autoLevelCapping=Number.POSITIVE_INFINITY;t.firstLevel=null;t.levels=[];t.media=null;t.restrictedLevels=[];t.timer=null;return t}a.prototype.destroy=function e(){if(this.hls.config.capLevelToPlayerSize){this.media=null;this._stopCapping()}};a.prototype.onFpsDropLevelCapping=function e(t){if(a.isLevelAllowed(t.droppedLevel,this.restrictedLevels)){this.restrictedLevels.push(t.droppedLevel)}};a.prototype.onMediaAttaching=function e(t){this.media=t.media instanceof window.HTMLVideoElement?t.media:null};a.prototype.onManifestParsed=function e(t){var r=this.hls;this.restrictedLevels=[];this.levels=t.levels;this.firstLevel=t.firstLevel;if(r.config.capLevelToPlayerSize&&(t.video||t.levels.length&&t.altAudio)){this._startCapping()}};a.prototype.onBufferCodecs=function e(t){var r=this.hls;if(r.config.capLevelToPlayerSize&&t.video){this._startCapping()}};a.prototype.onLevelsUpdated=function e(t){this.levels=t.levels};a.prototype.onMediaDetaching=function e(){this._stopCapping()};a.prototype.detectPlayerSize=function e(){if(this.media){var t=this.levels?this.levels.length:0;if(t){var r=this.hls;r.autoLevelCapping=this.getMaxLevel(t-1);if(r.autoLevelCapping>this.autoLevelCapping){r.streamController.nextLevelSwitch()}this.autoLevelCapping=r.autoLevelCapping}}};a.prototype.getMaxLevel=function e(r){var i=this;if(!this.levels){return-1}var t=this.levels.filter(function(e,t){return a.isLevelAllowed(t,i.restrictedLevels)&&t<=r});return a.getMaxLevelByMediaSize(t,this.mediaWidth,this.mediaHeight)};a.prototype._startCapping=function e(){if(this.timer){return}this.autoLevelCapping=Number.POSITIVE_INFINITY;this.hls.firstLevel=this.getMaxLevel(this.firstLevel);clearInterval(this.timer);this.timer=setInterval(this.detectPlayerSize.bind(this),1e3);this.detectPlayerSize()};a.prototype._stopCapping=function e(){this.restrictedLevels=[];this.firstLevel=null;this.autoLevelCapping=Number.POSITIVE_INFINITY;if(this.timer){this.timer=clearInterval(this.timer);this.timer=null}};a.isLevelAllowed=function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return r.indexOf(t)===-1};a.getMaxLevelByMediaSize=function e(t,r,i){if(!t||t&&!t.length){return-1}var a=function e(t,r){if(!r){return true}return t.width!==r.width||t.height!==r.height};var n=t.length-1;for(var s=0;s<t.length;s+=1){var o=t[s];if((o.width>=r||o.height>=i)&&a(o,t[s+1])){n=s;break}}return n};Jt(a,[{key:"mediaWidth",get:function e(){var t=void 0;var r=this.media;if(r){t=r.width||r.clientWidth||r.offsetWidth;t*=a.contentScaleFactor}return t}},{key:"mediaHeight",get:function e(){var t=void 0;var r=this.media;if(r){t=r.height||r.clientHeight||r.offsetHeight;t*=a.contentScaleFactor}return t}}],[{key:"contentScaleFactor",get:function e(){var t=1;try{t=window.devicePixelRatio}catch(e){}return t}}]);return a}(f);var ir=rr;function ar(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function nr(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function sr(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var or=window,lr=or.performance;var ur=function(t){sr(r,t);function r(e){ar(this,r);return nr(this,t.call(this,e,M["a"].MEDIA_ATTACHING))}r.prototype.destroy=function e(){if(this.timer){clearInterval(this.timer)}this.isVideoPlaybackQualityAvailable=false};r.prototype.onMediaAttaching=function e(t){var r=this.hls.config;if(r.capLevelOnFPSDrop){var i=this.video=t.media instanceof window.HTMLVideoElement?t.media:null;if(typeof i.getVideoPlaybackQuality==="function"){this.isVideoPlaybackQualityAvailable=true}clearInterval(this.timer);this.timer=setInterval(this.checkFPSInterval.bind(this),r.fpsDroppedMonitoringPeriod)}};r.prototype.checkFPS=function e(t,r,i){var a=lr.now();if(r){if(this.lastTime){var n=a-this.lastTime,s=i-this.lastDroppedFrames,o=r-this.lastDecodedFrames,l=1e3*s/n,u=this.hls;u.trigger(M["a"].FPS_DROP,{currentDropped:s,currentDecoded:o,totalDroppedFrames:i});if(l>0){if(s>u.config.fpsDroppedMonitoringThreshold*o){var f=u.currentLevel;F["b"].warn("drop FPS ratio greater than max allowed value for currentLevel: "+f);if(f>0&&(u.autoLevelCapping===-1||u.autoLevelCapping>=f)){f=f-1;u.trigger(M["a"].FPS_DROP_LEVEL_CAPPING,{level:f,droppedLevel:u.currentLevel});u.autoLevelCapping=f;u.streamController.nextLevelSwitch()}}}}this.lastTime=a;this.lastDroppedFrames=i;this.lastDecodedFrames=r}};r.prototype.checkFPSInterval=function e(){var t=this.video;if(t){if(this.isVideoPlaybackQualityAvailable){var r=t.getVideoPlaybackQuality();this.checkFPS(t,r.totalVideoFrames,r.droppedVideoFrames)}else{this.checkFPS(t,t.webkitDecodedFrameCount,t.webkitDroppedFrameCount)}}};return r}(f);var fr=ur;function cr(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var dr=window,hr=dr.performance,pr=dr.XMLHttpRequest;var vr=function(){function t(e){cr(this,t);if(e&&e.xhrSetup){this.xhrSetup=e.xhrSetup}}t.prototype.destroy=function e(){this.abort();this.loader=null};t.prototype.abort=function e(){var t=this.loader;if(t&&t.readyState!==4){this.stats.aborted=true;t.abort()}window.clearTimeout(this.requestTimeout);this.requestTimeout=null;window.clearTimeout(this.retryTimeout);this.retryTimeout=null};t.prototype.load=function e(t,r,i){this.context=t;this.config=r;this.callbacks=i;this.stats={trequest:hr.now(),retry:0};this.retryDelay=r.retryDelay;this.loadInternal()};t.prototype.loadInternal=function e(){var t=void 0,r=this.context;t=this.loader=new pr;var i=this.stats;i.tfirst=0;i.loaded=0;var a=this.xhrSetup;try{if(a){try{a(t,r.url)}catch(e){t.open("GET",r.url,true);a(t,r.url)}}if(!t.readyState){t.open("GET",r.url,true)}}catch(e){this.callbacks.onError({code:t.status,text:e.message},r,t);return}if(r.rangeEnd){t.setRequestHeader("Range","bytes="+r.rangeStart+"-"+(r.rangeEnd-1))}t.onreadystatechange=this.readystatechange.bind(this);t.onprogress=this.loadprogress.bind(this);t.responseType=r.responseType;this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout);t.send()};t.prototype.readystatechange=function e(t){var r=t.currentTarget,i=r.readyState,a=this.stats,n=this.context,s=this.config;if(a.aborted){return}if(i>=2){window.clearTimeout(this.requestTimeout);if(a.tfirst===0){a.tfirst=Math.max(hr.now(),a.trequest)}if(i===4){var o=r.status;if(o>=200&&o<300){a.tload=Math.max(a.tfirst,hr.now());var l=void 0,u=void 0;if(n.responseType==="arraybuffer"){l=r.response;u=l.byteLength}else{l=r.responseText;u=l.length}a.loaded=a.total=u;var f={url:r.responseURL,data:l};this.callbacks.onSuccess(f,a,n,r)}else{if(a.retry>=s.maxRetry||o>=400&&o<499){F["b"].error(o+" while loading "+n.url);this.callbacks.onError({code:o,text:r.statusText},n,r)}else{F["b"].warn(o+" while loading "+n.url+", retrying in "+this.retryDelay+"...");this.destroy();this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay);this.retryDelay=Math.min(2*this.retryDelay,s.maxRetryDelay);a.retry++}}}else{this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),s.timeout)}}};t.prototype.loadtimeout=function e(){F["b"].warn("timeout while loading "+this.context.url);this.callbacks.onTimeout(this.stats,this.context,null)};t.prototype.loadprogress=function e(t){var r=t.currentTarget,i=this.stats;i.loaded=t.loaded;if(t.lengthComputable){i.total=t.total}var a=this.callbacks.onProgress;if(a){a(i,this.context,null,r)}};return t}();var yr=vr;var gr=function(){function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}return function(e,t,r){if(t)i(e.prototype,t);if(r)i(e,r);return e}}();function mr(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function br(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function Er(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var Tr=function(r){Er(i,r);function i(e){mr(this,i);var t=br(this,r.call(this,e,M["a"].MANIFEST_LOADING,M["a"].MANIFEST_PARSED,M["a"].AUDIO_TRACK_LOADED,M["a"].AUDIO_TRACK_SWITCHED,M["a"].LEVEL_LOADED,M["a"].ERROR));t._trackId=-1;t._selectDefaultTrack=true;t.tracks=[];t.trackIdBlacklist=Object.create(null);t.audioGroupId=null;return t}i.prototype.onManifestLoading=function e(){this.tracks=[];this._trackId=-1;this._selectDefaultTrack=true};i.prototype.onManifestParsed=function e(t){var r=this.tracks=t.audioTracks||[];this.hls.trigger(M["a"].AUDIO_TRACKS_UPDATED,{audioTracks:r})};i.prototype.onAudioTrackLoaded=function e(t){if(t.id>=this.tracks.length){F["b"].warn("Invalid audio track id:",t.id);return}F["b"].log("audioTrack "+t.id+" loaded");this.tracks[t.id].details=t.details;if(t.details.live&&!this.hasInterval()){var r=t.details.targetduration*1e3;this.setInterval(r)}if(!t.details.live&&this.hasInterval()){this.clearInterval()}};i.prototype.onAudioTrackSwitched=function e(t){var r=this.tracks[t.id].groupId;if(r&&this.audioGroupId!==r){this.audioGroupId=r}};i.prototype.onLevelLoaded=function e(t){var r=this.hls.levels[t.level];if(!r.audioGroupIds){return}var i=r.audioGroupIds[r.urlId];if(this.audioGroupId!==i){this.audioGroupId=i;this._selectInitialAudioTrack()}};i.prototype.onError=function e(t){if(t.type!==h["b"].NETWORK_ERROR){return}if(t.fatal){this.clearInterval()}if(t.details!==h["a"].AUDIO_TRACK_LOAD_ERROR){return}F["b"].warn("Network failure on audio-track id:",t.context.id);this._handleLoadError()};i.prototype._setAudioTrack=function e(t){if(this._trackId===t&&this.tracks[this._trackId].details){F["b"].debug("Same id as current audio-track passed, and track details available -> no-op");return}if(t<0||t>=this.tracks.length){F["b"].warn("Invalid id passed to audio-track controller");return}var r=this.tracks[t];F["b"].log("Now switching to audio-track index "+t);this.clearInterval();this._trackId=t;var i=r.url,a=r.type,n=r.id;this.hls.trigger(M["a"].AUDIO_TRACK_SWITCHING,{id:n,type:a,url:i});this._loadTrackDetailsIfNeeded(r)};i.prototype.doTick=function e(){this._updateTrack(this._trackId)};i.prototype._selectInitialAudioTrack=function e(){var t=this;var r=this.tracks;if(!r.length){return}var i=this.tracks[this._trackId];var a=null;if(i){a=i.name}if(this._selectDefaultTrack){var n=r.filter(function(e){return e.default});if(n.length){r=n}else{F["b"].warn("No default audio tracks defined")}}var s=false;var o=function e(){r.forEach(function(e){if(s){return}if((!t.audioGroupId||e.groupId===t.audioGroupId)&&(!a||a===e.name)){t._setAudioTrack(e.id);s=true}})};o();if(!s){a=null;o()}if(!s){F["b"].error("No track found for running audio group-ID: "+this.audioGroupId);this.hls.trigger(M["a"].ERROR,{type:h["b"].MEDIA_ERROR,details:h["a"].AUDIO_TRACK_LOAD_ERROR,fatal:true})}};i.prototype._needsTrackLoading=function e(t){var r=t.details;if(!r){return true}else if(r.live){return true}};i.prototype._loadTrackDetailsIfNeeded=function e(t){if(this._needsTrackLoading(t)){var r=t.url,i=t.id;F["b"].log("loading audio-track playlist for id: "+i);this.hls.trigger(M["a"].AUDIO_TRACK_LOADING,{url:r,id:i})}};i.prototype._updateTrack=function e(t){if(t<0||t>=this.tracks.length){return}this.clearInterval();this._trackId=t;F["b"].log("trying to update audio-track "+t);var r=this.tracks[t];this._loadTrackDetailsIfNeeded(r)};i.prototype._handleLoadError=function e(){this.trackIdBlacklist[this._trackId]=true;var t=this._trackId;var r=this.tracks[t],i=r.name,a=r.language,n=r.groupId;F["b"].warn("Loading failed on audio track id: "+t+", group-id: "+n+', name/language: "'+i+'" / "'+a+'"');var s=t;for(var o=0;o<this.tracks.length;o++){if(this.trackIdBlacklist[o]){continue}var l=this.tracks[o];if(l.name===i){s=o;break}}if(s===t){F["b"].warn('No fallback audio-track found for name/language: "'+i+'" / "'+a+'"');return}F["b"].log("Attempting audio-track fallback id:",s,"group-id:",this.tracks[s].groupId);this._setAudioTrack(s)};gr(i,[{key:"audioTracks",get:function e(){return this.tracks}},{key:"audioTrack",get:function e(){return this._trackId},set:function e(t){this._setAudioTrack(t);this._selectDefaultTrack=false}}]);return i}($e);var Sr=Tr;var wr=function(){function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}return function(e,t,r){if(t)i(e.prototype,t);if(r)i(e,r);return e}}();function Ar(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function _r(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function Rr(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var Lr=window,kr=Lr.performance;var Dr={STOPPED:"STOPPED",STARTING:"STARTING",IDLE:"IDLE",PAUSED:"PAUSED",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS"};var Ir=function(i){Rr(a,i);function a(e,t){Ar(this,a);var r=_r(this,i.call(this,e,M["a"].MEDIA_ATTACHED,M["a"].MEDIA_DETACHING,M["a"].AUDIO_TRACKS_UPDATED,M["a"].AUDIO_TRACK_SWITCHING,M["a"].AUDIO_TRACK_LOADED,M["a"].KEY_LOADED,M["a"].FRAG_LOADED,M["a"].FRAG_PARSING_INIT_SEGMENT,M["a"].FRAG_PARSING_DATA,M["a"].FRAG_PARSED,M["a"].ERROR,M["a"].BUFFER_RESET,M["a"].BUFFER_CREATED,M["a"].BUFFER_APPENDED,M["a"].BUFFER_FLUSHED,M["a"].INIT_PTS_FOUND));r.fragmentTracker=t;r.config=e.config;r.audioCodecSwap=false;r._state=Dr.STOPPED;r.initPTS=[];r.waitingFragment=null;r.videoTrackCC=null;return r}a.prototype.onHandlerDestroying=function e(){this.stopLoad();i.prototype.onHandlerDestroying.call(this)};a.prototype.onHandlerDestroyed=function e(){this.state=Dr.STOPPED;this.fragmentTracker=null;i.prototype.onHandlerDestroyed.call(this)};a.prototype.onInitPtsFound=function e(t){var r=t.id,i=t.frag.cc,a=t.initPTS;if(r==="main"){this.initPTS[i]=a;this.videoTrackCC=i;F["b"].log("InitPTS for cc: "+i+" found from video track: "+a);if(this.state===Dr.WAITING_INIT_PTS){this.tick()}}};a.prototype.startLoad=function e(t){if(this.tracks){var r=this.lastCurrentTime;this.stopLoad();this.setInterval(100);this.fragLoadError=0;if(r>0&&t===-1){F["b"].log("audio:override startPosition with lastCurrentTime @"+r.toFixed(3));this.state=Dr.IDLE}else{this.lastCurrentTime=this.startPosition?this.startPosition:t;this.state=Dr.STARTING}this.nextLoadPosition=this.startPosition=this.lastCurrentTime;this.tick()}else{this.startPosition=t;this.state=Dr.STOPPED}};a.prototype.stopLoad=function e(){var t=this.fragCurrent;if(t){if(t.loader){t.loader.abort()}this.fragmentTracker.removeFragment(t);this.fragCurrent=null}this.fragPrevious=null;if(this.demuxer){this.demuxer.destroy();this.demuxer=null}this.state=Dr.STOPPED};a.prototype.doTick=function e(){var t=void 0,r=void 0,i=void 0,a=this.hls,n=a.config;switch(this.state){case Dr.ERROR:case Dr.PAUSED:case Dr.BUFFER_FLUSHING:break;case Dr.STARTING:this.state=Dr.WAITING_TRACK;this.loadedmetadata=false;break;case Dr.IDLE:var s=this.tracks;if(!s){break}if(!this.media&&(this.startFragRequested||!n.startFragPrefetch)){break}if(this.loadedmetadata){t=this.media.currentTime}else{t=this.nextLoadPosition;if(t===undefined){break}}var o=this.mediaBuffer?this.mediaBuffer:this.media,l=this.videoBuffer?this.videoBuffer:this.media,u=Ee.bufferInfo(o,t,n.maxBufferHole),f=Ee.bufferInfo(l,t,n.maxBufferHole),c=u.len,d=u.end,h=this.fragPrevious,p=Math.min(n.maxBufferLength,n.maxMaxBufferLength),v=Math.max(p,f.len),y=this.audioSwitch,g=this.trackId;if((c<v||y)&&g<s.length){i=s[g].details;if(typeof i==="undefined"){this.state=Dr.WAITING_TRACK;break}if(!y&&!i.live&&h&&h.sn===i.endSN&&!u.nextStart){if(!this.media.seeking||this.media.duration-d<h.duration/2){this.hls.trigger(M["a"].BUFFER_EOS,{type:"audio"});this.state=Dr.ENDED;break}}var m=i.fragments,b=m.length,E=m[0].start,T=m[b-1].start+m[b-1].duration,S=void 0;if(y){if(i.live&&!i.PTSKnown){F["b"].log("switching audiotrack, live stream, unknown PTS,load first fragment");d=0}else{d=t;if(i.PTSKnown&&t<E){if(u.end>E||u.nextStart){F["b"].log("alt audio track ahead of main track, seek to start of alt audio track");this.media.currentTime=E+.05}else{return}}}}if(i.initSegment&&!i.initSegment.data){S=i.initSegment}else if(d<=E){S=m[0];if(this.videoTrackCC!==null&&S.cc!==this.videoTrackCC){S=Ge(m,this.videoTrackCC)}if(i.live&&S.loadIdx&&S.loadIdx===this.fragLoadIdx){var w=u.nextStart?u.nextStart:E;F["b"].log("no alt audio available @currentTime:"+this.media.currentTime+", seeking @"+(w+.05));this.media.currentTime=w+.05;return}}else{var A=void 0;var _=n.maxFragLookUpTolerance;var R=h?m[h.sn-m[0].sn+1]:undefined;var L=function e(t){var r=Math.min(_,t.duration);if(t.start+t.duration-r<=d){return 1}else if(t.start-r>d&&t.start){return-1}return 0};if(d<T){if(d>T-_){_=0}if(R&&!L(R)){A=R}else{A=me.search(m,L)}}else{A=m[b-1]}if(A){S=A;E=A.start;if(h&&S.level===h.level&&S.sn===h.sn){if(S.sn<i.endSN){S=m[S.sn+1-i.startSN];F["b"].log("SN just loaded, load next one: "+S.sn)}else{S=null}}}}if(S){if(S.encrypted){F["b"].log("Loading key for "+S.sn+" of ["+i.startSN+" ,"+i.endSN+"],track "+g);this.state=Dr.KEY_LOADING;a.trigger(M["a"].KEY_LOADING,{frag:S})}else{F["b"].log("Loading "+S.sn+", cc: "+S.cc+" of ["+i.startSN+" ,"+i.endSN+"],track "+g+", currentTime:"+t+",bufferEnd:"+d.toFixed(3));if(y||this.fragmentTracker.getState(S)===ve.NOT_LOADED){this.fragCurrent=S;this.startFragRequested=true;if(Object(x["a"])(S.sn)){this.nextLoadPosition=S.start+S.duration}a.trigger(M["a"].FRAG_LOADING,{frag:S});this.state=Dr.FRAG_LOADING}}}}break;case Dr.WAITING_TRACK:r=this.tracks[this.trackId];if(r&&r.details){this.state=Dr.IDLE}break;case Dr.FRAG_LOADING_WAITING_RETRY:var k=kr.now();var D=this.retryDate;o=this.media;var I=o&&o.seeking;if(!D||k>=D||I){F["b"].log("audioStreamController: retryDate reached, switch back to IDLE state");this.state=Dr.IDLE}break;case Dr.WAITING_INIT_PTS:var O=this.videoTrackCC;if(this.initPTS[O]===undefined){break}var P=this.waitingFragment;if(P){var C=P.frag.cc;if(O!==C){r=this.tracks[this.trackId];if(r.details&&r.details.live){F["b"].warn("Waiting fragment CC ("+C+") does not match video track CC ("+O+")");this.waitingFragment=null;this.state=Dr.IDLE}}else{this.state=Dr.FRAG_LOADING;this.onFragLoaded(this.waitingFragment);this.waitingFragment=null}}else{this.state=Dr.IDLE}break;case Dr.STOPPED:case Dr.FRAG_LOADING:case Dr.PARSING:case Dr.PARSED:case Dr.ENDED:break;default:break}};a.prototype.onMediaAttached=function e(t){var r=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this);this.onvended=this.onMediaEnded.bind(this);r.addEventListener("seeking",this.onvseeking);r.addEventListener("ended",this.onvended);var i=this.config;if(this.tracks&&i.autoStartLoad){this.startLoad(i.startPosition)}};a.prototype.onMediaDetaching=function e(){var t=this.media;if(t&&t.ended){F["b"].log("MSE detaching and video ended, reset startPosition");this.startPosition=this.lastCurrentTime=0}if(t){t.removeEventListener("seeking",this.onvseeking);t.removeEventListener("ended",this.onvended);this.onvseeking=this.onvseeked=this.onvended=null}this.media=this.mediaBuffer=this.videoBuffer=null;this.loadedmetadata=false;this.stopLoad()};a.prototype.onMediaSeeking=function e(){if(this.state===Dr.ENDED){this.state=Dr.IDLE}if(this.media){this.lastCurrentTime=this.media.currentTime}this.tick()};a.prototype.onMediaEnded=function e(){this.startPosition=this.lastCurrentTime=0};a.prototype.onAudioTracksUpdated=function e(t){F["b"].log("audio tracks updated");this.tracks=t.audioTracks};a.prototype.onAudioTrackSwitching=function e(t){var r=!!t.url;this.trackId=t.id;this.fragCurrent=null;this.state=Dr.PAUSED;this.waitingFragment=null;if(!r){if(this.demuxer){this.demuxer.destroy();this.demuxer=null}}else{this.setInterval(100)}if(r){this.audioSwitch=true;this.state=Dr.IDLE}this.tick()};a.prototype.onAudioTrackLoaded=function e(t){var r=t.details,i=t.id,a=this.tracks[i],n=r.totalduration,s=0;F["b"].log("track "+i+" loaded ["+r.startSN+","+r.endSN+"],duration:"+n);if(r.live){var o=a.details;if(o&&r.fragments.length>0){Fe(o,r);s=r.fragments[0].start;if(r.PTSKnown){F["b"].log("live audio playlist sliding:"+s.toFixed(3))}else{F["b"].log("live audio playlist - outdated PTS, unknown sliding")}}else{r.PTSKnown=false;F["b"].log("live audio playlist - first load, unknown sliding")}}else{r.PTSKnown=false}a.details=r;if(!this.startFragRequested){if(this.startPosition===-1){var l=r.startTimeOffset;if(Object(x["a"])(l)){F["b"].log("start time offset found in playlist, adjust startPosition to "+l);this.startPosition=l}else{this.startPosition=0}}this.nextLoadPosition=this.startPosition}if(this.state===Dr.WAITING_TRACK){this.state=Dr.IDLE}this.tick()};a.prototype.onKeyLoaded=function e(){if(this.state===Dr.KEY_LOADING){this.state=Dr.IDLE;this.tick()}};a.prototype.onFragLoaded=function e(t){var r=this.fragCurrent,i=t.frag;if(this.state===Dr.FRAG_LOADING&&r&&i.type==="audio"&&i.level===r.level&&i.sn===r.sn){var a=this.tracks[this.trackId],n=a.details,s=n.totalduration,o=r.level,l=r.sn,u=r.cc,f=this.config.defaultAudioCodec||a.audioCodec||"mp4a.40.2",c=this.stats=t.stats;if(l==="initSegment"){this.state=Dr.IDLE;c.tparsed=c.tbuffered=kr.now();n.initSegment.data=t.payload;this.hls.trigger(M["a"].FRAG_BUFFERED,{stats:c,frag:r,id:"audio"});this.tick()}else{this.state=Dr.PARSING;this.appended=false;if(!this.demuxer){this.demuxer=new Pe(this.hls,"audio")}var d=this.initPTS[u];var h=n.initSegment?n.initSegment.data:[];if(n.initSegment||d!==undefined){this.pendingBuffering=true;F["b"].log("Demuxing "+l+" of ["+n.startSN+" ,"+n.endSN+"],track "+o);var p=false;this.demuxer.push(t.payload,h,f,null,r,s,p,d)}else{F["b"].log("unknown video PTS for continuity counter "+u+", waiting for video PTS before demuxing audio frag "+l+" of ["+n.startSN+" ,"+n.endSN+"],track "+o);this.waitingFragment=t;this.state=Dr.WAITING_INIT_PTS}}}this.fragLoadError=0};a.prototype.onFragParsingInitSegment=function e(t){var r=this.fragCurrent;var i=t.frag;if(r&&t.id==="audio"&&i.sn===r.sn&&i.level===r.level&&this.state===Dr.PARSING){var a=t.tracks,n=void 0;if(a.video){delete a.video}n=a.audio;if(n){n.levelCodec=n.codec;n.id=t.id;this.hls.trigger(M["a"].BUFFER_CODECS,a);F["b"].log("audio track:audio,container:"+n.container+",codecs[level/parsed]=["+n.levelCodec+"/"+n.codec+"]");var s=n.initSegment;if(s){var o={type:"audio",data:s,parent:"audio",content:"initSegment"};if(this.audioSwitch){this.pendingData=[o]}else{this.appended=true;this.pendingBuffering=true;this.hls.trigger(M["a"].BUFFER_APPENDING,o)}}this.tick()}}};a.prototype.onFragParsingData=function e(t){var r=this;var i=this.fragCurrent;var a=t.frag;if(i&&t.id==="audio"&&t.type==="audio"&&a.sn===i.sn&&a.level===i.level&&this.state===Dr.PARSING){var n=this.trackId,s=this.tracks[n],o=this.hls;if(!Object(x["a"])(t.endPTS)){t.endPTS=t.startPTS+i.duration;t.endDTS=t.startDTS+i.duration}i.addElementaryStream(P.ElementaryStreamTypes.AUDIO);F["b"].log("parsed "+t.type+",PTS:["+t.startPTS.toFixed(3)+","+t.endPTS.toFixed(3)+"],DTS:["+t.startDTS.toFixed(3)+"/"+t.endDTS.toFixed(3)+"],nb:"+t.nb);Me(s.details,i,t.startPTS,t.endPTS);var l=this.audioSwitch,u=this.media,f=false;if(l&&u){if(u.readyState){var c=u.currentTime;F["b"].log("switching audio track : currentTime:"+c);if(c>=t.startPTS){F["b"].log("switching audio track : flushing all audio");this.state=Dr.BUFFER_FLUSHING;o.trigger(M["a"].BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"});f=true;this.audioSwitch=false;o.trigger(M["a"].AUDIO_TRACK_SWITCHED,{id:n})}}else{this.audioSwitch=false;o.trigger(M["a"].AUDIO_TRACK_SWITCHED,{id:n})}}var d=this.pendingData;if(!d){F["b"].warn("Apparently attempt to enqueue media payload without codec initialization data upfront");o.trigger(M["a"].ERROR,{type:h["b"].MEDIA_ERROR,details:null,fatal:true});return}if(!this.audioSwitch){[t.data1,t.data2].forEach(function(e){if(e&&e.length){d.push({type:t.type,data:e,parent:"audio",content:"data"})}});if(!f&&d.length){d.forEach(function(e){if(r.state===Dr.PARSING){r.pendingBuffering=true;r.hls.trigger(M["a"].BUFFER_APPENDING,e)}});this.pendingData=[];this.appended=true}}this.tick()}};a.prototype.onFragParsed=function e(t){var r=this.fragCurrent;var i=t.frag;if(r&&t.id==="audio"&&i.sn===r.sn&&i.level===r.level&&this.state===Dr.PARSING){this.stats.tparsed=kr.now();this.state=Dr.PARSED;this._checkAppendedParsed()}};a.prototype.onBufferReset=function e(){this.mediaBuffer=this.videoBuffer=null;this.loadedmetadata=false};a.prototype.onBufferCreated=function e(t){var r=t.tracks.audio;if(r){this.mediaBuffer=r.buffer;this.loadedmetadata=true}if(t.tracks.video){this.videoBuffer=t.tracks.video.buffer}};a.prototype.onBufferAppended=function e(t){if(t.parent==="audio"){var r=this.state;if(r===Dr.PARSING||r===Dr.PARSED){this.pendingBuffering=t.pending>0;this._checkAppendedParsed()}}};a.prototype._checkAppendedParsed=function e(){if(this.state===Dr.PARSED&&(!this.appended||!this.pendingBuffering)){var t=this.fragCurrent,r=this.stats,i=this.hls;if(t){this.fragPrevious=t;r.tbuffered=kr.now();i.trigger(M["a"].FRAG_BUFFERED,{stats:r,frag:t,id:"audio"});var a=this.mediaBuffer?this.mediaBuffer:this.media;F["b"].log("audio buffered : "+Ue.toString(a.buffered));if(this.audioSwitch&&this.appended){this.audioSwitch=false;i.trigger(M["a"].AUDIO_TRACK_SWITCHED,{id:this.trackId})}this.state=Dr.IDLE}this.tick()}};a.prototype.onError=function e(t){var r=t.frag;if(r&&r.type!=="audio"){return}switch(t.details){case h["a"].FRAG_LOAD_ERROR:case h["a"].FRAG_LOAD_TIMEOUT:var i=t.frag;if(i&&i.type!=="audio"){break}if(!t.fatal){var a=this.fragLoadError;if(a){a++}else{a=1}var n=this.config;if(a<=n.fragLoadingMaxRetry){this.fragLoadError=a;var s=Math.min(Math.pow(2,a-1)*n.fragLoadingRetryDelay,n.fragLoadingMaxRetryTimeout);F["b"].warn("AudioStreamController: frag loading failed, retry in "+s+" ms");this.retryDate=kr.now()+s;this.state=Dr.FRAG_LOADING_WAITING_RETRY}else{F["b"].error("AudioStreamController: "+t.details+" reaches max retry, redispatch as fatal ...");t.fatal=true;this.state=Dr.ERROR}}break;case h["a"].AUDIO_TRACK_LOAD_ERROR:case h["a"].AUDIO_TRACK_LOAD_TIMEOUT:case h["a"].KEY_LOAD_ERROR:case h["a"].KEY_LOAD_TIMEOUT:if(this.state!==Dr.ERROR){this.state=t.fatal?Dr.ERROR:Dr.IDLE;F["b"].warn("AudioStreamController: "+t.details+" while loading frag, now switching to "+this.state+" state ...")}break;case h["a"].BUFFER_FULL_ERROR:if(t.parent==="audio"&&(this.state===Dr.PARSING||this.state===Dr.PARSED)){var o=this.mediaBuffer,l=this.media.currentTime,u=o&&Ee.isBuffered(o,l)&&Ee.isBuffered(o,l+.5);if(u){var f=this.config;if(f.maxMaxBufferLength>=f.maxBufferLength){f.maxMaxBufferLength/=2;F["b"].warn("AudioStreamController: reduce max buffer length to "+f.maxMaxBufferLength+"s")}this.state=Dr.IDLE}else{F["b"].warn("AudioStreamController: buffer full error also media.currentTime is not buffered, flush audio buffer");this.fragCurrent=null;this.state=Dr.BUFFER_FLUSHING;this.hls.trigger(M["a"].BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"})}}break;default:break}};a.prototype.onBufferFlushed=function e(){var t=this;var r=this.pendingData;if(r&&r.length){F["b"].log("AudioStreamController: appending pending audio data after buffer flushed");r.forEach(function(e){t.hls.trigger(M["a"].BUFFER_APPENDING,e)});this.appended=true;this.pendingData=[];this.state=Dr.PARSED}else{this.state=Dr.IDLE;this.fragPrevious=null;this.tick()}};wr(a,[{key:"state",set:function e(t){if(this.state!==t){var r=this.state;this._state=t;F["b"].log("audio stream:"+r+"->"+t)}},get:function e(){return this._state}}]);return a}($e);var Or=Ir;var Pr=function(){if(typeof window!=="undefined"&&window.VTTCue){return window.VTTCue}var E="auto";var r={"":true,lr:true,rl:true};var i={start:true,middle:true,end:true,left:true,right:true};function T(e){if(typeof e!=="string"){return false}var t=r[e.toLowerCase()];return t?e.toLowerCase():false}function S(e){if(typeof e!=="string"){return false}var t=i[e.toLowerCase()];return t?e.toLowerCase():false}function w(e){var t=1;for(;t<arguments.length;t++){var r=arguments[t];for(var i in r){e[i]=r[i]}}return e}function e(e,t,r){var i=this;var a=function(){if(typeof navigator==="undefined"){return}return/MSIE\s8\.0/.test(navigator.userAgent)}();var n={};if(a){i=document.createElement("custom")}else{n.enumerable=true}i.hasBeenReset=false;var s="";var o=false;var l=e;var u=t;var f=r;var c=null;var d="";var h=true;var p="auto";var v="start";var y=50;var g="middle";var m=50;var b="middle";Object.defineProperty(i,"id",w({},n,{get:function e(){return s},set:function e(t){s=""+t}}));Object.defineProperty(i,"pauseOnExit",w({},n,{get:function e(){return o},set:function e(t){o=!!t}}));Object.defineProperty(i,"startTime",w({},n,{get:function e(){return l},set:function e(t){if(typeof t!=="number"){throw new TypeError("Start time must be set to a number.")}l=t;this.hasBeenReset=true}}));Object.defineProperty(i,"endTime",w({},n,{get:function e(){return u},set:function e(t){if(typeof t!=="number"){throw new TypeError("End time must be set to a number.")}u=t;this.hasBeenReset=true}}));Object.defineProperty(i,"text",w({},n,{get:function e(){return f},set:function e(t){f=""+t;this.hasBeenReset=true}}));Object.defineProperty(i,"region",w({},n,{get:function e(){return c},set:function e(t){c=t;this.hasBeenReset=true}}));Object.defineProperty(i,"vertical",w({},n,{get:function e(){return d},set:function e(t){var r=T(t);if(r===false){throw new SyntaxError("An invalid or illegal string was specified.")}d=r;this.hasBeenReset=true}}));Object.defineProperty(i,"snapToLines",w({},n,{get:function e(){return h},set:function e(t){h=!!t;this.hasBeenReset=true}}));Object.defineProperty(i,"line",w({},n,{get:function e(){return p},set:function e(t){if(typeof t!=="number"&&t!==E){throw new SyntaxError("An invalid number or illegal string was specified.")}p=t;this.hasBeenReset=true}}));Object.defineProperty(i,"lineAlign",w({},n,{get:function e(){return v},set:function e(t){var r=S(t);if(!r){throw new SyntaxError("An invalid or illegal string was specified.")}v=r;this.hasBeenReset=true}}));Object.defineProperty(i,"position",w({},n,{get:function e(){return y},set:function e(t){if(t<0||t>100){throw new Error("Position must be between 0 and 100.")}y=t;this.hasBeenReset=true}}));Object.defineProperty(i,"positionAlign",w({},n,{get:function e(){return g},set:function e(t){var r=S(t);if(!r){throw new SyntaxError("An invalid or illegal string was specified.")}g=r;this.hasBeenReset=true}}));Object.defineProperty(i,"size",w({},n,{get:function e(){return m},set:function e(t){if(t<0||t>100){throw new Error("Size must be between 0 and 100.")}m=t;this.hasBeenReset=true}}));Object.defineProperty(i,"align",w({},n,{get:function e(){return b},set:function e(t){var r=S(t);if(!r){throw new SyntaxError("An invalid or illegal string was specified.")}b=r;this.hasBeenReset=true}}));i.displayState=undefined;if(a){return i}}e.prototype.getCueAsHTML=function(){var e=window.WebVTT;return e.convertCueToDOMTree(window,this.text)};return e}();var Cr=function e(){return{decode:function e(t){if(!t){return""}if(typeof t!=="string"){throw new Error("Error - expected string data.")}return decodeURIComponent(encodeURIComponent(t))}}};function xr(){this.window=window;this.state="INITIAL";this.buffer="";this.decoder=new Cr;this.regionList=[]}function Mr(e){function t(e,t,r,i){return(e|0)*3600+(t|0)*60+(r|0)+(i|0)/1e3}var r=e.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);if(!r){return null}if(r[3]){return t(r[1],r[2],r[3].replace(":",""),r[4])}else if(r[1]>59){return t(r[1],r[2],0,r[4])}else{return t(0,r[1],r[2],r[4])}}function Fr(){this.values=Object.create(null)}Fr.prototype={set:function e(t,r){if(!this.get(t)&&r!==""){this.values[t]=r}},get:function e(t,r,i){if(i){return this.has(t)?this.values[t]:r[i]}return this.has(t)?this.values[t]:r},has:function e(t){return t in this.values},alt:function e(t,r,i){for(var a=0;a<i.length;++a){if(r===i[a]){this.set(t,r);break}}},integer:function e(t,r){if(/^-?\d+$/.test(r)){this.set(t,parseInt(r,10))}},percent:function e(t,r){var i=void 0;if(i=r.match(/^([\d]{1,3})(\.[\d]*)?%$/)){r=parseFloat(r);if(r>=0&&r<=100){this.set(t,r);return true}}return false}};function Nr(e,t,r,i){var a=i?e.split(i):[e];for(var n in a){if(typeof a[n]!=="string"){continue}var s=a[n].split(r);if(s.length!==2){continue}var o=s[0];var l=s[1];t(o,l)}}var Ur=new Pr(0,0,0);var Br=Ur.align==="middle"?"middle":"center";function Gr(t,e,s){var r=t;function i(){var e=Mr(t);if(e===null){throw new Error("Malformed timestamp: "+r)}t=t.replace(/^[^\sa-zA-Z-]+/,"");return e}function a(e,t){var n=new Fr;Nr(e,function(e,t){switch(e){case"region":for(var r=s.length-1;r>=0;r--){if(s[r].id===t){n.set(e,s[r].region);break}}break;case"vertical":n.alt(e,t,["rl","lr"]);break;case"line":var i=t.split(","),a=i[0];n.integer(e,a);if(n.percent(e,a)){n.set("snapToLines",false)}n.alt(e,a,["auto"]);if(i.length===2){n.alt("lineAlign",i[1],["start",Br,"end"])}break;case"position":i=t.split(",");n.percent(e,i[0]);if(i.length===2){n.alt("positionAlign",i[1],["start",Br,"end","line-left","line-right","auto"])}break;case"size":n.percent(e,t);break;case"align":n.alt(e,t,["start",Br,"end","left","right"]);break}},/:/,/\s/);t.region=n.get("region",null);t.vertical=n.get("vertical","");var r=n.get("line","auto");if(r==="auto"&&Ur.line===-1){r=-1}t.line=r;t.lineAlign=n.get("lineAlign","start");t.snapToLines=n.get("snapToLines",true);t.size=n.get("size",100);t.align=n.get("align",Br);var i=n.get("position","auto");if(i==="auto"&&Ur.position===50){i=t.align==="start"||t.align==="left"?0:t.align==="end"||t.align==="right"?100:50}t.position=i}function n(){t=t.replace(/^\s+/,"")}n();e.startTime=i();n();if(t.substr(0,3)!=="--\x3e"){throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+r)}t=t.substr(3);n();e.endTime=i();n();a(t,e)}function jr(e){return e.replace(/<br(?: \/)?>/gi,"\n")}xr.prototype={parse:function e(t){var i=this;if(t){i.buffer+=i.decoder.decode(t,{stream:true})}function r(){var e=i.buffer;var t=0;e=jr(e);while(t<e.length&&e[t]!=="\r"&&e[t]!=="\n"){++t}var r=e.substr(0,t);if(e[t]==="\r"){++t}if(e[t]==="\n"){++t}i.buffer=e.substr(t);return r}function a(e){Nr(e,function(e,t){switch(e){case"Region":break}},/:/)}try{var n=void 0;if(i.state==="INITIAL"){if(!/\r\n|\n/.test(i.buffer)){return this}n=r();var s=n.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!s||!s[0]){throw new Error("Malformed WebVTT signature.")}i.state="HEADER"}var o=false;while(i.buffer){if(!/\r\n|\n/.test(i.buffer)){return this}if(!o){n=r()}else{o=false}switch(i.state){case"HEADER":if(/:/.test(n)){a(n)}else if(!n){i.state="ID"}continue;case"NOTE":if(!n){i.state="ID"}continue;case"ID":if(/^NOTE($|[ \t])/.test(n)){i.state="NOTE";break}if(!n){continue}i.cue=new Pr(0,0,"");i.state="CUE";if(n.indexOf("--\x3e")===-1){i.cue.id=n;continue}case"CUE":try{Gr(n,i.cue,i.regionList)}catch(e){i.cue=null;i.state="BADCUE";continue}i.state="CUETEXT";continue;case"CUETEXT":var l=n.indexOf("--\x3e")!==-1;if(!n||l&&(o=true)){if(i.oncue){i.oncue(i.cue)}i.cue=null;i.state="ID";continue}if(i.cue.text){i.cue.text+="\n"}i.cue.text+=n;continue;case"BADCUE":if(!n){i.state="ID"}continue}}}catch(e){if(i.state==="CUETEXT"&&i.cue&&i.oncue){i.oncue(i.cue)}i.cue=null;i.state=i.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},flush:function e(){var t=this;try{t.buffer+=t.decoder.decode();if(t.cue||t.state==="HEADER"){t.buffer+="\n\n";t.parse()}if(t.state==="INITIAL"){throw new Error("Malformed WebVTT signature.")}}catch(e){throw e}if(t.onflush){t.onflush()}return this}};var Kr=xr;function Hr(e,t,r,i){var a=void 0;var n=void 0;var s=void 0;var o=void 0;var l=void 0;var u=window.VTTCue||window.TextTrackCue;for(var f=0;f<i.rows.length;f++){a=i.rows[f];s=true;o=0;l="";if(!a.isEmpty()){for(var c=0;c<a.chars.length;c++){if(a.chars[c].uchar.match(/\s/)&&s){o++}else{l+=a.chars[c].uchar;s=false}}a.cueStartTime=t;if(t===r){r+=1e-4}n=new u(t,r,jr(l.trim()));if(o>=16){o--}else{o++}if(navigator.userAgent.match(/Firefox\//)){n.line=f+1}else{n.line=f>7?f-2:f+1}n.align="left";n.position=Math.max(0,Math.min(100,100*(o/32)+(navigator.userAgent.match(/Firefox\//)?50:0)));e.addCue(n)}}}function Vr(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var qr={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499};var Yr=function e(t){var r=t;if(qr.hasOwnProperty(t)){r=qr[t]}return String.fromCharCode(r)};var Wr=15,zr=100;var Xr={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14};var Qr={17:2,18:4,21:6,22:8,23:10,19:13,20:15};var $r={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14};var Jr={25:2,26:4,29:6,30:8,31:10,27:13,28:15};var Zr=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];var ei={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function e(t){this.time=t},log:function e(t,r){var i=this.verboseFilter[t];if(this.verboseLevel>=i){}}};var ti=function e(t){var r=[];for(var i=0;i<t.length;i++){r.push(t[i].toString(16))}return r};var ri=function(){function n(e,t,r,i,a){Vr(this,n);this.foreground=e||"white";this.underline=t||false;this.italics=r||false;this.background=i||"black";this.flash=a||false}n.prototype.reset=function e(){this.foreground="white";this.underline=false;this.italics=false;this.background="black";this.flash=false};n.prototype.setStyles=function e(t){var r=["foreground","underline","italics","background","flash"];for(var i=0;i<r.length;i++){var a=r[i];if(t.hasOwnProperty(a)){this[a]=t[a]}}};n.prototype.isDefault=function e(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash};n.prototype.equals=function e(t){return this.foreground===t.foreground&&this.underline===t.underline&&this.italics===t.italics&&this.background===t.background&&this.flash===t.flash};n.prototype.copy=function e(t){this.foreground=t.foreground;this.underline=t.underline;this.italics=t.italics;this.background=t.background;this.flash=t.flash};n.prototype.toString=function e(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash};return n}();var ii=function(){function s(e,t,r,i,a,n){Vr(this,s);this.uchar=e||" ";this.penState=new ri(t,r,i,a,n)}s.prototype.reset=function e(){this.uchar=" ";this.penState.reset()};s.prototype.setChar=function e(t,r){this.uchar=t;this.penState.copy(r)};s.prototype.setPenState=function e(t){this.penState.copy(t)};s.prototype.equals=function e(t){return this.uchar===t.uchar&&this.penState.equals(t.penState)};s.prototype.copy=function e(t){this.uchar=t.uchar;this.penState.copy(t.penState)};s.prototype.isEmpty=function e(){return this.uchar===" "&&this.penState.isDefault()};return s}();var ai=function(){function t(){Vr(this,t);this.chars=[];for(var e=0;e<zr;e++){this.chars.push(new ii)}this.pos=0;this.currPenState=new ri}t.prototype.equals=function e(t){var r=true;for(var i=0;i<zr;i++){if(!this.chars[i].equals(t.chars[i])){r=false;break}}return r};t.prototype.copy=function e(t){for(var r=0;r<zr;r++){this.chars[r].copy(t.chars[r])}};t.prototype.isEmpty=function e(){var t=true;for(var r=0;r<zr;r++){if(!this.chars[r].isEmpty()){t=false;break}}return t};t.prototype.setCursor=function e(t){if(this.pos!==t){this.pos=t}if(this.pos<0){ei.log("ERROR","Negative cursor position "+this.pos);this.pos=0}else if(this.pos>zr){ei.log("ERROR","Too large cursor position "+this.pos);this.pos=zr}};t.prototype.moveCursor=function e(t){var r=this.pos+t;if(t>1){for(var i=this.pos+1;i<r+1;i++){this.chars[i].setPenState(this.currPenState)}}this.setCursor(r)};t.prototype.backSpace=function e(){this.moveCursor(-1);this.chars[this.pos].setChar(" ",this.currPenState)};t.prototype.insertChar=function e(t){if(t>=144){this.backSpace()}var r=Yr(t);if(this.pos>=zr){ei.log("ERROR","Cannot insert "+t.toString(16)+" ("+r+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(r,this.currPenState);this.moveCursor(1)};t.prototype.clearFromPos=function e(t){var r=void 0;for(r=t;r<zr;r++){this.chars[r].reset()}};t.prototype.clear=function e(){this.clearFromPos(0);this.pos=0;this.currPenState.reset()};t.prototype.clearToEndOfRow=function e(){this.clearFromPos(this.pos)};t.prototype.getTextString=function e(){var t=[];var r=true;for(var i=0;i<zr;i++){var a=this.chars[i].uchar;if(a!==" "){r=false}t.push(a)}if(r){return""}else{return t.join("")}};t.prototype.setPenStyles=function e(t){this.currPenState.setStyles(t);var r=this.chars[this.pos];r.setPenState(this.currPenState)};return t}();var ni=function(){function t(){Vr(this,t);this.rows=[];for(var e=0;e<Wr;e++){this.rows.push(new ai)}this.currRow=Wr-1;this.nrRollUpRows=null;this.reset()}t.prototype.reset=function e(){for(var t=0;t<Wr;t++){this.rows[t].clear()}this.currRow=Wr-1};t.prototype.equals=function e(t){var r=true;for(var i=0;i<Wr;i++){if(!this.rows[i].equals(t.rows[i])){r=false;break}}return r};t.prototype.copy=function e(t){for(var r=0;r<Wr;r++){this.rows[r].copy(t.rows[r])}};t.prototype.isEmpty=function e(){var t=true;for(var r=0;r<Wr;r++){if(!this.rows[r].isEmpty()){t=false;break}}return t};t.prototype.backSpace=function e(){var t=this.rows[this.currRow];t.backSpace()};t.prototype.clearToEndOfRow=function e(){var t=this.rows[this.currRow];t.clearToEndOfRow()};t.prototype.insertChar=function e(t){var r=this.rows[this.currRow];r.insertChar(t)};t.prototype.setPen=function e(t){var r=this.rows[this.currRow];r.setPenStyles(t)};t.prototype.moveCursor=function e(t){var r=this.rows[this.currRow];r.moveCursor(t)};t.prototype.setCursor=function e(t){ei.log("INFO","setCursor: "+t);var r=this.rows[this.currRow];r.setCursor(t)};t.prototype.setPAC=function e(t){ei.log("INFO","pacData = "+JSON.stringify(t));var r=t.row-1;if(this.nrRollUpRows&&r<this.nrRollUpRows-1){r=this.nrRollUpRows-1}if(this.nrRollUpRows&&this.currRow!==r){for(var i=0;i<Wr;i++){this.rows[i].clear()}var a=this.currRow+1-this.nrRollUpRows;var n=this.lastOutputScreen;if(n){var s=n.rows[a].cueStartTime;if(s&&s<ei.time){for(var o=0;o<this.nrRollUpRows;o++){this.rows[r-this.nrRollUpRows+o+1].copy(n.rows[a+o])}}}}this.currRow=r;var l=this.rows[this.currRow];if(t.indent!==null){var u=t.indent;var f=Math.max(u-1,0);l.setCursor(t.indent);t.color=l.chars[f].penState.foreground}var c={foreground:t.color,underline:t.underline,italics:t.italics,background:"black",flash:false};this.setPen(c)};t.prototype.setBkgData=function e(t){ei.log("INFO","bkgData = "+JSON.stringify(t));this.backSpace();this.setPen(t);this.insertChar(32)};t.prototype.setRollUpRows=function e(t){this.nrRollUpRows=t};t.prototype.rollUp=function e(){if(this.nrRollUpRows===null){ei.log("DEBUG","roll_up but nrRollUpRows not set yet");return}ei.log("TEXT",this.getDisplayText());var t=this.currRow+1-this.nrRollUpRows;var r=this.rows.splice(t,1)[0];r.clear();this.rows.splice(this.currRow,0,r);ei.log("INFO","Rolling up")};t.prototype.getDisplayText=function e(t){t=t||false;var r=[];var i="";var a=-1;for(var n=0;n<Wr;n++){var s=this.rows[n].getTextString();if(s){a=n+1;if(t){r.push("Row "+a+": '"+s+"'")}else{r.push(s.trim())}}}if(r.length>0){if(t){i="["+r.join(" | ")+"]"}else{i=r.join("\n")}}return i};t.prototype.getTextAndFormat=function e(){return this.rows};return t}();var si=function(){function r(e,t){Vr(this,r);this.chNr=e;this.outputFilter=t;this.mode=null;this.verbose=0;this.displayedMemory=new ni;this.nonDisplayedMemory=new ni;this.lastOutputScreen=new ni;this.currRollUpRow=this.displayedMemory.rows[Wr-1];this.writeScreen=this.displayedMemory;this.mode=null;this.cueStartTime=null}r.prototype.reset=function e(){this.mode=null;this.displayedMemory.reset();this.nonDisplayedMemory.reset();this.lastOutputScreen.reset();this.currRollUpRow=this.displayedMemory.rows[Wr-1];this.writeScreen=this.displayedMemory;this.mode=null;this.cueStartTime=null;this.lastCueEndTime=null};r.prototype.getHandler=function e(){return this.outputFilter};r.prototype.setHandler=function e(t){this.outputFilter=t};r.prototype.setPAC=function e(t){this.writeScreen.setPAC(t)};r.prototype.setBkgData=function e(t){this.writeScreen.setBkgData(t)};r.prototype.setMode=function e(t){if(t===this.mode){return}this.mode=t;ei.log("INFO","MODE="+t);if(this.mode==="MODE_POP-ON"){this.writeScreen=this.nonDisplayedMemory}else{this.writeScreen=this.displayedMemory;this.writeScreen.reset()}if(this.mode!=="MODE_ROLL-UP"){this.displayedMemory.nrRollUpRows=null;this.nonDisplayedMemory.nrRollUpRows=null}this.mode=t};r.prototype.insertChars=function e(t){for(var r=0;r<t.length;r++){this.writeScreen.insertChar(t[r])}var i=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";ei.log("INFO",i+": "+this.writeScreen.getDisplayText(true));if(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP"){ei.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(true));this.outputDataUpdate()}};r.prototype.ccRCL=function e(){ei.log("INFO","RCL - Resume Caption Loading");this.setMode("MODE_POP-ON")};r.prototype.ccBS=function e(){ei.log("INFO","BS - BackSpace");if(this.mode==="MODE_TEXT"){return}this.writeScreen.backSpace();if(this.writeScreen===this.displayedMemory){this.outputDataUpdate()}};r.prototype.ccAOF=function e(){};r.prototype.ccAON=function e(){};r.prototype.ccDER=function e(){ei.log("INFO","DER- Delete to End of Row");this.writeScreen.clearToEndOfRow();this.outputDataUpdate()};r.prototype.ccRU=function e(t){ei.log("INFO","RU("+t+") - Roll Up");this.writeScreen=this.displayedMemory;this.setMode("MODE_ROLL-UP");this.writeScreen.setRollUpRows(t)};r.prototype.ccFON=function e(){ei.log("INFO","FON - Flash On");this.writeScreen.setPen({flash:true})};r.prototype.ccRDC=function e(){ei.log("INFO","RDC - Resume Direct Captioning");this.setMode("MODE_PAINT-ON")};r.prototype.ccTR=function e(){ei.log("INFO","TR");this.setMode("MODE_TEXT")};r.prototype.ccRTD=function e(){ei.log("INFO","RTD");this.setMode("MODE_TEXT")};r.prototype.ccEDM=function e(){ei.log("INFO","EDM - Erase Displayed Memory");this.displayedMemory.reset();this.outputDataUpdate(true)};r.prototype.ccCR=function e(){ei.log("CR - Carriage Return");this.writeScreen.rollUp();this.outputDataUpdate(true)};r.prototype.ccENM=function e(){ei.log("INFO","ENM - Erase Non-displayed Memory");this.nonDisplayedMemory.reset()};r.prototype.ccEOC=function e(){ei.log("INFO","EOC - End Of Caption");if(this.mode==="MODE_POP-ON"){var t=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory;this.nonDisplayedMemory=t;this.writeScreen=this.nonDisplayedMemory;ei.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(true)};r.prototype.ccTO=function e(t){ei.log("INFO","TO("+t+") - Tab Offset");this.writeScreen.moveCursor(t)};r.prototype.ccMIDROW=function e(t){var r={flash:false};r.underline=t%2===1;r.italics=t>=46;if(!r.italics){var i=Math.floor(t/2)-16;var a=["white","green","blue","cyan","red","yellow","magenta"];r.foreground=a[i]}else{r.foreground="white"}ei.log("INFO","MIDROW: "+JSON.stringify(r));this.writeScreen.setPen(r)};r.prototype.outputDataUpdate=function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var r=ei.time;if(r===null){return}if(this.outputFilter){if(this.cueStartTime===null&&!this.displayedMemory.isEmpty()){this.cueStartTime=r}else{if(!this.displayedMemory.equals(this.lastOutputScreen)){if(this.outputFilter.newCue){this.outputFilter.newCue(this.cueStartTime,r,this.lastOutputScreen);if(t===true&&this.outputFilter.dispatchCue){this.outputFilter.dispatchCue()}}this.cueStartTime=this.displayedMemory.isEmpty()?null:r}}this.lastOutputScreen.copy(this.displayedMemory)}};r.prototype.cueSplitAtTime=function e(t){if(this.outputFilter){if(!this.displayedMemory.isEmpty()){if(this.outputFilter.newCue){this.outputFilter.newCue(this.cueStartTime,t,this.displayedMemory)}this.cueStartTime=t}}};return r}();var oi=function(){function i(e,t,r){Vr(this,i);this.field=e||1;this.outputs=[t,r];this.channels=[new si(1,t),new si(2,r)];this.currChNr=-1;this.lastCmdA=null;this.lastCmdB=null;this.bufferedData=[];this.startTime=null;this.lastTime=null;this.dataCounters={padding:0,char:0,cmd:0,other:0}}i.prototype.getHandler=function e(t){return this.channels[t].getHandler()};i.prototype.setHandler=function e(t,r){this.channels[t].setHandler(r)};i.prototype.addData=function e(t,r){var i=void 0,a=void 0,n=void 0,s=false;this.lastTime=t;ei.setTime(t);for(var o=0;o<r.length;o+=2){a=r[o]&127;n=r[o+1]&127;if(a===0&&n===0){this.dataCounters.padding+=2;continue}else{ei.log("DATA","["+ti([r[o],r[o+1]])+"] -> ("+ti([a,n])+")")}i=this.parseCmd(a,n);if(!i){i=this.parseMidrow(a,n)}if(!i){i=this.parsePAC(a,n)}if(!i){i=this.parseBackgroundAttributes(a,n)}if(!i){s=this.parseChars(a,n);if(s){if(this.currChNr&&this.currChNr>=0){var l=this.channels[this.currChNr-1];l.insertChars(s)}else{ei.log("WARNING","No channel found yet. TEXT-MODE?")}}}if(i){this.dataCounters.cmd+=2}else if(s){this.dataCounters.char+=2}else{this.dataCounters.other+=2;ei.log("WARNING","Couldn't parse cleaned data "+ti([a,n])+" orig: "+ti([r[o],r[o+1]]))}}};i.prototype.parseCmd=function e(t,r){var i=null;var a=(t===20||t===28)&&r>=32&&r<=47;var n=(t===23||t===31)&&r>=33&&r<=35;if(!(a||n)){return false}if(t===this.lastCmdA&&r===this.lastCmdB){this.lastCmdA=null;this.lastCmdB=null;ei.log("DEBUG","Repeated command ("+ti([t,r])+") is dropped");return true}if(t===20||t===23){i=1}else{i=2}var s=this.channels[i-1];if(t===20||t===28){if(r===32){s.ccRCL()}else if(r===33){s.ccBS()}else if(r===34){s.ccAOF()}else if(r===35){s.ccAON()}else if(r===36){s.ccDER()}else if(r===37){s.ccRU(2)}else if(r===38){s.ccRU(3)}else if(r===39){s.ccRU(4)}else if(r===40){s.ccFON()}else if(r===41){s.ccRDC()}else if(r===42){s.ccTR()}else if(r===43){s.ccRTD()}else if(r===44){s.ccEDM()}else if(r===45){s.ccCR()}else if(r===46){s.ccENM()}else if(r===47){s.ccEOC()}}else{s.ccTO(r-32)}this.lastCmdA=t;this.lastCmdB=r;this.currChNr=i;return true};i.prototype.parseMidrow=function e(t,r){var i=null;if((t===17||t===25)&&r>=32&&r<=47){if(t===17){i=1}else{i=2}if(i!==this.currChNr){ei.log("ERROR","Mismatch channel in midrow parsing");return false}var a=this.channels[i-1];a.ccMIDROW(r);ei.log("DEBUG","MIDROW ("+ti([t,r])+")");return true}return false};i.prototype.parsePAC=function e(t,r){var i=null;var a=null;var n=(t>=17&&t<=23||t>=25&&t<=31)&&r>=64&&r<=127;var s=(t===16||t===24)&&r>=64&&r<=95;if(!(n||s)){return false}if(t===this.lastCmdA&&r===this.lastCmdB){this.lastCmdA=null;this.lastCmdB=null;return true}i=t<=23?1:2;if(r>=64&&r<=95){a=i===1?Xr[t]:$r[t]}else{a=i===1?Qr[t]:Jr[t]}var o=this.interpretPAC(a,r);var l=this.channels[i-1];l.setPAC(o);this.lastCmdA=t;this.lastCmdB=r;this.currChNr=i;return true};i.prototype.interpretPAC=function e(t,r){var i=r;var a={color:null,italics:false,indent:null,underline:false,row:t};if(r>95){i=r-96}else{i=r-64}a.underline=(i&1)===1;if(i<=13){a.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(i/2)]}else if(i<=15){a.italics=true;a.color="white"}else{a.indent=Math.floor((i-16)/2)*4}return a};i.prototype.parseChars=function e(t,r){var i=null,a=null,n=null;if(t>=25){i=2;n=t-8}else{i=1;n=t}if(n>=17&&n<=19){var s=r;if(n===17){s=r+80}else if(n===18){s=r+112}else{s=r+144}ei.log("INFO","Special char '"+Yr(s)+"' in channel "+i);a=[s]}else if(t>=32&&t<=127){a=r===0?[t]:[t,r]}if(a){var o=ti(a);ei.log("DEBUG","Char codes =  "+o.join(","));this.lastCmdA=null;this.lastCmdB=null}return a};i.prototype.parseBackgroundAttributes=function e(t,r){var i=void 0,a=void 0,n=void 0,s=void 0;var o=(t===16||t===24)&&r>=32&&r<=47;var l=(t===23||t===31)&&r>=45&&r<=47;if(!(o||l)){return false}i={};if(t===16||t===24){a=Math.floor((r-32)/2);i.background=Zr[a];if(r%2===1){i.background=i.background+"_semi"}}else if(r===45){i.background="transparent"}else{i.foreground="black";if(r===47){i.underline=true}}n=t<24?1:2;s=this.channels[n-1];s.setBkgData(i);this.lastCmdA=null;this.lastCmdB=null;return true};i.prototype.reset=function e(){for(var t=0;t<this.channels.length;t++){if(this.channels[t]){this.channels[t].reset()}}this.lastCmdA=null;this.lastCmdB=null};i.prototype.cueSplitAtTime=function e(t){for(var r=0;r<this.channels.length;r++){if(this.channels[r]){this.channels[r].cueSplitAtTime(t)}}};return i}();var li=oi;function ui(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var fi=function(){function r(e,t){ui(this,r);this.timelineController=e;this.trackName=t;this.startTime=null;this.endTime=null;this.screen=null}r.prototype.dispatchCue=function e(){if(this.startTime===null){return}this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen);this.startTime=null};r.prototype.newCue=function e(t,r,i){if(this.startTime===null||this.startTime>t){this.startTime=t}this.endTime=r;this.screen=i;this.timelineController.createCaptionsTrack(this.trackName)};return r}();var ci=fi;var di=function e(t,r,i){return t.substr(i||0,r.length)===r};var hi=function e(t){var r=parseInt(t.substr(-3));var i=parseInt(t.substr(-6,2));var a=parseInt(t.substr(-9,2));var n=t.length>9?parseInt(t.substr(0,t.indexOf(":"))):0;if(!Object(x["a"])(r)||!Object(x["a"])(i)||!Object(x["a"])(a)||!Object(x["a"])(n)){return-1}r+=1e3*i;r+=60*1e3*a;r+=60*60*1e3*n;return r};var pi=function e(t){var e=5381;var r=t.length;while(r){e=e*33^t.charCodeAt(--r)}return(e>>>0).toString()};var vi=function e(t,r,i){var a=t[r];var n=t[a.prevCC];if(!n||!n.new&&a.new){t.ccOffset=t.presentationOffset=a.start;a.new=false;return}while(n&&n.new){t.ccOffset+=a.start-n.start;a.new=false;a=n;n=t[a.prevCC]}t.presentationOffset=i};var yi={parse:function e(t,r,i,a,n,s){var o=/\r\n|\n\r|\n|\r/g;var l=Object(wt["b"])(new Uint8Array(t)).trim().replace(o,"\n").split("\n");var u="00:00.000";var f=0;var c=0;var d=0;var h=[];var p=void 0;var v=true;var y=new Kr;y.oncue=function(e){var t=i[a];var r=i.ccOffset;if(t&&t.new){if(c!==undefined){r=i.ccOffset=t.start}else{vi(i,a,d)}}if(d){r=d+i.ccOffset-i.presentationOffset}e.startTime+=r-c;e.endTime+=r-c;e.id=pi(e.startTime.toString())+pi(e.endTime.toString())+pi(e.text);e.text=decodeURIComponent(encodeURIComponent(e.text));if(e.endTime>0){h.push(e)}};y.onparsingerror=function(e){p=e};y.onflush=function(){if(p&&s){s(p);return}n(h)};l.forEach(function(t){if(v){if(di(t,"X-TIMESTAMP-MAP=")){v=false;t.substr(16).split(",").forEach(function(e){if(di(e,"LOCAL:")){u=e.substr(6)}else if(di(e,"MPEGTS:")){f=parseInt(e.substr(7))}});try{r=r<0?r+8589934592:r;f-=r;c=hi(u)/1e3;d=f/9e4;if(c===-1){p=new Error("Malformed X-TIMESTAMP-MAP: "+t)}}catch(e){p=new Error("Malformed X-TIMESTAMP-MAP: "+t)}return}else if(t===""){v=false}}y.parse(t+"\n")});y.flush()}};var gi=yi;function mi(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function bi(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function Ei(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}function Ti(e,t){return e&&e.label===t.name&&!(e.textTrack1||e.textTrack2)}function Si(e,t,r,i){return Math.min(t,i)-Math.max(e,r)}var wi=function(a){Ei(n,a);function n(e){mi(this,n);var t=bi(this,a.call(this,e,M["a"].MEDIA_ATTACHING,M["a"].MEDIA_DETACHING,M["a"].FRAG_PARSING_USERDATA,M["a"].FRAG_DECRYPTED,M["a"].MANIFEST_LOADING,M["a"].MANIFEST_LOADED,M["a"].FRAG_LOADED,M["a"].LEVEL_SWITCHING,M["a"].INIT_PTS_FOUND));t.hls=e;t.config=e.config;t.enabled=true;t.Cues=e.config.cueHandler;t.textTracks=[];t.tracks=[];t.unparsedVttFrags=[];t.initPTS=undefined;t.cueRanges=[];t.captionsTracks={};t.captionsProperties={textTrack1:{label:t.config.captionsTextTrack1Label,languageCode:t.config.captionsTextTrack1LanguageCode},textTrack2:{label:t.config.captionsTextTrack2Label,languageCode:t.config.captionsTextTrack2LanguageCode}};if(t.config.enableCEA708Captions){var r=new ci(t,"textTrack1");var i=new ci(t,"textTrack2");t.cea608Parser=new li(0,r,i)}return t}n.prototype.addCues=function e(t,r,i,a){var n=this.cueRanges;var s=false;for(var o=n.length;o--;){var l=n[o];var u=Si(l[0],l[1],r,i);if(u>=0){l[0]=Math.min(l[0],r);l[1]=Math.max(l[1],i);s=true;if(u/(i-r)>.5){return}}}if(!s){n.push([r,i])}this.Cues.newCue(this.captionsTracks[t],r,i,a)};n.prototype.onInitPtsFound=function e(t){var r=this;if(typeof this.initPTS==="undefined"){this.initPTS=t.initPTS}if(this.unparsedVttFrags.length){this.unparsedVttFrags.forEach(function(e){r.onFragLoaded(e)});this.unparsedVttFrags=[]}};n.prototype.getExistingTrack=function e(t){var r=this.media;if(r){for(var i=0;i<r.textTracks.length;i++){var a=r.textTracks[i];if(a[t]){return a}}}return null};n.prototype.createCaptionsTrack=function e(t){var r=this.captionsProperties[t],i=r.label,a=r.languageCode;var n=this.captionsTracks;if(!n[t]){var s=this.getExistingTrack(t);if(!s){var o=this.createTextTrack("captions",i,a);if(o){o[t]=true;n[t]=o}}else{n[t]=s;_t(n[t]);At(n[t],this.media)}}};n.prototype.createTextTrack=function e(t,r,i){var a=this.media;if(a){return a.addTextTrack(t,r,i)}};n.prototype.destroy=function e(){f.prototype.destroy.call(this)};n.prototype.onMediaAttaching=function e(t){this.media=t.media;this._cleanTracks()};n.prototype.onMediaDetaching=function e(){var t=this.captionsTracks;Object.keys(t).forEach(function(e){_t(t[e]);delete t[e]})};n.prototype.onManifestLoading=function e(){this.lastSn=-1;this.prevCC=-1;this.vttCCs={ccOffset:0,presentationOffset:0};this._cleanTracks()};n.prototype._cleanTracks=function e(){var t=this.media;if(t){var r=t.textTracks;if(r){for(var i=0;i<r.length;i++){_t(r[i])}}}};n.prototype.onManifestLoaded=function e(t){var a=this;this.textTracks=[];this.unparsedVttFrags=this.unparsedVttFrags||[];this.initPTS=undefined;this.cueRanges=[];if(this.config.enableWebVTT){this.tracks=t.subtitles||[];var n=this.media?this.media.textTracks:[];this.tracks.forEach(function(e,t){var r=void 0;if(t<n.length){var i=n[t];if(Ti(i,e)){r=i}}if(!r){r=a.createTextTrack("subtitles",e.name,e.lang)}if(e.default){r.mode=a.hls.subtitleDisplay?"showing":"hidden"}else{r.mode="disabled"}a.textTracks.push(r)})}};n.prototype.onLevelSwitching=function e(){this.enabled=this.hls.currentLevel.closedCaptions!=="NONE"};n.prototype.onFragLoaded=function e(t){var r=t.frag,i=t.payload;if(r.type==="main"){var a=r.sn;if(a!==this.lastSn+1){var n=this.cea608Parser;if(n){n.reset()}}this.lastSn=a}else if(r.type==="subtitle"){if(i.byteLength){if(typeof this.initPTS==="undefined"){this.unparsedVttFrags.push(t);return}var s=r.decryptdata;if(s==null||s.key==null||s.method!=="AES-128"){this._parseVTTs(r,i)}}else{this.hls.trigger(M["a"].SUBTITLE_FRAG_PROCESSED,{success:false,frag:r})}}};n.prototype._parseVTTs=function e(t,r){var i=this.vttCCs;if(!i[t.cc]){i[t.cc]={start:t.start,prevCC:this.prevCC,new:true};this.prevCC=t.cc}var a=this.textTracks,n=this.hls;gi.parse(r,this.initPTS,i,t.cc,function(e){var i=a[t.trackId];if(i.mode==="disabled"){n.trigger(M["a"].SUBTITLE_FRAG_PROCESSED,{success:false,frag:t});return}e.forEach(function(t){if(!i.cues.getCueById(t.id)){try{i.addCue(t)}catch(e){var r=new window.TextTrackCue(t.startTime,t.endTime,t.text);r.id=t.id;i.addCue(r)}}});n.trigger(M["a"].SUBTITLE_FRAG_PROCESSED,{success:true,frag:t})},function(e){F["b"].log("Failed to parse VTT cue: "+e);n.trigger(M["a"].SUBTITLE_FRAG_PROCESSED,{success:false,frag:t})})};n.prototype.onFragDecrypted=function e(t){var r=t.payload,i=t.frag;if(i.type==="subtitle"){if(typeof this.initPTS==="undefined"){this.unparsedVttFrags.push(t);return}this._parseVTTs(i,r)}};n.prototype.onFragParsingUserdata=function e(t){if(this.enabled&&this.config.enableCEA708Captions){for(var r=0;r<t.samples.length;r++){var i=this.extractCea608Data(t.samples[r].bytes);this.cea608Parser.addData(t.samples[r].pts,i)}}};n.prototype.extractCea608Data=function e(t){var r=t[0]&31;var i=2;var a=void 0,n=void 0,s=void 0,o=void 0,l=void 0;var u=[];for(var f=0;f<r;f++){a=t[i++];n=127&t[i++];s=127&t[i++];o=(4&a)!==0;l=3&a;if(n===0&&s===0){continue}if(o){if(l===0){u.push(n);u.push(s)}}}return u};return n}(f);var Ai=wi;var _i=function(){function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}return function(e,t,r){if(t)i(e.prototype,t);if(r)i(e,r);return e}}();function Ri(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function Li(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function ki(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}function Di(e){var t=[];for(var r=0;r<e.length;r++){if(e[r].kind==="subtitles"){t.push(e[r])}}return t}var Ii=function(r){ki(i,r);function i(e){Ri(this,i);var t=Li(this,r.call(this,e,M["a"].MEDIA_ATTACHED,M["a"].MEDIA_DETACHING,M["a"].MANIFEST_LOADING,M["a"].MANIFEST_LOADED,M["a"].SUBTITLE_TRACK_LOADED));t.tracks=[];t.trackId=-1;t.media=null;t.subtitleDisplay=true;return t}i.prototype._onTextTracksChanged=function e(){if(!this.media){return}var t=-1;var r=Di(this.media.textTracks);for(var i=0;i<r.length;i++){if(r[i].mode==="hidden"){t=i}else if(r[i].mode==="showing"){t=i;break}}this.subtitleTrack=t};i.prototype.destroy=function e(){f.prototype.destroy.call(this)};i.prototype.onMediaAttached=function e(t){var r=this;this.media=t.media;if(!this.media){return}if(this.queuedDefaultTrack){this.subtitleTrack=this.queuedDefaultTrack;delete this.queuedDefaultTrack}this.trackChangeListener=this._onTextTracksChanged.bind(this);this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks);if(this.useTextTrackPolling){this.subtitlePollingInterval=setInterval(function(){r.trackChangeListener()},500)}else{this.media.textTracks.addEventListener("change",this.trackChangeListener)}};i.prototype.onMediaDetaching=function e(){if(!this.media){return}if(this.useTextTrackPolling){clearInterval(this.subtitlePollingInterval)}else{this.media.textTracks.removeEventListener("change",this.trackChangeListener)}this.media=null};i.prototype.onManifestLoading=function e(){this.tracks=[];this.trackId=-1};i.prototype.onManifestLoaded=function e(t){var r=this;var i=t.subtitles||[];this.tracks=i;this.trackId=-1;this.hls.trigger(M["a"].SUBTITLE_TRACKS_UPDATED,{subtitleTracks:i});i.forEach(function(e){if(e.default){if(r.media){r.subtitleTrack=e.id}else{r.queuedDefaultTrack=e.id}}})};i.prototype.onTick=function e(){var t=this.trackId;var r=this.tracks[t];if(!r){return}var i=r.details;if(!i||i.live){F["b"].log("(re)loading playlist for subtitle track "+t);this.hls.trigger(M["a"].SUBTITLE_TRACK_LOADING,{url:r.url,id:t})}};i.prototype.onSubtitleTrackLoaded=function e(t){var r=this;if(t.id<this.tracks.length){F["b"].log("subtitle track "+t.id+" loaded");this.tracks[t.id].details=t.details;if(t.details.live&&!this.timer){this.timer=setInterval(function(){r.onTick()},1e3*t.details.targetduration,this)}if(!t.details.live&&this.timer){this._stopTimer()}}};i.prototype.setSubtitleTrackInternal=function e(t){var r=this.hls,i=this.tracks;if(typeof t!=="number"||t<-1||t>=i.length){return}this._stopTimer();this.trackId=t;F["b"].log("switching to subtitle track "+t);r.trigger(M["a"].SUBTITLE_TRACK_SWITCH,{id:t});if(t===-1){return}var a=i[t];var n=a.details;if(!n||n.live){F["b"].log("(re)loading playlist for subtitle track "+t);r.trigger(M["a"].SUBTITLE_TRACK_LOADING,{url:a.url,id:t})}};i.prototype._stopTimer=function e(){if(this.timer){clearInterval(this.timer);this.timer=null}};i.prototype._toggleTrackModes=function e(t){var r=this.media,i=this.subtitleDisplay,a=this.trackId;if(!r){return}var n=Di(r.textTracks);if(t===-1){[].slice.call(n).forEach(function(e){e.mode="disabled"})}else{var s=n[a];if(s){s.mode="disabled"}}var o=n[t];if(o){o.mode=i?"showing":"hidden"}};_i(i,[{key:"subtitleTracks",get:function e(){return this.tracks}},{key:"subtitleTrack",get:function e(){return this.trackId},set:function e(t){if(this.trackId!==t){this._toggleTrackModes(t);this.setSubtitleTrackInternal(t)}}}]);return i}(f);var Oi=Ii;var Pi=r(8);function Ci(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function xi(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function Mi(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var Fi=window,Ni=Fi.performance;var Ui={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING"};var Bi=function(r){Mi(i,r);function i(e){Ci(this,i);var t=xi(this,r.call(this,e,M["a"].MEDIA_ATTACHED,M["a"].ERROR,M["a"].KEY_LOADED,M["a"].FRAG_LOADED,M["a"].SUBTITLE_TRACKS_UPDATED,M["a"].SUBTITLE_TRACK_SWITCH,M["a"].SUBTITLE_TRACK_LOADED,M["a"].SUBTITLE_FRAG_PROCESSED));t.config=e.config;t.vttFragSNsProcessed={};t.vttFragQueues=undefined;t.currentlyProcessing=null;t.state=Ui.STOPPED;t.currentTrackId=-1;t.decrypter=new Pi["a"](e.observer,e.config);return t}i.prototype.onHandlerDestroyed=function e(){this.state=Ui.STOPPED};i.prototype.clearVttFragQueues=function e(){var t=this;this.vttFragQueues={};this.tracks.forEach(function(e){t.vttFragQueues[e.id]=[]})};i.prototype.nextFrag=function e(){if(this.currentlyProcessing===null&&this.currentTrackId>-1&&this.vttFragQueues[this.currentTrackId].length){var t=this.currentlyProcessing=this.vttFragQueues[this.currentTrackId].shift();this.fragCurrent=t;this.hls.trigger(M["a"].FRAG_LOADING,{frag:t});this.state=Ui.FRAG_LOADING}};i.prototype.onSubtitleFragProcessed=function e(t){if(t.success){this.vttFragSNsProcessed[t.frag.trackId].push(t.frag.sn)}this.currentlyProcessing=null;this.state=Ui.IDLE;this.nextFrag()};i.prototype.onMediaAttached=function e(){this.state=Ui.IDLE};i.prototype.onError=function e(t){var r=t.frag;if(r&&r.type!=="subtitle"){return}if(this.currentlyProcessing){this.currentlyProcessing=null;this.nextFrag()}};i.prototype.doTick=function e(){var t=this;switch(this.state){case Ui.IDLE:var r=this.tracks;var i=this.currentTrackId;var a=this.vttFragSNsProcessed[i],n=this.vttFragQueues[i],s=this.currentlyProcessing?this.currentlyProcessing.sn:-1;var o=function e(t){return a.indexOf(t.sn)>-1};var l=function e(t){return n.some(function(e){return e.sn===t.sn})};if(!r){break}var u;if(i<r.length){u=r[i].details}if(typeof u==="undefined"){break}u.fragments.forEach(function(e){if(!(o(e)||e.sn===s||l(e))){if(e.encrypted){F["b"].log("Loading key for "+e.sn);t.state=Ui.KEY_LOADING;t.hls.trigger(M["a"].KEY_LOADING,{frag:e})}else{e.trackId=i;n.push(e);t.nextFrag()}}})}};i.prototype.onSubtitleTracksUpdated=function e(t){var r=this;F["b"].log("subtitle tracks updated");this.tracks=t.subtitleTracks;this.clearVttFragQueues();this.vttFragSNsProcessed={};this.tracks.forEach(function(e){r.vttFragSNsProcessed[e.id]=[]})};i.prototype.onSubtitleTrackSwitch=function e(t){this.currentTrackId=t.id;if(!this.tracks||this.currentTrackId===-1){return}var r=this.tracks[this.currentTrackId];if(r&&r.details){this.tick()}};i.prototype.onSubtitleTrackLoaded=function e(){this.tick()};i.prototype.onKeyLoaded=function e(){if(this.state===Ui.KEY_LOADING){this.state=Ui.IDLE;this.tick()}};i.prototype.onFragLoaded=function e(t){var r=this.fragCurrent,i=t.frag.decryptdata;var a=t.frag,n=this.hls;if(this.state===Ui.FRAG_LOADING&&r&&t.frag.type==="subtitle"&&r.sn===t.frag.sn){if(t.payload.byteLength>0&&i!=null&&i.key!=null&&i.method==="AES-128"){var s=void 0;try{s=Ni.now()}catch(e){s=Date.now()}this.decrypter.decrypt(t.payload,i.key.buffer,i.iv.buffer,function(e){var t=void 0;try{t=Ni.now()}catch(e){t=Date.now()}n.trigger(M["a"].FRAG_DECRYPTED,{frag:a,payload:e,stats:{tstart:s,tdecrypt:t}})})}}};return i}($e);var Gi=Bi;var ji=function(){function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}return function(e,t,r){if(t)i(e.prototype,t);if(r)i(e,r);return e}}();function Ki(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function Hi(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function Vi(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var qi=window,Yi=qi.XMLHttpRequest;var Wi=3;var zi={WIDEVINE:"com.widevine.alpha",PLAYREADY:"com.microsoft.playready"};var Xi=function e(t,r,i){var a={videoCapabilities:[]};r.forEach(function(e){a.videoCapabilities.push({contentType:'video/mp4; codecs="'+e+'"'})});return[a]};var Qi=function e(t,r,i){switch(t){case zi.WIDEVINE:return Xi(r,i);default:throw Error("Unknown key-system: "+t)}};var $i=function(r){Vi(i,r);function i(e){Ki(this,i);var t=Hi(this,r.call(this,e,M["a"].MEDIA_ATTACHED,M["a"].MANIFEST_PARSED));t._widevineLicenseUrl=e.config.widevineLicenseUrl;t._licenseXhrSetup=e.config.licenseXhrSetup;t._emeEnabled=e.config.emeEnabled;t._requestMediaKeySystemAccess=e.config.requestMediaKeySystemAccessFunc;t._mediaKeysList=[];t._media=null;t._hasSetMediaKeys=false;t._isMediaEncrypted=false;t._requestLicenseFailureCount=0;return t}i.prototype.getLicenseServerUrl=function e(t){var r=void 0;switch(t){case zi.WIDEVINE:r=this._widevineLicenseUrl;break;default:r=null;break}if(!r){F["b"].error('No license server URL configured for key-system "'+t+'"');this.hls.trigger(M["a"].ERROR,{type:h["b"].KEY_SYSTEM_ERROR,details:h["a"].KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:true})}return r};i.prototype._attemptKeySystemAccess=function e(t,r,i){var a=this;var n=Qi(t,r,i);if(!n){F["b"].warn("Can not create config for key-system (maybe because platform is not supported):",t);return}F["b"].log("Requesting encrypted media key-system access");this.requestMediaKeySystemAccess(t,n).then(function(e){a._onMediaKeySystemAccessObtained(t,e)}).catch(function(e){F["b"].error('Failed to obtain key-system "'+t+'" access:',e)})};i.prototype._onMediaKeySystemAccessObtained=function e(t,r){var i=this;F["b"].log('Access for key-system "'+t+'" obtained');var a={mediaKeys:null,mediaKeysSession:null,mediaKeysSessionInitialized:false,mediaKeySystemAccess:r,mediaKeySystemDomain:t};this._mediaKeysList.push(a);r.createMediaKeys().then(function(e){a.mediaKeys=e;F["b"].log('Media-keys created for key-system "'+t+'"');i._onMediaKeysCreated()}).catch(function(e){F["b"].error("Failed to create media-keys:",e)})};i.prototype._onMediaKeysCreated=function e(){var t=this;this._mediaKeysList.forEach(function(e){if(!e.mediaKeysSession){e.mediaKeysSession=e.mediaKeys.createSession();t._onNewMediaKeySession(e.mediaKeysSession)}})};i.prototype._onNewMediaKeySession=function e(t){var r=this;F["b"].log("New key-system session "+t.sessionId);t.addEventListener("message",function(e){r._onKeySessionMessage(t,e.message)},false)};i.prototype._onKeySessionMessage=function e(t,r){F["b"].log("Got EME message event, creating license request");this._requestLicense(r,function(e){F["b"].log("Received license data, updating key-session");t.update(e)})};i.prototype._onMediaEncrypted=function e(t,r){F["b"].log('Media is encrypted using "'+t+'" init data type');this._isMediaEncrypted=true;this._mediaEncryptionInitDataType=t;this._mediaEncryptionInitData=r;this._attemptSetMediaKeys();this._generateRequestWithPreferredKeySession()};i.prototype._attemptSetMediaKeys=function e(){if(!this._hasSetMediaKeys){var t=this._mediaKeysList[0];if(!t||!t.mediaKeys){F["b"].error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet");this.hls.trigger(M["a"].ERROR,{type:h["b"].KEY_SYSTEM_ERROR,details:h["a"].KEY_SYSTEM_NO_KEYS,fatal:true});return}F["b"].log("Setting keys for encrypted media");this._media.setMediaKeys(t.mediaKeys);this._hasSetMediaKeys=true}};i.prototype._generateRequestWithPreferredKeySession=function e(){var t=this;var r=this._mediaKeysList[0];if(!r){F["b"].error("Fatal: Media is encrypted but not any key-system access has been obtained yet");this.hls.trigger(M["a"].ERROR,{type:h["b"].KEY_SYSTEM_ERROR,details:h["a"].KEY_SYSTEM_NO_ACCESS,fatal:true});return}if(r.mediaKeysSessionInitialized){F["b"].warn("Key-Session already initialized but requested again");return}var i=r.mediaKeysSession;if(!i){F["b"].error("Fatal: Media is encrypted but no key-session existing");this.hls.trigger(M["a"].ERROR,{type:h["b"].KEY_SYSTEM_ERROR,details:h["a"].KEY_SYSTEM_NO_SESSION,fatal:true})}var a=this._mediaEncryptionInitDataType;var n=this._mediaEncryptionInitData;F["b"].log('Generating key-session request for "'+a+'" init data type');r.mediaKeysSessionInitialized=true;i.generateRequest(a,n).then(function(){F["b"].debug("Key-session generation succeeded")}).catch(function(e){F["b"].error("Error generating key-session request:",e);t.hls.trigger(M["a"].ERROR,{type:h["b"].KEY_SYSTEM_ERROR,details:h["a"].KEY_SYSTEM_NO_SESSION,fatal:false})})};i.prototype._createLicenseXhr=function e(t,r,i){var a=new Yi;var n=this._licenseXhrSetup;try{if(n){try{n(a,t)}catch(e){a.open("POST",t,true);n(a,t)}}if(!a.readyState){a.open("POST",t,true)}}catch(e){F["b"].error("Error setting up key-system license XHR",e);this.hls.trigger(M["a"].ERROR,{type:h["b"].KEY_SYSTEM_ERROR,details:h["a"].KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:true});return}a.responseType="arraybuffer";a.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,a,t,r,i);return a};i.prototype._onLicenseRequestReadyStageChange=function e(t,r,i,a){switch(t.readyState){case 4:if(t.status===200){this._requestLicenseFailureCount=0;F["b"].log("License request succeeded");a(t.response)}else{F["b"].error("License Request XHR failed ("+r+"). Status: "+t.status+" ("+t.statusText+")");this._requestLicenseFailureCount++;if(this._requestLicenseFailureCount<=Wi){var n=Wi-this._requestLicenseFailureCount+1;F["b"].warn("Retrying license request, "+n+" attempts left");this._requestLicense(i,a);return}this.hls.trigger(M["a"].ERROR,{type:h["b"].KEY_SYSTEM_ERROR,details:h["a"].KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:true})}break}};i.prototype._generateLicenseRequestChallenge=function e(t,r){var i=void 0;if(t.mediaKeySystemDomain===zi.PLAYREADY){F["b"].error("PlayReady is not supported (yet)")}else if(t.mediaKeySystemDomain===zi.WIDEVINE){i=r}else{F["b"].error("Unsupported key-system:",t.mediaKeySystemDomain)}return i};i.prototype._requestLicense=function e(t,r){F["b"].log("Requesting content license for key-system");var i=this._mediaKeysList[0];if(!i){F["b"].error("Fatal error: Media is encrypted but no key-system access has been obtained yet");this.hls.trigger(M["a"].ERROR,{type:h["b"].KEY_SYSTEM_ERROR,details:h["a"].KEY_SYSTEM_NO_ACCESS,fatal:true});return}var a=this.getLicenseServerUrl(i.mediaKeySystemDomain);var n=this._createLicenseXhr(a,t,r);F["b"].log("Sending license request to URL: "+a);n.send(this._generateLicenseRequestChallenge(i,t))};i.prototype.onMediaAttached=function e(t){var r=this;if(!this._emeEnabled){return}var i=t.media;this._media=i;i.addEventListener("encrypted",function(e){r._onMediaEncrypted(e.initDataType,e.initData)})};i.prototype.onManifestParsed=function e(t){if(!this._emeEnabled){return}var r=t.levels.map(function(e){return e.audioCodec});var i=t.levels.map(function(e){return e.videoCodec});this._attemptKeySystemAccess(zi.WIDEVINE,r,i)};ji(i,[{key:"requestMediaKeySystemAccess",get:function e(){if(!this._requestMediaKeySystemAccess){throw new Error("No requestMediaKeySystemAccess function configured")}return this._requestMediaKeySystemAccess}}]);return i}(f);var Ji=$i;var Zi=function(){if(typeof window!=="undefined"&&window.navigator&&window.navigator.requestMediaKeySystemAccess){return window.navigator.requestMediaKeySystemAccess.bind(window.navigator)}else{return null}}();var ea={autoStartLoad:true,startPosition:-1,defaultAudioCodec:undefined,debug:false,capLevelOnFPSDrop:false,capLevelToPlayerSize:false,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:60*1e3*1e3,maxBufferHole:.5,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:Infinity,liveSyncDuration:undefined,liveMaxLatencyDuration:undefined,liveDurationInfinity:false,maxMaxBufferLength:600,enableWorker:true,enableSoftwareAES:true,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:undefined,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:false,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:yr,fLoader:undefined,pLoader:undefined,xhrSetup:undefined,licenseXhrSetup:undefined,abrController:qt,bufferController:$t,capLevelController:ir,fpsController:fr,stretchShortVideoTrack:false,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:true,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:false,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:false,widevineLicenseUrl:undefined,requestMediaKeySystemAccessFunc:Zi};if(true){ea.subtitleStreamController=Gi;ea.subtitleTrackController=Oi;ea.timelineController=Ai;ea.cueHandler=i;ea.enableCEA708Captions=true;ea.enableWebVTT=true;ea.captionsTextTrack1Label="English";ea.captionsTextTrack1LanguageCode="en";ea.captionsTextTrack2Label="Spanish";ea.captionsTextTrack2LanguageCode="es"}if(true){ea.audioStreamController=Or;ea.audioTrackController=Sr}if(true){ea.emeController=Ji}var ta=function(){function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}return function(e,t,r){if(t)i(e.prototype,t);if(r)i(e,r);return e}}();function ra(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}r(14);var ia=function(){S.isSupported=function e(){return Ot()};ta(S,null,[{key:"version",get:function e(){return"0.11.0"}},{key:"Events",get:function e(){return M["a"]}},{key:"ErrorTypes",get:function e(){return h["b"]}},{key:"ErrorDetails",get:function e(){return h["a"]}},{key:"DefaultConfig",get:function e(){if(!S.defaultConfig){return ea}return S.defaultConfig},set:function e(t){S.defaultConfig=t}}]);function S(){var t=this;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};ra(this,S);var r=S.DefaultConfig;if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration)){throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration")}for(var i in r){if(i in e)continue;e[i]=r[i]}if(e.liveMaxLatencyDurationCount!==undefined&&e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount){throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"')}if(e.liveMaxLatencyDuration!==undefined&&(e.liveMaxLatencyDuration<=e.liveSyncDuration||e.liveSyncDuration===undefined)){throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"')}Object(F["a"])(e.debug);this.config=e;this._autoLevelCapping=-1;var n=this.observer=new Se.a;n.trigger=function e(t){for(var r=arguments.length,i=Array(r>1?r-1:0),a=1;a<r;a++){i[a-1]=arguments[a]}n.emit.apply(n,[t,t].concat(i))};n.off=function e(t){for(var r=arguments.length,i=Array(r>1?r-1:0),a=1;a<r;a++){i[a-1]=arguments[a]}n.removeListener.apply(n,[t].concat(i))};this.on=n.on.bind(n);this.off=n.off.bind(n);this.once=n.once.bind(n);this.trigger=n.trigger.bind(n);var a=this.abrController=new e.abrController(this);var s=new e.bufferController(this);var o=new e.capLevelController(this);var l=new e.fpsController(this);var u=new te(this);var f=new se(this);var c=new ce(this);var d=new It(this);var h=this.levelController=new St(this);var p=new ye(this);var v=this.streamController=new ht(this,p);var y=[h,v];var g=e.audioStreamController;if(g){y.push(new g(this,p))}this.networkControllers=y;var m=[u,f,c,a,s,o,l,d,p];g=e.audioTrackController;if(g){var b=new g(this);this.audioTrackController=b;m.push(b)}g=e.subtitleTrackController;if(g){var E=new g(this);this.subtitleTrackController=E;m.push(E)}g=e.emeController;if(g){var T=new g(this);this.emeController=T;m.push(T)}[e.subtitleStreamController,e.timelineController].forEach(function(e){if(e){m.push(new e(t))}});this.coreComponents=m}S.prototype.destroy=function e(){F["b"].log("destroy");this.trigger(M["a"].DESTROYING);this.detachMedia();this.coreComponents.concat(this.networkControllers).forEach(function(e){e.destroy()});this.url=null;this.observer.removeAllListeners();this._autoLevelCapping=-1};S.prototype.attachMedia=function e(t){F["b"].log("attachMedia");this.media=t;this.trigger(M["a"].MEDIA_ATTACHING,{media:t})};S.prototype.detachMedia=function e(){F["b"].log("detachMedia");this.trigger(M["a"].MEDIA_DETACHING);this.media=null};S.prototype.loadSource=function e(t){t=n.a.buildAbsoluteURL(window.location.href,t,{alwaysNormalize:true});F["b"].log("loadSource:"+t);this.url=t;this.trigger(M["a"].MANIFEST_LOADING,{url:t})};S.prototype.startLoad=function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:-1;F["b"].log("startLoad("+t+")");this.networkControllers.forEach(function(e){e.startLoad(t)})};S.prototype.stopLoad=function e(){F["b"].log("stopLoad");this.networkControllers.forEach(function(e){e.stopLoad()})};S.prototype.swapAudioCodec=function e(){F["b"].log("swapAudioCodec");this.streamController.swapAudioCodec()};S.prototype.recoverMediaError=function e(){F["b"].log("recoverMediaError");var t=this.media;this.detachMedia();this.attachMedia(t)};ta(S,[{key:"levels",get:function e(){return this.levelController.levels}},{key:"currentLevel",get:function e(){return this.streamController.currentLevel},set:function e(t){F["b"].log("set currentLevel:"+t);this.loadLevel=t;this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function e(){return this.streamController.nextLevel},set:function e(t){F["b"].log("set nextLevel:"+t);this.levelController.manualLevel=t;this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function e(){return this.levelController.level},set:function e(t){F["b"].log("set loadLevel:"+t);this.levelController.manualLevel=t}},{key:"nextLoadLevel",get:function e(){return this.levelController.nextLoadLevel},set:function e(t){this.levelController.nextLoadLevel=t}},{key:"firstLevel",get:function e(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function e(t){F["b"].log("set firstLevel:"+t);this.levelController.firstLevel=t}},{key:"startLevel",get:function e(){return this.levelController.startLevel},set:function e(t){F["b"].log("set startLevel:"+t);var r=this;if(t!==-1){t=Math.max(t,r.minAutoLevel)}r.levelController.startLevel=t}},{key:"autoLevelCapping",get:function e(){return this._autoLevelCapping},set:function e(t){F["b"].log("set autoLevelCapping:"+t);this._autoLevelCapping=t}},{key:"autoLevelEnabled",get:function e(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function e(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function e(){var t=this,r=t.levels,i=t.config.minAutoBitrate,a=r?r.length:0;for(var n=0;n<a;n++){var s=r[n].realBitrate?Math.max(r[n].realBitrate,r[n].bitrate):r[n].bitrate;if(s>i){return n}}return 0}},{key:"maxAutoLevel",get:function e(){var t=this;var r=t.levels;var i=t.autoLevelCapping;var a=void 0;if(i===-1&&r&&r.length){a=r.length-1}else{a=i}return a}},{key:"nextAutoLevel",get:function e(){var t=this;return Math.min(Math.max(t.abrController.nextAutoLevel,t.minAutoLevel),t.maxAutoLevel)},set:function e(t){var r=this;r.abrController.nextAutoLevel=Math.max(r.minAutoLevel,t)}},{key:"audioTracks",get:function e(){var t=this.audioTrackController;return t?t.audioTracks:[]}},{key:"audioTrack",get:function e(){var t=this.audioTrackController;return t?t.audioTrack:-1},set:function e(t){var r=this.audioTrackController;if(r){r.audioTrack=t}}},{key:"liveSyncPosition",get:function e(){return this.streamController.liveSyncPosition}},{key:"subtitleTracks",get:function e(){var t=this.subtitleTrackController;return t?t.subtitleTracks:[]}},{key:"subtitleTrack",get:function e(){var t=this.subtitleTrackController;return t?t.subtitleTrack:-1},set:function e(t){var r=this.subtitleTrackController;if(r){r.subtitleTrack=t}}},{key:"subtitleDisplay",get:function e(){var t=this.subtitleTrackController;return t?t.subtitleDisplay:false},set:function e(t){var r=this.subtitleTrackController;if(r){r.subtitleDisplay=t}}}]);return S}();var aa=t["default"]=ia},function(e,t,u){function f(r){var i={};function a(e){if(i[e])return i[e].exports;var t=i[e]={i:e,l:false,exports:{}};r[e].call(t.exports,t,t.exports,a);t.l=true;return t.exports}a.m=r;a.c=i;a.i=function(e){return e};a.d=function(e,t,r){if(!a.o(e,t)){Object.defineProperty(e,t,{configurable:false,enumerable:true,get:r})}};a.n=function(t){var e=t&&t.__esModule?function e(){return t["default"]}:function e(){return t};a.d(e,"a",e);return e};a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};a.p="/";a.oe=function(e){console.error(e);throw e};var e=a(a.s=ENTRY_MODULE);return e.default||e}var c="[\\.|\\-|\\+|\\w|/|@]+";var d="\\((/\\*.*?\\*/)?s?.*?("+c+").*?\\)";function h(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function p(e,t,r){var i={};i[r]=[];var a=t.toString();var n=a.match(/^function\s?\(\w+,\s*\w+,\s*(\w+)\)/);if(!n)return i;var s=n[1];var o=new RegExp("(\\\\n|\\W)"+h(s)+d,"g");var l;while(l=o.exec(a)){if(l[3]==="dll-reference")continue;i[r].push(l[3])}o=new RegExp("\\("+h(s)+'\\("(dll-reference\\s('+c+'))"\\)\\)'+d,"g");while(l=o.exec(a)){if(!e[l[2]]){i[r].push(l[1]);e[l[2]]=u(l[1]).m}i[l[2]]=i[l[2]]||[];i[l[2]].push(l[4])}return i}function v(r){var e=Object.keys(r);return e.reduce(function(e,t){return e||r[t].length>0},false)}function y(e,t){var r={main:[t]};var i={main:[]};var a={main:{}};while(v(r)){var n=Object.keys(r);for(var s=0;s<n.length;s++){var o=n[s];var l=r[o];var u=l.pop();a[o]=a[o]||{};if(a[o][u]||!e[o][u])continue;a[o][u]=true;i[o]=i[o]||[];i[o].push(u);var f=p(e,e[o][u],o);var c=Object.keys(f);for(var d=0;d<c.length;d++){r[c[d]]=r[c[d]]||[];r[c[d]]=r[c[d]].concat(f[c[d]])}}}return i}e.exports=function(e,t){t=t||{};var r={main:u.m};var i=t.all?{main:Object.keys(r)}:y(r,e);var a="";Object.keys(i).filter(function(e){return e!=="main"}).forEach(function(t){var e=0;while(i[t][e]){e++}i[t].push(e);r[t][e]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })";a=a+"var "+t+" = ("+f.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+i[t].map(function(e){return""+JSON.stringify(e)+": "+r[t][e].toString()}).join(",")+"});\n"});a=a+"("+f.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+i.main.map(function(e){return""+JSON.stringify(e)+": "+r.main[e].toString()}).join(",")+"})(self);";var n=new window.Blob([a],{type:"text/javascript"});if(t.bare){return n}var s=window.URL||window.webkitURL||window.mozURL||window.msURL;var o=s.createObjectURL(n);var l=new window.Worker(o);l.objectURL=o;return l}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var s=r(10);var o=r(1);var l=r(0);var i=r(7);var u=r.n(i);var a=function e(a){var n=new u.a;n.trigger=function e(t){for(var r=arguments.length,i=Array(r>1?r-1:0),a=1;a<r;a++){i[a-1]=arguments[a]}n.emit.apply(n,[t,t].concat(i))};n.off=function e(t){for(var r=arguments.length,i=Array(r>1?r-1:0),a=1;a<r;a++){i[a-1]=arguments[a]}n.removeListener.apply(n,[t].concat(i))};var i=function e(t,r){a.postMessage({event:t,data:r})};a.addEventListener("message",function(e){var t=e.data;switch(t.cmd){case"init":var r=JSON.parse(t.config);a.demuxer=new s["a"](n,t.typeSupported,r,t.vendor);try{Object(l["a"])(r.debug===true)}catch(e){console.warn("demuxerWorker: unable to enable logs")}i("init",null);break;case"demux":a.demuxer.push(t.data,t.decryptdata,t.initSegment,t.audioCodec,t.videoCodec,t.timeOffset,t.discontinuity,t.trackSwitch,t.contiguous,t.duration,t.accurateTimeOffset,t.defaultInitPTS);break;default:break}});n.on(o["a"].FRAG_DECRYPTED,i);n.on(o["a"].FRAG_PARSING_INIT_SEGMENT,i);n.on(o["a"].FRAG_PARSED,i);n.on(o["a"].ERROR,i);n.on(o["a"].FRAG_PARSING_METADATA,i);n.on(o["a"].FRAG_PARSING_USERDATA,i);n.on(o["a"].INIT_PTS_FOUND,i);n.on(o["a"].FRAG_PARSING_DATA,function(e,t){var r=[];var i={event:e,data:t};if(t.data1){i.data1=t.data1.buffer;r.push(t.data1.buffer);delete t.data1}if(t.data2){i.data2=t.data2.buffer;r.push(t.data2.buffer);delete t.data2}a.postMessage(i,r)})};t["default"]=a},function(e,t){
/*! http://mths.be/endswith v0.2.0 by @mathias */
if(!String.prototype.endsWith){(function(){"use strict";var e=function(){try{var e={};var t=Object.defineProperty;var r=t(e,e,e)&&t}catch(e){}return r}();var f={}.toString;var t=function(e){if(this==null){throw TypeError()}var t=String(this);if(e&&f.call(e)=="[object RegExp]"){throw TypeError()}var r=t.length;var i=String(e);var a=i.length;var n=r;if(arguments.length>1){var s=arguments[1];if(s!==undefined){n=s?Number(s):0;if(n!=n){n=0}}}var o=Math.min(Math.max(n,0),r);var l=o-a;if(l<0){return false}var u=-1;while(++u<a){if(t.charCodeAt(l+u)!=i.charCodeAt(u)){return false}}return true};if(e){e(String.prototype,"endsWith",{value:t,configurable:true,writable:true})}else{String.prototype.endsWith=t}})()}}])["default"]})},function(i,e,t){
/*!
 * clipboard.js v2.0.4
 * https://zenorocha.github.io/clipboard.js
 * 
 * Licensed MIT © Zeno Rocha
 */
(function e(t,r){if(true)i.exports=r();else{}})(this,function(){return function(r){var i={};function a(e){if(i[e]){return i[e].exports}var t=i[e]={i:e,l:false,exports:{}};r[e].call(t.exports,t,t.exports,a);t.l=true;return t.exports}a.m=r;a.c=i;a.d=function(e,t,r){if(!a.o(e,t)){Object.defineProperty(e,t,{enumerable:true,get:r})}};a.r=function(e){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(e,"__esModule",{value:true})};a.t=function(t,e){if(e&1)t=a(t);if(e&8)return t;if(e&4&&typeof t==="object"&&t&&t.__esModule)return t;var r=Object.create(null);a.r(r);Object.defineProperty(r,"default",{enumerable:true,value:t});if(e&2&&typeof t!="string")for(var i in t)a.d(r,i,function(e){return t[e]}.bind(null,i));return r};a.n=function(t){var e=t&&t.__esModule?function e(){return t["default"]}:function e(){return t};a.d(e,"a",e);return e};a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};a.p="";return a(a.s=0)}([function(e,t,r){"use strict";var a=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var n=function(){function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}return function(e,t,r){if(t)i(e.prototype,t);if(r)i(e,r);return e}}();var i=r(1);var s=c(i);var o=r(3);var l=c(o);var u=r(4);var f=c(u);function c(e){return e&&e.__esModule?e:{default:e}}function d(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function h(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function p(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var v=function(e){p(i,e);function i(e,t){d(this,i);var r=h(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));r.resolveOptions(t);r.listenClick(e);return r}n(i,[{key:"resolveOptions",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.action=typeof t.action==="function"?t.action:this.defaultAction;this.target=typeof t.target==="function"?t.target:this.defaultTarget;this.text=typeof t.text==="function"?t.text:this.defaultText;this.container=a(t.container)==="object"?t.container:document.body}},{key:"listenClick",value:function e(t){var r=this;this.listener=(0,f.default)(t,"click",function(e){return r.onClick(e)})}},{key:"onClick",value:function e(t){var r=t.delegateTarget||t.currentTarget;if(this.clipboardAction){this.clipboardAction=null}this.clipboardAction=new s.default({action:this.action(r),target:this.target(r),text:this.text(r),container:this.container,trigger:r,emitter:this})}},{key:"defaultAction",value:function e(t){return y("action",t)}},{key:"defaultTarget",value:function e(t){var r=y("target",t);if(r){return document.querySelector(r)}}},{key:"defaultText",value:function e(t){return y("text",t)}},{key:"destroy",value:function e(){this.listener.destroy();if(this.clipboardAction){this.clipboardAction.destroy();this.clipboardAction=null}}}],[{key:"isSupported",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:["copy","cut"];var r=typeof t==="string"?[t]:t;var i=!!document.queryCommandSupported;r.forEach(function(e){i=i&&!!document.queryCommandSupported(e)});return i}}]);return i}(l.default);function y(e,t){var r="data-clipboard-"+e;if(!t.hasAttribute(r)){return}return t.getAttribute(r)}e.exports=v},function(e,t,r){"use strict";var i=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var a=function(){function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}return function(e,t,r){if(t)i(e.prototype,t);if(r)i(e,r);return e}}();var n=r(2);var s=o(n);function o(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var u=function(){function t(e){l(this,t);this.resolveOptions(e);this.initSelection()}a(t,[{key:"resolveOptions",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.action=t.action;this.container=t.container;this.emitter=t.emitter;this.target=t.target;this.text=t.text;this.trigger=t.trigger;this.selectedText=""}},{key:"initSelection",value:function e(){if(this.text){this.selectFake()}else if(this.target){this.selectTarget()}}},{key:"selectFake",value:function e(){var t=this;var r=document.documentElement.getAttribute("dir")=="rtl";this.removeFake();this.fakeHandlerCallback=function(){return t.removeFake()};this.fakeHandler=this.container.addEventListener("click",this.fakeHandlerCallback)||true;this.fakeElem=document.createElement("textarea");this.fakeElem.style.fontSize="12pt";this.fakeElem.style.border="0";this.fakeElem.style.padding="0";this.fakeElem.style.margin="0";this.fakeElem.style.position="absolute";this.fakeElem.style[r?"right":"left"]="-9999px";var i=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top=i+"px";this.fakeElem.setAttribute("readonly","");this.fakeElem.value=this.text;this.container.appendChild(this.fakeElem);this.selectedText=(0,s.default)(this.fakeElem);this.copyText()}},{key:"removeFake",value:function e(){if(this.fakeHandler){this.container.removeEventListener("click",this.fakeHandlerCallback);this.fakeHandler=null;this.fakeHandlerCallback=null}if(this.fakeElem){this.container.removeChild(this.fakeElem);this.fakeElem=null}}},{key:"selectTarget",value:function e(){this.selectedText=(0,s.default)(this.target);this.copyText()}},{key:"copyText",value:function e(){var t=void 0;try{t=document.execCommand(this.action)}catch(e){t=false}this.handleResult(t)}},{key:"handleResult",value:function e(t){this.emitter.emit(t?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function e(){if(this.trigger){this.trigger.focus()}window.getSelection().removeAllRanges()}},{key:"destroy",value:function e(){this.removeFake()}},{key:"action",set:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"copy";this._action=t;if(this._action!=="copy"&&this._action!=="cut"){throw new Error('Invalid "action" value, use either "copy" or "cut"')}},get:function e(){return this._action}},{key:"target",set:function e(t){if(t!==undefined){if(t&&(typeof t==="undefined"?"undefined":i(t))==="object"&&t.nodeType===1){if(this.action==="copy"&&t.hasAttribute("disabled")){throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute')}if(this.action==="cut"&&(t.hasAttribute("readonly")||t.hasAttribute("disabled"))){throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes')}this._target=t}else{throw new Error('Invalid "target" value, use a valid Element')}}},get:function e(){return this._target}}]);return t}();e.exports=u},function(e,t){function r(e){var t;if(e.nodeName==="SELECT"){e.focus();t=e.value}else if(e.nodeName==="INPUT"||e.nodeName==="TEXTAREA"){var r=e.hasAttribute("readonly");if(!r){e.setAttribute("readonly","")}e.select();e.setSelectionRange(0,e.value.length);if(!r){e.removeAttribute("readonly")}t=e.value}else{if(e.hasAttribute("contenteditable")){e.focus()}var i=window.getSelection();var a=document.createRange();a.selectNodeContents(e);i.removeAllRanges();i.addRange(a);t=i.toString()}return t}e.exports=r},function(e,t){function r(){}r.prototype={on:function(e,t,r){var i=this.e||(this.e={});(i[e]||(i[e]=[])).push({fn:t,ctx:r});return this},once:function(e,t,r){var i=this;function a(){i.off(e,a);t.apply(r,arguments)}a._=t;return this.on(e,a,r)},emit:function(e){var t=[].slice.call(arguments,1);var r=((this.e||(this.e={}))[e]||[]).slice();var i=0;var a=r.length;for(i;i<a;i++){r[i].fn.apply(r[i].ctx,t)}return this},off:function(e,t){var r=this.e||(this.e={});var i=r[e];var a=[];if(i&&t){for(var n=0,s=i.length;n<s;n++){if(i[n].fn!==t&&i[n].fn._!==t)a.push(i[n])}}a.length?r[e]=a:delete r[e];return this}};e.exports=r},function(e,t,r){var i=r(5);var a=r(6);function n(e,t,r){if(!e&&!t&&!r){throw new Error("Missing required arguments")}if(!i.string(t)){throw new TypeError("Second argument must be a String")}if(!i.fn(r)){throw new TypeError("Third argument must be a Function")}if(i.node(e)){return s(e,t,r)}else if(i.nodeList(e)){return o(e,t,r)}else if(i.string(e)){return l(e,t,r)}else{throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}}function s(e,t,r){e.addEventListener(t,r);return{destroy:function(){e.removeEventListener(t,r)}}}function o(e,t,r){Array.prototype.forEach.call(e,function(e){e.addEventListener(t,r)});return{destroy:function(){Array.prototype.forEach.call(e,function(e){e.removeEventListener(t,r)})}}}function l(e,t,r){return a(document.body,e,t,r)}e.exports=n},function(e,r){r.node=function(e){return e!==undefined&&e instanceof HTMLElement&&e.nodeType===1};r.nodeList=function(e){var t=Object.prototype.toString.call(e);return e!==undefined&&(t==="[object NodeList]"||t==="[object HTMLCollection]")&&"length"in e&&(e.length===0||r.node(e[0]))};r.string=function(e){return typeof e==="string"||e instanceof String};r.fn=function(e){var t=Object.prototype.toString.call(e);return t==="[object Function]"}},function(e,t,r){var a=r(7);function n(e,t,r,i,a){var n=s.apply(this,arguments);e.addEventListener(r,n,a);return{destroy:function(){e.removeEventListener(r,n,a)}}}function i(e,t,r,i,a){if(typeof e.addEventListener==="function"){return n.apply(null,arguments)}if(typeof r==="function"){return n.bind(null,document).apply(null,arguments)}if(typeof e==="string"){e=document.querySelectorAll(e)}return Array.prototype.map.call(e,function(e){return n(e,t,r,i,a)})}function s(t,r,e,i){return function(e){e.delegateTarget=a(e.target,r);if(e.delegateTarget){i.call(t,e)}}}e.exports=i},function(e,t){var r=9;if(typeof Element!=="undefined"&&!Element.prototype.matches){var i=Element.prototype;i.matches=i.matchesSelector||i.mozMatchesSelector||i.msMatchesSelector||i.oMatchesSelector||i.webkitMatchesSelector}function a(e,t){while(e&&e.nodeType!==r){if(typeof e.matches==="function"&&e.matches(t)){return e}e=e.parentNode}}e.exports=a}])})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var i={NativeDash:"dash",NativeHls:"hls",NativeFlv:"flv",HtmlMediaElement:"html5"};t.default=i},function(e,t){e.exports='<svg class="svg" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><defs><style></style></defs><path d="M878.066 125.957H145.9c-28.58 0-51.756 23.171-51.756 51.756v495.133c0 28.58 23.177 51.756 51.756 51.756h97.547v133.71c0 10.434 4.317 24.496 18.623 33.004 19.008 11.305 40.423 1.048 45.33-3.806l148.443-162.906h422.222c28.611 0 51.788-23.177 51.788-51.757V177.714c.001-28.58-23.176-51.756-51.787-51.756zm-13.588 535.705H421.404l-116.98 131.96v-131.96H158.66V186.968h705.82v474.694zM252.095 448.088H761.9c14.98 0 27.082-16.046 27.082-30.963 0-14.975-12.101-30.993-27.082-30.993H252.095c-14.918 0-27.055 16.014-27.055 30.993 0 14.919 12.135 30.963 27.055 30.963zm.975-125.875h509.81c14.975 0 27.081-16.05 27.081-30.999 0-14.946-12.106-30.018-27.082-30.018H253.07c-14.914 0-27.047 15.071-27.047 30.018 0 14.952 12.135 30.999 27.048 30.999zM604.356 511.03H253.07c-14.915 0-27.048 18-27.048 32.95 0 14.945 13.11 29.036 28.03 29.036h352.26c14.981 0 25.129-15.066 25.129-30.011-.002-14.952-12.108-31.975-27.084-31.975z"></path></svg>'},function(e,t){e.exports='<svg class="svg" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><defs><style></style></defs><path d="M213.333 896H42.667C17.067 896 0 878.933 0 853.333V682.667C0 657.067 17.067 640 42.667 640s42.666 17.067 42.666 42.667v128h128c25.6 0 42.667 17.066 42.667 42.666S238.933 896 213.333 896zM981.333 896H810.667c-25.6 0-42.667-17.067-42.667-42.667s17.067-42.666 42.667-42.666h128v-128c0-25.6 17.066-42.667 42.666-42.667S1024 657.067 1024 682.667v170.666c0 25.6-17.067 42.667-42.667 42.667zM981.333 384c-25.6 0-42.666-17.067-42.666-42.667v-128h-128c-25.6 0-42.667-17.066-42.667-42.666S785.067 128 810.667 128h170.666c25.6 0 42.667 17.067 42.667 42.667v170.666c0 25.6-17.067 42.667-42.667 42.667zM42.667 384C17.067 384 0 366.933 0 341.333V170.667C0 145.067 17.067 128 42.667 128h170.666c25.6 0 42.667 17.067 42.667 42.667s-17.067 42.666-42.667 42.666h-128v128c0 25.6-17.066 42.667-42.666 42.667z"></path></svg>'},function(e,t){e.exports='<svg class="svg" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><defs><style></style></defs><path d="M798.878 780.17H218.663c-43.717 0-79.28-35.604-79.28-79.281V323.11c0-43.638 35.563-79.28 79.28-79.28h580.215c43.716 0 79.28 35.603 79.28 79.28V700.89c0 43.638-35.524 79.28-79.28 79.28zM218.663 323.11V700.89h580.293l-.078-377.778H218.663zM79.281 925.696h190.464c21.898 0 39.621-17.723 39.621-39.66 0-21.898-17.723-39.621-39.62-39.621H79.28v-185.66c0-21.897-17.723-39.66-39.62-39.66S0 638.897 0 660.755v185.66c0 43.677 35.564 79.281 79.281 79.281zM984.34 621.174c-21.898 0-39.621 17.723-39.621 39.621v185.62H754.294c-21.937 0-39.66 17.723-39.66 39.62 0 21.938 17.723 39.661 39.66 39.661H944.72c43.717 0 79.281-35.564 79.281-79.281v-185.62c0-21.858-17.723-39.62-39.66-39.62zM0 177.585v185.66c0 21.858 17.723 39.62 39.62 39.62s39.622-17.762 39.622-39.62v-185.66h190.464c21.898 0 39.62-17.723 39.62-39.62s-17.722-39.622-39.62-39.622H79.28C35.564 98.304 0 133.908 0 177.585zm1024 185.62v-185.62c0-43.677-35.525-79.281-79.281-79.281H754.294c-21.937 0-39.66 17.723-39.66 39.62s17.723 39.622 39.66 39.622H944.72v185.62c0 21.858 17.723 39.581 39.62 39.581 21.938.079 39.661-17.684 39.661-39.542z"></path></svg>'},function(e,t){e.exports='<svg class="svg" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><defs><style></style></defs><path d="M960 384H789.333c-25.6 0-42.666-17.067-42.666-42.667V170.667c0-25.6 17.066-42.667 42.666-42.667S832 145.067 832 170.667v128h128c25.6 0 42.667 17.066 42.667 42.666S985.6 384 960 384zM234.667 384H64c-25.6 0-42.667-17.067-42.667-42.667S38.4 298.667 64 298.667h128v-128c0-25.6 17.067-42.667 42.667-42.667s42.666 17.067 42.666 42.667v170.666c0 25.6-17.066 42.667-42.666 42.667zM234.667 896c-25.6 0-42.667-17.067-42.667-42.667v-128H64c-25.6 0-42.667-17.066-42.667-42.666S38.4 640 64 640h170.667c25.6 0 42.666 17.067 42.666 42.667v170.666c0 25.6-17.066 42.667-42.666 42.667zM789.333 896c-25.6 0-42.666-17.067-42.666-42.667V682.667c0-25.6 17.066-42.667 42.666-42.667H960c25.6 0 42.667 17.067 42.667 42.667S985.6 725.333 960 725.333H832v128c0 25.6-17.067 42.667-42.667 42.667z"></path></svg>'},function(e,t){e.exports='<svg class="svg" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><defs><style></style></defs><path d="M923.852 338.007c-20.013-47.313-47.718-90.324-82.45-128.128 6.876-13.544 10.755-28.866 10.755-45.096 0-55.1-44.668-99.767-99.768-99.767-29.051 0-55.198 12.42-73.431 32.237-53.058-21.39-109.184-32.237-166.959-32.237-60.334 0-118.873 11.821-173.988 35.134-53.233 22.514-101.031 54.742-142.074 95.784-41.046 41.044-73.273 88.845-95.786 142.074-23.313 55.119-35.137 113.658-35.137 173.993 0 60.333 11.824 118.873 35.134 173.99 22.514 53.23 54.742 101.03 95.786 142.073 41.042 41.044 88.841 73.271 142.074 95.786 55.116 23.312 113.655 35.134 173.99 35.134S630.87 947.162 685.99 923.85c53.23-22.515 101.03-54.743 142.073-95.786 41.046-41.043 73.273-88.843 95.786-142.073 23.31-55.117 35.134-113.657 35.134-173.99.003-60.335-11.822-118.873-35.131-173.994zm-35.96 332.776c-20.546 48.576-49.961 92.204-87.43 129.677-37.474 37.47-81.1 66.888-129.68 87.432-50.28 21.263-103.703 32.048-158.784 32.048-55.077 0-108.5-10.783-158.785-32.048-48.575-20.546-92.204-49.962-129.676-87.432-37.473-37.473-66.889-81.101-87.43-129.677-21.268-50.28-32.052-103.704-32.052-158.784s10.784-108.503 32.051-158.783c20.542-48.576 49.96-92.206 87.43-129.677 37.473-37.47 81.102-66.887 129.677-87.433 50.285-21.266 103.708-32.05 158.785-32.05 50.6 0 99.798 9.107 146.448 27.075-3.768 10.514-5.825 21.842-5.825 33.653 0 55.1 44.668 99.767 99.767 99.767 24.574 0 47.066-8.89 64.453-23.62 29.738 33.371 53.604 71.037 71.05 112.285 21.267 50.28 32.05 103.702 32.05 158.783s-10.782 108.504-32.05 158.784z"></path></svg>'},function(e,t){e.exports='<svg class="svg" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><defs><style></style></defs><path d="M848.589 427.434c-37.972-152.983-176.097-266.828-340.634-266.828-121.82 0-233.176 61.668-297.917 164.97-8.095 12.951-4.203 30.037 8.754 38.126 12.957 8.17 30.037 4.204 38.167-8.753 54.59-87.075 148.434-139.015 251.032-139.015 133.61 0 245.584 89.604 282.238 211.5H687.863l137.185 169.132 137.23-169.132h-113.69zm-43.341 232.864c-12.917-8.13-30.037-4.164-38.167 8.753-54.59 87.076-148.398 139.015-250.996 139.015-133.686 0-245.624-89.64-282.273-211.54h102.366l-137.23-169.092L61.721 596.566H175.37c38.013 152.983 176.138 266.828 340.675 266.828 121.704 0 233.136-61.668 297.917-164.93 8.17-12.996 4.202-30.037-8.714-38.166zm0 0"></path></svg>'},function(e,t){e.exports='<svg class="svg" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><defs><style></style></defs><path d="M704 512c0-75.307-43.52-140.373-106.667-171.733v94.293L702.08 539.307c1.28-8.96 1.92-18.134 1.92-27.307zm106.667 0c0 40.107-8.747 77.867-23.04 112.64l64.64 64.64C880 636.16 896 576 896 512c0-182.613-127.787-335.36-298.667-374.187v88.107C720.64 262.613 810.667 376.747 810.667 512zM182.4 128L128 182.4 329.6 384H128v256h170.667L512 853.333V566.4l181.547 181.547c-28.587 21.973-60.8 39.68-96.214 50.346V886.4C656 872.96 709.547 846.08 754.56 809.173L841.6 896l54.4-54.4L182.4 128zM512 170.667l-89.173 89.173L512 349.013V170.667z"></path></svg>'},function(e,t){e.exports='<svg class="svg" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><defs><style></style></defs><path d="M234.612 152.734v718.532l554.775-338.981z"></path></svg>'},function(e,t){e.exports='<svg class="svg" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><defs><style></style></defs><path d="M609.09 858.613h194.181V178.98h-194.18M220.728 858.613h194.18V178.98H220.73v679.633z"></path></svg>'},function(e,t){e.exports='<svg class="svg" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><defs><style></style></defs><path d="M719.126 822.69H822.69V201.31H719.126M201.311 822.69L641.454 512 201.31 201.31v621.38z"></path></svg>'},function(e,t){e.exports='<svg class="svg" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><defs><style></style></defs><path d="M704 512c0-75.52-43.52-140.373-106.667-171.947V683.52C660.48 652.373 704 587.52 704 512zM128 384v256h170.667L512 853.333V170.667L298.667 384H128z"></path></svg>'},function(e,t){e.exports='<svg class="svg" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><defs><style></style></defs><path d="M128 384v256h170.667L512 853.333V170.667L298.667 384H128zm576 128c0-75.52-43.52-140.373-106.667-171.947V683.52C660.48 652.373 704 587.52 704 512zM597.333 137.813v87.894C720.64 262.4 810.667 376.747 810.667 512S720.64 761.6 597.333 798.293v87.894C768.427 847.36 896 694.613 896 512S768.427 176.64 597.333 137.813z"></path></svg>'},function(e,t){e.exports='<svg class="svg" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><defs><style></style></defs><path d="M512 455.75h450v112.5H512v-112.5zm-84.375 450a28.35 28.35 0 0 1-19.913-8.213L190.925 680.75H90.069a28.125 28.125 0 0 1-28.125-28.125v-281.25a28.125 28.125 0 0 1 28.125-28.125h100.856l216.787-216.787a28.069 28.069 0 0 1 48.038 19.912v731.25a28.125 28.125 0 0 1-28.125 28.125z"></path></svg>'},function(e,t){e.exports='<svg class="svg" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><defs><style></style></defs><path d="M962 568.25H793.25V737h-112.5V568.25H512v-112.5h168.75V287h112.5v168.75H962v112.5zm-534.375 337.5a28.35 28.35 0 0 1-19.913-8.213L190.925 680.75H90.069a28.125 28.125 0 0 1-28.125-28.125v-281.25a28.125 28.125 0 0 1 28.125-28.125h100.856l216.787-216.787a28.069 28.069 0 0 1 48.038 19.912v731.25a28.125 28.125 0 0 1-28.125 28.125z"></path></svg>'},function(e,t){e.exports='<svg class="svg" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><defs><style></style></defs><path d="M876.307 477.092l-.415.046c-1.474-14.462-12.942-25.93-27.358-27.358h-16.857v-.23c-18.054 0-33.714-10.409-41.221-25.608-1.796-3.73-3.178-7.691-3.915-11.929-3.408-9.442-7.231-18.653-11.56-27.634 0-.046 0-.046-.047-.046a44.275 44.275 0 0 1-5.204-10.317v-.046a45.846 45.846 0 0 1-2.625-15.337c0-12.712 5.112-24.227 13.495-32.517h-.047l9.35-9.35c.138-.092.23-.184.369-.322.092-.138.23-.23.322-.368 10.916-11.238 11.468-28.74 1.75-40.67l.184-.137c-7.185-8.613-14.692-16.857-22.568-24.687a352.377 352.377 0 0 0-25.285-23.075l-.092.092c-10.778-8.843-26.253-9.12-37.399-.967l-6.724 6.724-6.356 6.264-.276-.276c-13.403 13.448-33.07 16.857-49.65 10.178-2.257-.875-4.422-1.98-6.54-3.224a299.885 299.885 0 0 0-32.747-13.494c-1.98-.507-3.915-1.198-5.85-1.98 0 0-.046 0-.046-.047-5.48-2.165-10.685-5.573-15.152-10.04-7.508-7.508-11.837-16.996-13.127-26.76a43.81 43.81 0 0 1 0-11.514v-7.922c0-15.107-10.916-27.635-25.285-30.214a195.557 195.557 0 0 0-5.389-.46h.046c-10.133-.783-20.357-1.244-30.674-1.244s-20.542.46-30.674 1.29c-1.797.138-3.593.276-5.39.46-14.37 2.533-25.285 15.107-25.285 30.168v13.68c0 19.758-12.435 36.615-29.891 43.109-1.105.46-2.257.829-3.408 1.151-12.298 4.145-24.18 9.073-35.603 14.785-.092 0-.092.046-.138.046-.921.506-1.796.92-2.763 1.381-5.85 2.672-12.298 4.146-19.16 4.146a45.724 45.724 0 0 1-32.517-13.495l-.046.092-9.718-9.672c-10.685-10.685-27.174-11.837-39.103-3.547a157.267 157.267 0 0 0-4.053 3.363l-.184.184c-7.83 6.632-15.383 13.54-22.614 20.772a368.11 368.11 0 0 0-20.726 22.522s-.046 0-.046.046a153.344 153.344 0 0 0-3.5 4.191c-8.383 11.975-7.185 28.51 3.5 39.195l9.672 9.672c13.91 13.955 17.041 34.589 9.35 51.538-.461 1.06-.968 2.119-1.566 3.132a284.421 284.421 0 0 0-14.693 35.464c-.368 1.336-.829 2.58-1.335 3.823v.046c-2.211 5.803-5.666 11.33-10.41 15.982-8.98 8.981-20.725 13.495-32.516 13.495v.138h-13.68c-15.106 0-27.634 10.87-30.213 25.24-.184 1.75-.368 3.546-.506 5.388-.83 9.902-1.244 20.588-1.244 30.674v.507c0 10.179.415 20.219 1.244 30.121v.046c.138 1.797.322 3.593.506 5.39 2.58 14.369 15.061 25.285 30.122 25.285H186.597c19.574 0 36.293 12.25 42.926 29.522V602c.46 1.152.829 2.303 1.105 3.455.046.046.046.138.138.23 4.1 12.251 9.073 24.134 14.738 35.602.047.046.092.138.139.185.506.875.92 1.796 1.381 2.763 2.672 5.85 4.191 12.343 4.191 19.16a45.724 45.724 0 0 1-13.494 32.516l.046.047-9.35 9.35c-.138.091-.23.23-.368.322-.138.138-.23.23-.323.368-10.224 10.547-11.376 26.621-3.454 38.412 1.336 1.612 2.671 3.224 4.007 4.79 6.54 7.738 13.403 15.153 20.588 22.338 7.185 7.185 14.646 14.093 22.384 20.633 1.566 1.336 3.132 2.626 4.698 3.915 10.639 7.185 24.778 6.909 35.187-.69l6.725-6.725 6.31-6.31.276.23c13.955-13.909 34.635-17.04 51.63-9.303.875.368 1.75.829 2.58 1.243.046.046.138.046.23.139a286.253 286.253 0 0 0 35.925 14.922 62.4 62.4 0 0 1 3.132 1.06 46.707 46.707 0 0 1 16.58 10.593c8.981 8.981 13.495 20.726 13.495 32.516h.138v13.541c0 15.844 12.021 28.924 27.497 30.49v.184c11.1 1.06 22.337 1.566 33.76 1.566 11.422 0 22.66-.506 33.806-1.566l-.046-.184c15.429-1.566 27.542-14.646 27.542-30.49v-13.679c0-18.469 10.87-34.359 26.529-41.682 3.178-1.52 6.54-2.625 10.04-3.362 10.087-3.547 19.897-7.6 29.431-12.251 2.764-1.797 5.757-3.316 8.843-4.422a45.338 45.338 0 0 1 16.12-2.948c11.653 0 22.338 4.376 30.49 11.607a39.676 39.676 0 0 1 3.961 3.915l7.83 7.876.046-.046c10.777 10.777 27.68 11.836 39.655 3.177.047 0 .092-.046.139-.138 1.013-.829 1.98-1.612 2.947-2.44a377.697 377.697 0 0 0 23.213-21.325c7.415-7.415 14.554-15.153 21.325-23.213l2.625-3.178c8.429-11.56 7.692-27.635-2.072-38.458l-.047-.046-2.21-2.165-8.567-8.566v-.047c-13.725-13.725-16.95-33.944-9.718-50.709.69-1.566 1.427-3.132 2.303-4.606 5.434-11.053 10.178-22.522 14.231-34.312.46-1.566.921-3.132 1.566-4.606 2.211-5.757 5.665-11.1 10.317-15.752 8.935-8.935 20.726-13.448 32.517-13.448v-.046h13.218v-.185c16.397 0 29.8-12.896 30.582-29.062l.46.046a372.758 372.758 0 0 0 1.383-32.148c0-11.468-.553-22.798-1.566-33.99zm-178.565 33.99c0 21.463-3.546 42.097-10.178 61.303-2.488 7.323-5.481 14.462-8.797 21.324-9.166 18.838-21.463 35.925-36.063 50.664-14.647 14.692-31.688 26.99-50.48 36.247a179.54 179.54 0 0 1-21.508 8.98c-19.206 6.725-39.84 10.318-61.302 10.41h-.553c-21.279 0-41.682-3.5-60.75-9.995-7.691-2.579-15.107-5.665-22.245-9.165a187.67 187.67 0 0 1-50.295-35.925c-14.738-14.646-27.036-31.641-36.247-50.479a177.595 177.595 0 0 1-9.212-22.015c-6.54-19.114-10.132-39.564-10.178-60.888.046-21.279 3.592-42.695 10.178-61.763a182.24 182.24 0 0 1 9.166-22.062 188.68 188.68 0 0 1 36.247-50.478c14.738-14.647 31.826-26.898 50.663-36.11 7.047-3.408 14.37-6.447 21.877-8.98 19.068-6.495 39.471-9.995 60.75-9.995h.553c21.508.092 42.142 3.73 61.348 10.363 7.37 2.533 14.554 5.573 21.463 8.981 18.837 9.258 35.879 21.6 50.525 36.247a191.982 191.982 0 0 1 35.925 50.295c3.408 7 6.448 14.231 8.98 21.693 6.587 19.16 10.18 39.747 10.18 61.118v.23h-.047z"></path></svg>'},function(e,t){e.exports='<svg class="svg" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><defs><style></style></defs><path d="M655.331 894.933l72.757-71.003-326.086-310.307 326.086-310.307-72.757-71.004-398.84 381.31 398.84 381.31z"></path></svg>'},function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid"><g transform="rotate(.24 50 50)"><animateTransform attributeName="transform" type="rotate" values="360 50 50;0 50 50" keyTimes="0;1" dur="1.5s" repeatCount="indefinite" calcMode="spline" keySplines="0.5 0 0.5 1" begin="-0.15000000000000002s"></animateTransform><circle cx="50" cy="50" r="39.891" stroke="#ffc254" stroke-width="14.4" fill="none" stroke-dasharray="0 300"><animate attributeName="stroke-dasharray" values="15 300;55.1413599195142 300;15 300" keyTimes="0;0.5;1" dur="1.5s" repeatCount="indefinite" calcMode="linear" keySplines="0 0.4 0.6 1;0.4 0 1 0.6" begin="-0.069s"></animate></circle><circle cx="50" cy="50" r="39.891" stroke="#fff1cf" stroke-width="7.2" fill="none" stroke-dasharray="0 300"><animate attributeName="stroke-dasharray" values="15 300;55.1413599195142 300;15 300" keyTimes="0;0.5;1" dur="1.5s" repeatCount="indefinite" calcMode="linear" keySplines="0 0.4 0.6 1;0.4 0 1 0.6" begin="-0.069s"></animate></circle><circle cx="50" cy="50" r="32.771" stroke="#000" fill="none" stroke-dasharray="0 300"><animate attributeName="stroke-dasharray" values="15 300;45.299378454348094 300;15 300" keyTimes="0;0.5;1" dur="1.5s" repeatCount="indefinite" calcMode="linear" keySplines="0 0.4 0.6 1;0.4 0 1 0.6" begin="-0.069s"></animate></circle><circle cx="50" cy="50" r="47.171" stroke="#000" fill="none" stroke-dasharray="0 300"><animate attributeName="stroke-dasharray" values="15 300;66.03388996804073 300;15 300" keyTimes="0;0.5;1" dur="1.5s" repeatCount="indefinite" calcMode="linear" keySplines="0 0.4 0.6 1;0.4 0 1 0.6" begin="-0.069s"></animate></circle></g><g transform="rotate(7.842 50 50)"><animateTransform attributeName="transform" type="rotate" values="360 50 50;0 50 50" keyTimes="0;1" dur="1.5s" repeatCount="indefinite" calcMode="spline" keySplines="0.5 0 0.5 1"></animateTransform><path fill="#ffc254" stroke="#000" d="M97.2 50c0 6.1-1.2 12.2-3.5 17.8l-13.3-5.4c1.6-3.9 2.4-8.2 2.4-12.4"></path><path fill="#fff1cf" d="M93.6 49.9c0 1.2 0 2.4-.1 3.6l-.5 3.6c-.4 2-2.3 3.3-4.2 2.8l-.2-.1c-1.8-.5-3.1-2.3-2.7-3.9l.4-3c.1-1 .1-2 .1-3"></path><path fill="#ffc254" stroke="#000" d="M85.4 62.5c-.2.7-.5 1.4-.8 2.1-.3.7-.6 1.4-.9 2-.6 1.1-2 1.4-3.2.8-1.1-.7-1.7-2-1.2-2.9.3-.6.5-1.2.8-1.8.2-.6.6-1.2.7-1.8M94.5 65.7c-.3.9-.7 1.7-1 2.6-.4.8-.7 1.7-1.1 2.5-.7 1.4-2.3 1.9-3.4 1.3-1.1-.7-1.5-2.2-.9-3.4.4-.8.7-1.5 1-2.3.3-.8.7-1.5.9-2.3M85.6 67c0 .8.1 1.6.3 2.4.6-.5 1.1-1 1.4-1.7.2-.7.2-1.5-.1-2.2-.7-1.5-1.6.8-1.6 1.5z"></path></g><g transform="rotate(.24 50 50)"><animateTransform attributeName="transform" type="rotate" values="360 50 50;0 50 50" keyTimes="0;1" dur="1.5s" repeatCount="indefinite" calcMode="spline" keySplines="0.5 0 0.5 1" begin="-0.15000000000000002s"></animateTransform><path fill="#fff1cf" stroke="#000" d="M91 33.6l-10 4c-.4-1.2-1.1-2.4-1.7-3.5-.2-.5.3-1.1.9-1 3.4-.2 7.2-.2 10.8.5z"></path><path fill="#fff1cf" stroke="#000" d="M83.2 36.7l10-4c-.6-1.7-1.5-3.3-2.3-4.9-.3-.7-1.2-.6-1.4.1-1.9 3.2-3.8 6.1-6.3 8.8z"></path><path fill="#ffc254" stroke="#000" d="M82.8 50.2c0-3.4-.5-6.8-1.5-10-.2-.8-.4-1.5-.3-2.3.1-.8.4-1.6.7-2.4.7-1.5 1.9-3.1 3.7-4 1.8-.9 3.7-1 5.6-.3.9.4 1.7 1 2.4 1.8s1.3 1.7 1.7 2.8c1.5 4.6 2.2 9.5 2.2 14.4"></path><path fill="#fff1cf" d="M86.4 50.3v-.9l-.1-.9-.1-1.9c0-.9.2-1.7.7-2.3.5-.7 1.3-1.2 2.3-1.4h.3c.9-.2 1.9 0 2.6.6.7.5 1.3 1.4 1.4 2.4l.2 2.2.1 1.1v1.1"></path><path d="M88.6 36.6c.1.3-.2.7-.6.8-.5.2-.9 0-1.1-.3-.1-.3.2-.7.6-.8.5-.2 1-.1 1.1.3z"></path><path fill="none" stroke="#000" d="M86 38.7c.2.6.8.9 1.4.7.6-.2.9-.9.6-2.1.3 1.2 1 1.7 1.6 1.5.6-.2.9-.8.8-1.4"></path><path fill="#ffc254" stroke="#000" d="M86.8 42.2l.4 2.2c.1.4.1.7.2 1.1l.1 1.1c.1 1.2-.9 2.3-2.2 2.3-1.3 0-2.5-.8-2.5-1.9l-.1-1c0-.3-.1-.6-.2-1l-.3-1.9M96.2 40.2l.5 2.7c.1.5.2.9.2 1.4l.1 1.4c.1 1.5-.9 2.8-2.2 2.8-1.3 0-2.5-1.1-2.6-2.4l-.1-1.2c0-.4-.1-.8-.2-1.2l-.4-2.5"></path><path fill="none" stroke="#000" d="M90.9 36.4c1.1-1.1 2.7-1.6 4.3-1.9M91.6 37.5c1.3-.5 2.8-.8 4.2-.7M91.7 38.8c.2-.1.4-.1.7-.1 1.2-.1 2.5 0 3.8.3M85 38.4c-1.6-.1-3.1.6-4.6 1.2M85 39.5c-1.4.3-2.8.9-4 1.6M85.5 40.4c-.2 0-.4.1-.7.2-1.1.5-2.2 1.1-3.2 1.8"></path><path fill="#ff7bac" d="M92.8 34.2c.1.3-.3.8-.9 1-.6.2-1.2.1-1.4-.2-.1-.3.3-.8.9-1 .7-.2 1.3-.1 1.4.2zM82.2 38.2c.1.3.7.3 1.3.1.6-.2 1-.6.9-.9-.1-.3-.7-.3-1.3-.1-.6.2-1.1.6-.9.9z"></path><path d="M90 35.7l-.7.3-.3-.7c-.3-.9.1-1.9.9-2.3l.7-.3.3.7c.4 1 0 2-.9 2.3zM85.3 37.4l.7-.2-.2-.6c-.3-.8-1.3-1.2-2.1-.8l-.8.2.2.6c.4.8 1.3 1.1 2.2.8z"></path></g></svg>'},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default=function(e){var t=/mobile/i.test(window.navigator.userAgent);var r={element:e.element||document.getElementsByClassName("mplayer")[0],type:e.type||"html5",preload:"auto",quality:false,mobile:false,hotkey:false,autoplay:false,loop:false,blob:false,volume:40,loggerType:e.loggerType||1};if(t){e.autoplay=false;e.mobile=true}for(var i in r){if(r.hasOwnProperty(i)&&!e.hasOwnProperty(i)){e[i]=r[i]}}if(!e.video){e.video={poster:"",src:""}}return e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var i=r(1);var a=n(i);function n(e){return e&&e.__esModule?e:{default:e}}var s={build:function e(t,r){var i='\n            <div class="video-box">\n                <video class="mplayer-video mplayer-video-index'+t+'" src=""></video>\n            </div>\n            <div class="info-panel">\n                <a class="close" title="关闭">[x]</a>\n                <ul class="items">\n                    <li>\n                        <span class="name">Player:</span>\n                        <span class="v">Ayaya @'+"1.2.1"+"-"+"1d22163"+'</span>\n                    </li>\n                    <li>\n                        <span class="name">Support Mode:</span>\n                        <span class="v">html5, flv, hls, M(PEG)-Dash</span>\n                    </li>\n                    <li>\n                        <span class="name">Current Mode:</span>\n                        <span class="v player-mode">default</span>\n                    </li>\n                    <li>\n                        <span class="name">Video ID:</span>\n                        <span class="v vid">-</span>\n                    </li>\n                    <li>\n                        <span class="name">Viewport:</span>\n                        <span class="v viewport">900x506</span>\n                    </li>\n                    <li>\n                        <span class="name">Volume:</span>\n                        <span class="v volume">40</span>\n                    </li>\n                    <li>\n                        <span class="name">Codecs:</span>\n                        <span class="v codecs">video/mp4;codecs="avc1.640028"</span>\n                    </li>\n                    <li>\n                        <span class="name">Host:</span>\n                        <span class="v host"></span>\n                    </li>\n                    <li>\n                        <span class="name">Connection Speed:</span>\n                        <span class="v right connection-speed">-</span>\n                    </li>\n                    <li>\n                        <span class="name">Dropped frames:</span>\n                        <span class="v dropped-frames">0</span>\n                    </li>\n                </ul>\n            </div>\n            <div class="hidden">\n                <div class="copy-location">'+window.location.href+'</div>\n            </div>\n            <div class="context-menu">\n                <ul>         \n                </ul>            \n            </div>\n            <div class="video-play-status-mask">\n                <div class="icon play-status">'+a.default.play+'</div>\n            </div>\n            \n            <div class="video-notice">\n                <span>10%</span>\n            </div>\n            <div class="video-stats">\n                '+a.default.play+'\n            </div>\n            <div class="video-waiting">\n                '+a.default.loading+'\n            </div>\n            \n            <div class="control-mask"></div>\n            <div class="controls">\n            <div class="control-bar">\n                <div class="seek-timer-label">00:00</div>\n                    <div class="bar-player-time hidden">00:00</div>\n                    <div class="load-bar">\n                        <div class="loaded" style="width: 0"></div>\n                        <div class="played" style="width: 0">\n                            <span class="after"></span>                        \n                        </div>\n                        <div class="hover" style="width: 0"></div>\n                    </div>\n                </div>\n                <div class="control left">\n                    <button class="icon button-play">\n                        '+a.default.play+'\n                    </button>\n                    <button class="icon button-next hidden">\n                        '+a.default.skip+'                    \n                    </button>\n                    <div class="volume-box">\n                        <button class="icon button-volume">\n                            '+a.default.volume1+'\n                        </button>\n                        <div class="volume-bar-box">\n                            <div class="volume-bar">\n                                <div class="volume-bar-inner" style="width: 45%"></div>\n                            </div>\n                        </div>\n\n                    </div>\n                    <div class="play-time">\n                        <span class="play-current">00:00</span> / <span class="play-duration">00:00</span>\n                    </div>\n                </div>\n                <div class="control right">\n                    <button class="icon button-disorder hidden">  \n                    </button>\n                    '+(r.quality?'<button class="icon">720P</button>':"")+'\n                    <div class="video-quality hidden">\n                        <ul>\n                            <li>1080P</li>\n                            <li>720P</li>\n                            <li>360P</li>                           \n                        </ul>                    \n                    </div>    \n                    \n                    <input type="checkbox" id="mplayer-chk'+t+'" class="button-settings-checkbox hidden"/>\n                    <label for="mplayer-chk'+t+'" class="icon button-settings">\n                        '+a.default.setting+'\n                    </label>\n                    <div class="control-settings">\n                        <ul class="setting-group">\n                            <li class="play-speed">播放速度：<span class="text">正常</span>'+a.default.back+'</li>\n                            <li class="mirror">镜像模式：<span class="text">关</span></li>\n                            <li class="hotkey">方向热键：<span class="text">开启</span></li>\n                            <li class="loop">洗脑循环：<span class="text">关闭</span></li>                    \n                        </ul>\n                        <ul class="play-speed-box hidden">\n                            <li class="line">'+a.default.back+' 速度</li>\n                            <li data-spd="0.5">0.50</li>\n                            <li data-spd="0.75">0.75</li>\n                            <li data-spd="1" class="active">正常</li>\n                            <li data-spd="1.25">1.25</li>\n                            <li data-spd="1.5">1.50</li>\n                            <li data-spd="2">2</li>                           \n                        </ul>                \n                    </div>\n                    <div class="full-screen-group">\n                        <button class="icon button-web-full-screen">'+a.default.fullWeb+'</button>  \n                        <button class="icon button-full-screen">'+a.default.full+"</button>           \n                    </div>\n                    \n                </div>\n            </div>\n\n            ";return i}};t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var i=function(){function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}return function(e,t,r){if(t)i(e.prototype,t);if(r)i(e,r);return e}}();function n(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var a=function(){function a(e){var t=this;n(this,a);this.isShow=false;var r=e.player.element.querySelector(".context-menu");var i=r.querySelector("ul");i.innerHTML="";this.init(i,e.menus);e.player.element.oncontextmenu=function(e){e.preventDefault();r.style.left=e.offsetX+"px";r.style.top=e.offsetY+"px";r.style.display="block";t.isShow=true};e.player.element.onclick=function(e){r.style.display="none";t.isShow=false}}i(a,[{key:"init",value:function e(t,r){var i=true;var a=false;var n=undefined;try{for(var s=r[Symbol.iterator](),o;!(i=(o=s.next()).done);i=true){var l=o.value;var u=document.createElement("li");u.innerText=l.name;l.class&&u.classList.add(l.class);u.addEventListener("click",l.func);t.appendChild(u)}}catch(e){a=true;n=e}finally{try{if(!i&&s.return){s.return()}}finally{if(a){throw n}}}}}]);return a}();t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var i=function(){function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}return function(e,t,r){if(t)i(e.prototype,t);if(r)i(e,r);return e}}();var a=r(0);var n=s(a);function s(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var l=function(){function r(e){var t=this;o(this,r);this.player=e;this.element=e.element;this.panel=this.element.querySelector(".info-panel");this.events={};this.events.droppedFrames=this.panel.querySelector(".dropped-frames");this.events.connectionSpeed=this.panel.querySelector(".connection-speed");this.events.viewport=this.panel.querySelector(".viewport");this.events.volume=this.panel.querySelector(".volume");this.events.videoId=this.panel.querySelector(".vid");this.events.host=this.panel.querySelector(".host");this.events.playerMode=this.panel.querySelector(".player-mode");this.events.codecs=this.panel.querySelector(".codecs");this.isShow=false;this.panel.querySelector(".close").addEventListener("click",function(e){e.preventDefault();t.close()});this.events.playerMode.innerText=this.player.options.type;this.dict=[{x:0,y:14},{x:180,y:14}]}i(r,[{key:"open",value:function e(){this.isShow=true;this.panel.style.display="block"}},{key:"close",value:function e(){this.isShow=false;this.panel.style.display="none"}},{key:"setVolumeText",value:function e(t){this.events.volume.innerText=t}},{key:"setVideoId",value:function e(t){this.events.videoId.innerText=t}},{key:"setSourceHost",value:function e(t){this.events.host.innerText=t}},{key:"trigger",value:function e(){if(this.player.stats){this.events.droppedFrames.innerText=this.player.stats.droppedFrames+"/"+this.player.stats.totalFrames;this.events.connectionSpeed.innerText=(this.player.stats.fragLastKbps/8).toFixed(2)+"Kb/s";this.events.codecs.innerText=this.player.stats.codec}this.events.viewport.innerText=this.element.offsetWidth+"x"+this.element.offsetHeight}},{key:"connectionSpeedLine",value:function e(){}}]);return r}();t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var i=function(){function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}return function(e,t,r){if(t)i(e.prototype,t);if(r)i(e,r);return e}}();var n=r(2);var a=r(0);var s=c(a);var o=r(1);var l=c(o);var u=r(3);var f=c(u);function c(e){return e&&e.__esModule?e:{default:e}}function d(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var h=s.default.getLogger();var p=function(){function r(e){var t=this;d(this,r);this.player=e;this.element=e.element;this.video=e.video;this.autoHideControls=0;this.status=f.default.LOADING;this.speed=1;this.isShow=false;this.mirror=false;this.hotkey=false;this.events=[];this.initButton();this.initLoadBar();this.initPlayTimer();this.initVolumeBar();this.initSettingGroup();this.initWaitingWarp();this._maskClick();this.eventFunc=function(){for(var e=0;e<t.events.length;e++){t.events[e]()}};this.element.addEventListener("mousemove",function(){t.autoHide()});h.debug("Controller inited")}i(r,[{key:"initButton",value:function e(){var t=this;this.button={};this.button.play=this.element.querySelector(".button-play");this.button.volume=this.element.querySelector(".button-volume");this.button.setting=this.element.querySelector(".button-settings-checkbox");this.button.nextPlay=this.element.querySelector(".button-next");var r=function e(){t.player.pause();t.status=f.default.PAUSE;t.video.removeEventListener("timeupdate",t.eventFunc);t.video.removeEventListener("ended",e);t.player.events.trigger(f.default.PLAYED)};this.play=function(){h.info("Play Status: "+t.status);if(t.status===f.default.PLAY){t.player.pause();t.status=f.default.PAUSE;t.video.removeEventListener("timeupdate",t.eventFunc);t.video.removeEventListener("ended",r)}else{t.video.addEventListener("timeupdate",t.eventFunc);t.video.addEventListener("ended",r);t.status=f.default.PLAY;t.player.play();t.autoHide()}};this.next=function(){h.info("Next video: "+t.player.source2);if(t.player.source2!==null){t.player.next()}};this.button.nextPlay.addEventListener("click",function(){return t.next()});this.button.play.addEventListener("click",function(){return t.play()});this.button.volume.addEventListener("click",function(){if(t.video.muted){t.setVolume(t.video.volume*100)}else{t.setVolume(0)}})}},{key:"initLoadBar",value:function e(){var a=this;this.bar={};this.bar.load=this.element.querySelector(".player-wrap .control-bar");this.bar.loaded=this.bar.load.querySelector(".load-bar .loaded");this.bar.played=this.bar.load.querySelector(".load-bar .played");this.bar.hover=this.bar.load.querySelector(".hover");this.bar.timerLabel=this.bar.load.querySelector(".seek-timer-label");var r=function e(t){a.element.removeEventListener("mousemove",i);a.element.removeEventListener("mouseup",e)};var t=function e(t){a.element.addEventListener("mousemove",i);a.element.addEventListener("mouseup",r);t.preventDefault();return false};var i=function e(t){if(!a.video.duration||a.video.duration<=0)return;var r=(t.clientX-a.bar.load.getBoundingClientRect().left)/a.bar.load.offsetWidth;r=r>0?r:0;r=r<1?r:1;a.bar.played.style.width=(r*100).toFixed(2)+"%";a.player.seek(r*a.video.duration)};this.bar.played.addEventListener("mousedown",t);this.bar.load.addEventListener("mousedown",function(e){var t=e.offsetX;var r=e.target;while(r!==a.bar.load){t+=r.offsetLeft;r=r.parentNode}var i=t/a.bar.load.offsetWidth;i=i>0?i:0;i=i<1?i:1;a.bar.played.style.width=(i*100).toFixed(2)+"%";a.player.seek(parseFloat(i)*a.video.duration);e.preventDefault();return false});this.bar.load.addEventListener("mousemove",function(e){if(!a.video.duration||a.video.duration<=0)return;var t=(e.clientX-a.bar.load.getBoundingClientRect().left)/a.bar.load.offsetWidth;t=t>0?t:0;t=t<1?t:1;var r=(0,n.formatTime)(parseFloat(t)*a.video.duration);a.bar.timerLabel.style.left=t*100+"%";a.bar.timerLabel.innerText=r;a.bar.hover.style.width=t*100+"%"});this.updateLoadBar=function(){var e=a.video.currentTime/a.video.duration;var t=a.video.buffered.length?a.video.buffered.end(a.video.buffered.length-1)/a.video.duration:0;var r=(e*100).toFixed(2)+"%";var i=(t*100).toFixed(2)+"%";a.bar.loaded.style.width=i;a.bar.played.style.width=r};this.events.push(this.updateLoadBar)}},{key:"initVolumeBar",value:function e(){var a=this;this.volumeBar={};this.volumeBar.bar=this.element.querySelector(".volume-bar");this.volumeBar.inner=this.element.querySelector(".volume-bar-inner");this.volumeBar.min=this.volumeBar.bar.offsetLeft;this.volumeBar.max=this.volumeBar.min+this.volumeBar.offsetWidth;this.setVolume=function(e){e=e>100?100:e;e=e<0?0:e;e=parseInt(e);h.debug("Volume change to "+e);if(parseInt(e)===0){a.video.muted=true;a.button.volume.innerHTML=l.default.mute;a.volumeBar.inner.style.width="0%"}else{a.video.muted=false;a.video.volume=(e/100).toFixed(2);a.volumeBar.inner.style.width=e+"%";if(e>0&&e<50){a.button.volume.innerHTML=l.default.volume1}else{a.button.volume.innerHTML=l.default.volume2}}a.player.notice.showAutoHide("音量 "+e);a.player.infoPanel.setVolumeText(e)};this.getVolume=function(){return a.video.volume};var r=function e(t){var r=a.volumeBar.bar.getBoundingClientRect().left;var i=(t.clientX-r)/a.volumeBar.bar.offsetWidth*100;a.setVolume(i)};var t=function e(t){r(t);a.element.addEventListener("mousemove",i);a.element.addEventListener("mouseup",n);t.preventDefault();t.stopPropagation();return false};var i=function e(t){r(t)};var n=function e(t){a.element.removeEventListener("mousemove",i);a.element.removeEventListener("mouseup",e)};this.volumeBar.inner.addEventListener("mousedown",t);this.volumeBar.bar.addEventListener("mousedown",function(e){r(e)})}},{key:"initPlayTimer",value:function e(){var t=this;this.timer={};this.timer.current=this.element.querySelector(".play-time .play-current");this.timer.duration=this.element.querySelector(".play-time .play-duration");this.updateTimer=function(){t.timer.current.innerText=(0,n.formatTime)(t.video.currentTime);t.timer.duration.innerText=(0,n.formatTime)(t.video.duration)};this.events.push(this.updateTimer)}},{key:"initSettingGroup",value:function e(){var r=this;var t=this;this.settings={};var i=this.element.querySelector(".setting-group");this.playSpeedBox=this.element.querySelector(".play-speed-box");this.settings.playSpeed=i.querySelector(".play-speed");this.settings.mirror=i.querySelector(".mirror");this.settings.hotkey=i.querySelector(".hotkey");this.settings.loop=i.querySelector(".loop");var a=function e(t){var r=t.getElementsByTagName("li");for(var i=0;i<r.length;i++){r[i].classList.remove("active")}};this.settings.playSpeed.addEventListener("click",function(e){i.classList.add("hidden");r.playSpeedBox.classList.remove("hidden")});this.playSpeedBox.addEventListener("click",function(e){var t=e.target||e.srcElement;if(t.tagName.toLowerCase()==="li"){if(t.dataset.spd!=null){r.player.playbackRate(t.dataset.spd);a(r.playSpeedBox);t.classList.add("active")}}r.playSpeedBox.classList.add("hidden");i.classList.remove("hidden")});this.settings.mirror.addEventListener("click",t._mirror.bind(t),false);this.settings.loop.addEventListener("click",t._loop.bind(t),false);this.bindHotKeyFunc=t._bindHotKey.bind(t);this.settings.hotkey.addEventListener("click",function(e){t.hotKey()});t.hotKey()}},{key:"initWaitingWarp",value:function e(){var r=this;this.waitingId=0;var t=function e(t){r.player.element.classList.remove("player-waiting");clearInterval(r.waitingId)};this.player.video.addEventListener("waiting",function(){r.player.element.classList.add("player-waiting");h.debug("Video Loading..");r.waitingId=setInterval(function(){if(r.player.video.readyState>3){t()}},300)});this.player.video.addEventListener("canplay",t)}},{key:"autoHide",value:function e(){var t=this;this.autoHideFunc=function(){t.show();clearTimeout(t.autoHideControls);t.autoHideControls=setTimeout(function(){if(t.video.played.length&&t.status!=f.default.PAUSE){t.hide()}},3e3)};(0,n.requestAnimationFrame)(this.autoHideFunc)}},{key:"show",value:function e(){this.isShow=true;this.player.element.classList.remove("player-hide-control");document.body.style.cursor="auto"}},{key:"hide",value:function e(){this.isShow=false;this.player.element.classList.add("player-hide-control");this.button.setting.checked=false;if(this.player.fullScreen.mode>0){document.body.style.cursor="none"}}},{key:"_mirror",value:function e(){if(this.mirror){this.video.style.transform="scaleX(1)";this.settings.mirror.querySelector(".text").innerText="关";this.player.notice.showAutoHide("镜像 关")}else{this.video.style.transform="scaleX(-1)";this.settings.mirror.querySelector(".text").innerText="开";this.player.notice.showAutoHide("镜像 开")}this.mirror=!this.mirror}},{key:"_loop",value:function e(){if(this.video.loop){this.video.loop=false;this.settings.loop.querySelector(".text").innerText="关闭";this.player.notice.showAutoHide("循环播放 关")}else{this.video.loop=true;this.settings.loop.querySelector(".text").innerText="开启";this.player.notice.showAutoHide("循环播放 开")}}},{key:"hotKey",value:function e(){var t=this;if(this.hotkey){this.settings.hotkey.querySelector(".text").innerText="关闭";document.removeEventListener("keydown",this.bindHotKeyFunc);this.player.notice.showAutoHide("全局热键 关");h.debug("Hotkey disable")}else{this.settings.hotkey.querySelector(".text").innerText="开启";document.addEventListener("keydown",this.bindHotKeyFunc);this.player.notice.showAutoHide("全局热键 开");h.debug("Hotkey enable")}this.hotkey=!this.hotkey}},{key:"_bindHotKey",value:function e(t){console.log("event",t);t.stopPropagation();t.preventDefault();switch(t.keyCode){case 123:console.log("...link start!");return false;case 37:case 74:this.player.seek(this.player.seek()-5);break;case 39:case 76:this.player.seek(this.player.seek()+5);break;case 38:this.player.setVolume(this.player.volume+5);break;case 40:this.player.setVolume(this.player.volume-5);break;case 75:case 32:this.play();break}}},{key:"_maskClick",value:function e(){var t=this;h.debug("addEventListener video click -> play()");var r=this;this.player.video.addEventListener("click",function(){if(!r.player.menu.isShow&&r.isShow){t.play()}})}},{key:"destroy",value:function e(){document.removeEventListener("keyup",this.bindHotKeyFunc);clearTimeout(this.autoHideControls);clearInterval(this.waitingId);cancelAnimationFrame(this.autoHideFunc)}}]);return r}();t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var a=function(){function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}return function(e,t,r){if(t)i(e.prototype,t);if(r)i(e,r);return e}}();var i=r(0);var n=s(i);function s(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var l={NONE:0,WEB:1,SCREEN:2};var u=n.default.getLogger();var f=function(){function i(e){var t=this;o(this,i);this.player=e;var r=document.body.requestFullscreen||document.body.mozRequestFullScreen||document.body.webkitRequestFullscreen||document.body.msRequestFullscreen;this.SCREEN_DIRECTION={primary:"landscape-primary",secondary:"landscape-secondary"};this.setMode(l.NONE);this.element={};this.element.name={};this.element.name.web="player-web-full";this.element.name.screen="player-screen-full";this.element.fullScreen=this.player.element.querySelector(".button-full-screen");this.element.fullWebScreen=this.player.element.querySelector(".button-web-full-screen");this.element.fullScreen.addEventListener("click",function(){t.screenFull()});this.element.fullWebScreen.addEventListener("click",function(){t.webFull()});u.debug("Player Screen Mode:"+this.isInFullScreenMode())}a(i,[{key:"isInFullScreenMode",value:function e(){return document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen||document.msFullscreenElement||this.player.element.fullScreen||this.player.element.mozFullScreen||this.player.element.webkitIsFullScreen||this.player.element.msFullscreenElement}},{key:"webFull",value:function e(){u.debug("Player Screen Mode:"+this.isInFullScreenMode());if(this.mode!==l.WEB){this.player.element.classList.add(this.element.name.web);this.player.element.classList.remove(this.element.name.screen);document.body.style.overflow="hidden";this.setMode(l.WEB)}else{this.player.element.classList.remove(this.element.name.web);this.player.element.classList.remove(this.element.name.screen);document.body.style.overflow="auto";this.setMode(l.NONE)}this.player.infoPanel.trigger();this.player.events.trigger("fullscreen",this.getMode())}},{key:"screenFull",value:function e(){u.debug("Player Screen Mode:"+this.isInFullScreenMode());this.player.element.classList.remove(this.element.name.screen);this.player.element.classList.remove(this.element.name.web);if(this.mode!==l.SCREEN&&!this.isInFullScreenMode()){u.debug("InMode"+l.SCREEN);if(this.player.element.requestFullscreen){this.player.element.requestFullscreen()}else if(this.player.element.mozRequestFullScreen){this.player.element.mozRequestFullScreen()}else if(this.player.element.webkitRequestFullscreen){this.player.element.webkitRequestFullscreen()}else if(this.player.element.msRequestFullscreen){this.player.element.msRequestFullscreen()}if(this.player.options.mobile){screen.orientation.lock(this.SCREEN_DIRECTION.primary)}this.player.element.style.width="100%";this.player.element.style.height="100%";this.player.element.classList.add(this.element.name.screen);this.setMode(l.SCREEN)}else{u.debug("Exit Screen Mode"+l.NONE);this.setMode(l.NONE);this.exitScreenFull()}this.player.events.trigger("fullscreen",this.getMode())}},{key:"exitScreenFull",value:function e(){if(document.exitFullscreen){document.exitFullscreen()}else if(document.mozCancelFullScreen){document.mozCancelFullScreen()}else if(document.webkitExitFullscreen){document.webkitExitFullscreen()}else if(document.webkitCancelFullScreen){document.webkitCancelFullScreen()}else if(document.msExitFullscreen){document.msExitFullscreen()}if(this.player.options.mobile){screen.orientation.unlock()}this.player.element.style.width="";this.player.element.style.height="";this.player.element.classList.remove(this.element.name.screen);u.debug("Exit ScreenFull Mode")}},{key:"getMode",value:function e(){return this.mode}},{key:"setMode",value:function e(t){this.mode=t;if(t!==l.SCREEN&&this.isInFullScreenMode()){this.exitScreenFull()}}}]);return i}();t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var i=function(){function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}return function(e,t,r){if(t)i(e.prototype,t);if(r)i(e,r);return e}}();var a=r(1);var n=s(a);function s(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var l=function(){function t(e){o(this,t);this.player=e;this.element=this.player.element.querySelector(".video-notice");this.element.style.display="none";this.element.style.opacity=0;this.textEl=this.element.querySelector("span");this.textEl.innerText="";this.stats=this.player.element.querySelector(".video-stats");this.statsIv=0;this.iv=0}i(t,[{key:"showAutoHide",value:function e(t){var r=this;clearTimeout(this.iv);this.show(t);this.iv=setTimeout(function(){r.hide()},1500)}},{key:"show",value:function e(t){this.textEl.innerHTML=t;this.element.style.display="block";this.element.style.opacity=1}},{key:"hide",value:function e(){this.element.style.display="block";this.element.style.opacity=0}},{key:"trigger",value:function e(){}},{key:"showStats",value:function e(t){var r=this;clearTimeout(this.statsIv);this.stats.innerHTML=t;this.stats.classList.add("show");this.statsIv=setTimeout(function(){r.stats.classList.remove("show")},460)}},{key:"destroy",value:function e(){clearTimeout(this.iv);clearTimeout(this.statsIv)}}]);return t}();t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var a=function(){function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}return function(e,t,r){if(t)i(e.prototype,t);if(r)i(e,r);return e}}();var l=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var i=r(0);var n=o(i);var s=r(2);function o(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var f=/\s+/;var c=function e(t,r,i,a){if(!i)return true;if((typeof i==="undefined"?"undefined":l(i))==="object"){for(var n in i){t[r].apply(t,[n,i[n]].concat(a))}return false}if(f.test(i)){var s=i.split(f);for(var o=0;o<i.length;o++){t[r].apply(t,[s[o]].concat(a))}return false}return true};var d=function e(r,i,a,n){var s=void 0,o=-1;var l=r.length,u=i[0],f=i[1],c=i[2];var t=function t(){try{switch(i.length){case 0:while(++o<l){(s=r[o]).callback.call(s.ctx)}return;case 1:while(++o<l){(s=r[o]).callback.call(s.ctx,u)}return;case 2:while(++o<l){(s=r[o]).callback.call(s.ctx,u,f)}return;case 3:while(++o<l){(s=r[o]).callback.call(s.ctx,u,f,c)}return;default:while(++o<l){(s=r[o]).callback.call(s.ctx,i)}return}}catch(e){p.error(a,"error on event",n,"trigger","-",e);t()}};t()};var h={on:"on",once:"once"};var p=n.default.getLogger();var v=function(){function i(e){u(this,i);this.player=e;p.debug("Event inited")}a(i,[{key:"on",value:function e(t,r,i){if(!c(this,"on",t,[r,i])||!r)return this;this._events||(this._events={});var a=this._events[t]||(this._events[t]=[]);a.push({callback:r,context:i,ctx:i||this});return this}},{key:"once",value:function e(t,r,i){var a=this,n=arguments;var s=void 0;if(c(this,"once",t,[r,i])||!r)return this;var o=function e(){return a.off(t,s)};s=function e(){o(t,s);r.apply(a,n)};return this.on(t,s,i)}},{key:"off",value:function e(t,r,i){var a=this._events[t].indexOf(r);this._events[t].splice(a,1)}},{key:"trigger",value:function e(t){var r=this,i=arguments;if(this._events!=null&&this._events.hasOwnProperty(t)){if(this._events[t]!=null){this._events[t].forEach(function(e){if(typeof e.callback==="function"){e.callback.apply(r,i)}})}}}},{key:"offListening",value:function e(t,r,i){}},{key:"destroy",value:function e(){this._events=null}}],[{key:"register",value:function e(t){i.Custom||(i.Custom={});var r=typeof t==="string"&&t.toUpperCase().trim();if(r&&!i.Custom[r]){i.Custom[r]=r.toLowerCase().split("_").map(function(e,t){return t===0?e:e=e[0].toUpperCase()+e.slice(1)}).join("")}else{p.error("Events","Error when register event: "+t)}}},{key:"listAvailableCustomEvents",value:function e(){i.Custom||(i.Custom={});return Object.keys(i.Custom).filter(function(e){return typeof i.Custom[e]==="string"})}}]);return i}();t.default=v;v.PLAYER_READY="ready";v.PLAYER_RESIZE="resize";v.PLAYER_FULLSCREEN="fullscreen";v.PLAYER_PLAY="play";v.PLAYER_PAUSE="pause";v.PLAYER_STOP="stop";v.PLAYER_ENDED="ended";v.PLAYER_SEEK="seek";v.PLAYER_ERROR="playererror";v.ERROR="error";v.PLAYER_TIMEUPDATE="timeupdate";v.PLAYER_VOLUMEUPDATE="volumeupdate";v.PLAYER_SUBTITLE_AVAILABLE="subtitleavailable"},function(e,t){}])["default"]});
//# sourceMappingURL=MPlayer.js.map